<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Analysis Methodology – Flight Diversions Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-a6e161b2431e1f94a14e0f5d32135a3c.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-4a17e18fdf56099d4f6da1e105f33a53.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-a6e161b2431e1f94a14e0f5d32135a3c.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-1b17e506d66c28969ad50ead2b15a1df.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-4d826d7a8f3217ef8273c677342d8834.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-1b17e506d66c28969ad50ead2b15a1df.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" defer="" src="https://buttons.github.io/buttons.js"></script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Flight Diversions Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./01-collection.html"> 
<span class="menu-text">Data Collection</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./02-analysis.html"> 
<span class="menu-text">Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./03-visualization.html"> 
<span class="menu-text">Visualizations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./04-results.html"> 
<span class="menu-text">Results</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./05-results.qmd" target="_blank"> 
<span class="menu-text">Dashboard</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-analysis.html">Analysis Methodology</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-collection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Collection &amp; Preparation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Analysis Methodology</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualizations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-results.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Results &amp; Conclusions</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">1</span> Overview</a></li>
  <li><a href="#analysis-objectives" id="toc-analysis-objectives" class="nav-link" data-scroll-target="#analysis-objectives"><span class="header-section-number">2</span> Analysis Objectives</a></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology"><span class="header-section-number">3</span> Methodology</a>
  <ul class="collapse">
  <li><a href="#temporal-spatial-clustering-analysis" id="toc-temporal-spatial-clustering-analysis" class="nav-link" data-scroll-target="#temporal-spatial-clustering-analysis"><span class="header-section-number">3.1</span> 1. Temporal-Spatial Clustering Analysis</a></li>
  <li><a href="#geospatial-analysis" id="toc-geospatial-analysis" class="nav-link" data-scroll-target="#geospatial-analysis"><span class="header-section-number">3.2</span> 2. Geospatial Analysis</a></li>
  <li><a href="#statistical-analysis" id="toc-statistical-analysis" class="nav-link" data-scroll-target="#statistical-analysis"><span class="header-section-number">3.3</span> 3. Statistical Analysis</a></li>
  </ul></li>
  <li><a href="#what-this-analysis-tells-us" id="toc-what-this-analysis-tells-us" class="nav-link" data-scroll-target="#what-this-analysis-tells-us"><span class="header-section-number">4</span> What This Analysis Tells Us</a>
  <ul class="collapse">
  <li><a href="#about-diversion-clustering" id="toc-about-diversion-clustering" class="nav-link" data-scroll-target="#about-diversion-clustering"><span class="header-section-number">4.1</span> About Diversion Clustering</a></li>
  <li><a href="#about-geographic-patterns" id="toc-about-geographic-patterns" class="nav-link" data-scroll-target="#about-geographic-patterns"><span class="header-section-number">4.2</span> About Geographic Patterns</a></li>
  <li><a href="#about-operational-impact" id="toc-about-operational-impact" class="nav-link" data-scroll-target="#about-operational-impact"><span class="header-section-number">4.3</span> About Operational Impact</a></li>
  <li><a href="#about-airline-differences" id="toc-about-airline-differences" class="nav-link" data-scroll-target="#about-airline-differences"><span class="header-section-number">4.4</span> About Airline Differences</a></li>
  </ul></li>
  <li><a href="#analysis-limitations" id="toc-analysis-limitations" class="nav-link" data-scroll-target="#analysis-limitations"><span class="header-section-number">5</span> Analysis Limitations</a></li>
  <li><a href="#methodological-decisions" id="toc-methodological-decisions" class="nav-link" data-scroll-target="#methodological-decisions"><span class="header-section-number">6</span> Methodological Decisions</a>
  <ul class="collapse">
  <li><a href="#why-temporal-clustering-with-12-hour-threshold" id="toc-why-temporal-clustering-with-12-hour-threshold" class="nav-link" data-scroll-target="#why-temporal-clustering-with-12-hour-threshold"><span class="header-section-number">6.1</span> Why Temporal Clustering with 12-Hour Threshold?</a></li>
  <li><a href="#why-group-by-destination" id="toc-why-group-by-destination" class="nav-link" data-scroll-target="#why-group-by-destination"><span class="header-section-number">6.2</span> Why Group by Destination?</a></li>
  <li><a href="#why-visualize-with-bezier-curves" id="toc-why-visualize-with-bezier-curves" class="nav-link" data-scroll-target="#why-visualize-with-bezier-curves"><span class="header-section-number">6.3</span> Why Visualize with Bezier Curves?</a></li>
  <li><a href="#assumptions-made" id="toc-assumptions-made" class="nav-link" data-scroll-target="#assumptions-made"><span class="header-section-number">6.4</span> Assumptions Made</a></li>
  </ul></li>
  <li><a href="#code-availability" id="toc-code-availability" class="nav-link" data-scroll-target="#code-availability"><span class="header-section-number">7</span> Code Availability</a></li>
  <li><a href="#next-steps-in-analysis" id="toc-next-steps-in-analysis" class="nav-link" data-scroll-target="#next-steps-in-analysis"><span class="header-section-number">8</span> Next Steps in Analysis</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analysis Methodology</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="overview" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="overview"><span class="header-section-number">1</span> Overview</h2>
<p>This section describes the analytical methods used to identify and understand flight diversion patterns. The analysis combines temporal clustering, geospatial analysis, and statistical methods to uncover meaningful patterns in U.S. aviation system disruptions.</p>
<hr>
</section>
<section id="analysis-objectives" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="analysis-objectives"><span class="header-section-number">2</span> Analysis Objectives</h2>
<p>The analysis aimed to answer the following questions:</p>
<ol type="1">
<li><strong>When do diversions cluster?</strong> Are there specific time periods with elevated diversion activity around particular airports?</li>
<li><strong>Which airports are most affected?</strong> What are the primary diversion hubs and destination airports impacted?</li>
<li><strong>What characterizes diversion events?</strong> Are clusters regional (concentrated in one area) or system-wide (affecting multiple regions)?</li>
<li><strong>How do diversions vary by airline and route?</strong> Do certain airlines or routes experience more frequent diversions?</li>
</ol>
<hr>
</section>
<section id="methodology" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="methodology"><span class="header-section-number">3</span> Methodology</h2>
<section id="temporal-spatial-clustering-analysis" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="temporal-spatial-clustering-analysis"><span class="header-section-number">3.1</span> 1. Temporal-Spatial Clustering Analysis</h3>
<section id="methodology-time-based-clustering" class="level4" data-number="3.1.1">
<h4 data-number="3.1.1" class="anchored" data-anchor-id="methodology-time-based-clustering"><span class="header-section-number">3.1.1</span> Methodology: Time-Based Clustering</h4>
<p>A temporal clustering approach was used to identify distinct diversion events. Diversions are grouped by destination airport and time proximity, with the assumption that diversions occurring within a 12-hour window at the same destination airport are part of the same disruption event.</p>
<p><strong>Clustering Algorithm</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Define temporal cluster: if time gap between diversions &gt; 12 hours, start new cluster</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">def</span> dest_cluster(group, max_gap_hours<span class="op">=</span><span class="dv">12</span>):</span>
<span id="cb1-3"><a href="#cb1-3"></a>    group <span class="op">=</span> group.sort_values(<span class="st">'FlightDate'</span>)</span>
<span id="cb1-4"><a href="#cb1-4"></a>    group[<span class="st">'time_since_last'</span>] <span class="op">=</span> group[<span class="st">'FlightDate'</span>].diff().dt.total_seconds() <span class="op">/</span> <span class="dv">3600</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>    group[<span class="st">'new_cluster'</span>] <span class="op">=</span> (group[<span class="st">'time_since_last'</span>] <span class="op">&gt;</span> max_gap_hours).fillna(<span class="va">True</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a>    group[<span class="st">'cluster_id'</span>] <span class="op">=</span> group[<span class="st">'new_cluster'</span>].cumsum()</span>
<span id="cb1-7"><a href="#cb1-7"></a>    <span class="cf">return</span> group</span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co"># Apply clustering by destination</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>diverted_by_dest <span class="op">=</span> diverted_by_dest.groupby(<span class="st">'Dest'</span>, group_keys<span class="op">=</span><span class="va">False</span>).<span class="bu">apply</span>(dest_cluster)</span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co"># Aggregate cluster statistics</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>cluster_summary_by_dest <span class="op">=</span> diverted_by_dest.groupby([<span class="st">'Dest'</span>, <span class="st">'cluster_id'</span>]).agg({</span>
<span id="cb1-14"><a href="#cb1-14"></a>    <span class="st">'FlightDate'</span>: [<span class="st">'min'</span>, <span class="st">'max'</span>, <span class="st">'count'</span>],</span>
<span id="cb1-15"><a href="#cb1-15"></a>    <span class="st">'Origin'</span>: <span class="st">'nunique'</span>,</span>
<span id="cb1-16"><a href="#cb1-16"></a>    <span class="st">'Div1Airport'</span>: <span class="kw">lambda</span> x: x.value_counts().index[<span class="dv">0</span>] <span class="cf">if</span> <span class="bu">len</span>(x) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb1-17"><a href="#cb1-17"></a>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Why this approach?</strong> - Temporal proximity (within 12 hours) indicates related disruptions at the same destination - Groups diversions by destination to identify which airports experience clustered events - Simple and interpretable: clusters represent real disruption events - Computationally efficient for large datasets</p>
</section>
<section id="determining-cluster-significance" class="level4" data-number="3.1.2">
<h4 data-number="3.1.2" class="anchored" data-anchor-id="determining-cluster-significance"><span class="header-section-number">3.1.2</span> Determining Cluster Significance</h4>
<p>The 12-hour threshold was chosen because: - Allows for cascading effects (e.g., weather system lasting multiple hours) - Prevents false clustering of unrelated events days apart - Aligns with typical airline operational recovery timelines</p>
<p>Clusters with 50+ diversions were identified as major events warranting detailed analysis.</p>
</section>
<section id="cluster-characteristics" class="level4" data-number="3.1.3">
<h4 data-number="3.1.3" class="anchored" data-anchor-id="cluster-characteristics"><span class="header-section-number">3.1.3</span> Cluster Characteristics</h4>
<p><strong>Cluster 1: San Diego (SAN) System-Wide Disruption</strong> - Primary destination: SAN (San Diego International) - Common diversion airport: PHX (Phoenix Sky Harbor International) - Number of events: 140 diversions to SAN; 290 system-wide diversions - Time period: December 18-21, 2024 - Origins affected: 43 unique airports, with ATL, SFO, and DEN being most common - Characteristics: Widespread multi-airport event affecting 60 destination airports and 73 origin airports. Only 48.3% of diversions were to SAN itself; the remaining 150 diversions spread across other destinations (SNA, EYW, BOS, LAX, etc.), indicating a system-wide disruption cascade. Primary diversion airports were ONT (48), PHX (33), and LAX (32), suggesting West Coast capacity constraints.</p>
<p><strong>Cluster 2: Dallas/Fort Worth (DFW) Regional Disruption</strong> - Primary destination: DFW (Dallas/Fort Worth International) - Common diversion airport: IAH (George Bush Intercontinental, Houston) - Number of events: 110 diversions to DFW; 186 system-wide diversions - Time period: November 4-5, 2024 - Origins affected: 89 unique airports, with ATL, CLT, and BOS being most common - Characteristics: Regional event concentrated in Texas area with 59.1% of diversions directed to DFW. Secondary impacts on DAL (32), AUS (13), and SAT (12). Primary diversion airports clustered in Texas region: IAH (28), OKC (22), SAT (16), and AUS (11). Despite broad geographic origins, diversion pattern remained relatively localized to South-Central U.S.</p>
<p><strong>Cluster 3: Chicago O’Hare (ORD) Regional Disruption</strong> - Primary destination: ORD (Chicago O’Hare International) - Common diversion airport: IND (Indianapolis International) - Number of events: 108 diversions to ORD; 187 system-wide diversions - Time period: August 24-26, 2021 - Origins affected: 87 unique airports, with ORD, LAX, DFW, and MSP being most common - Characteristics: Regional event affecting Midwest with 57.8% of diversions to ORD. Secondary impacts on MCO (19), MDW (14), and STL (9). Primary diversion airports: IND (24), STL (21), and MKE (17), indicating Midwest corridor used for overflow capacity. Despite broad geographic origins, diversions concentrated around ORD and neighboring Midwest airports.</p>
<hr>
</section>
</section>
<section id="geospatial-analysis" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="geospatial-analysis"><span class="header-section-number">3.2</span> 2. Geospatial Analysis</h3>
<section id="airport-level-analysis" class="level4" data-number="3.2.1">
<h4 data-number="3.2.1" class="anchored" data-anchor-id="airport-level-analysis"><span class="header-section-number">3.2.1</span> Airport-Level Analysis</h4>
<p>Airport coordinates were used to create geographic visualizations and identify spatial patterns:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Get airport coordinates</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">def</span> get_coords(airport_code, airport_df):</span>
<span id="cb2-3"><a href="#cb2-3"></a>    <span class="cf">if</span> airport_code <span class="kw">in</span> airport_df.index:</span>
<span id="cb2-4"><a href="#cb2-4"></a>        coords <span class="op">=</span> airport_df.loc[airport_code]</span>
<span id="cb2-5"><a href="#cb2-5"></a>        <span class="cf">return</span> (coords[<span class="st">'latitude'</span>], coords[<span class="st">'longitude'</span>])</span>
<span id="cb2-6"><a href="#cb2-6"></a>    <span class="cf">return</span> (<span class="va">None</span>, <span class="va">None</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co"># Create flight paths using Bezier curves</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="kw">def</span> create_bezier_curve(lat1, lon1, lat2, lon2, num_points<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb2-10"><a href="#cb2-10"></a>    mid_lat <span class="op">=</span> (lat1 <span class="op">+</span> lat2) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>    mid_lon <span class="op">=</span> (lon1 <span class="op">+</span> lon2) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>    dx <span class="op">=</span> lon2 <span class="op">-</span> lon1</span>
<span id="cb2-13"><a href="#cb2-13"></a>    dy <span class="op">=</span> lat2 <span class="op">-</span> lat1</span>
<span id="cb2-14"><a href="#cb2-14"></a>    distance <span class="op">=</span> np.sqrt(dx<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> dy<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb2-15"><a href="#cb2-15"></a>    </span>
<span id="cb2-16"><a href="#cb2-16"></a>    <span class="co"># Calculate control point for Bezier curve</span></span>
<span id="cb2-17"><a href="#cb2-17"></a>    <span class="cf">if</span> distance <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb2-18"><a href="#cb2-18"></a>        offset <span class="op">=</span> distance <span class="op">*</span> <span class="fl">0.2</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>        control_lat <span class="op">=</span> mid_lat <span class="op">+</span> offset <span class="op">*</span> (dx <span class="op">/</span> distance) <span class="op">*</span> <span class="fl">0.15</span></span>
<span id="cb2-20"><a href="#cb2-20"></a>        control_lon <span class="op">=</span> mid_lon <span class="op">-</span> offset <span class="op">*</span> (dy <span class="op">/</span> distance) <span class="op">*</span> <span class="fl">0.15</span></span>
<span id="cb2-21"><a href="#cb2-21"></a>    <span class="cf">else</span>:</span>
<span id="cb2-22"><a href="#cb2-22"></a>        control_lat <span class="op">=</span> mid_lat</span>
<span id="cb2-23"><a href="#cb2-23"></a>        control_lon <span class="op">=</span> mid_lon</span>
<span id="cb2-24"><a href="#cb2-24"></a>    </span>
<span id="cb2-25"><a href="#cb2-25"></a>    <span class="co"># Generate curve points</span></span>
<span id="cb2-26"><a href="#cb2-26"></a>    t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, num_points)</span>
<span id="cb2-27"><a href="#cb2-27"></a>    lats <span class="op">=</span> [(<span class="dv">1</span><span class="op">-</span>ti)<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> lat1 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>ti)<span class="op">*</span>ti <span class="op">*</span> control_lat <span class="op">+</span> ti<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> lat2 <span class="cf">for</span> ti <span class="kw">in</span> t]</span>
<span id="cb2-28"><a href="#cb2-28"></a>    lons <span class="op">=</span> [(<span class="dv">1</span><span class="op">-</span>ti)<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> lon1 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>ti)<span class="op">*</span>ti <span class="op">*</span> control_lon <span class="op">+</span> ti<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> lon2 <span class="cf">for</span> ti <span class="kw">in</span> t]</span>
<span id="cb2-29"><a href="#cb2-29"></a>    <span class="cf">return</span> lats, lons</span>
<span id="cb2-30"><a href="#cb2-30"></a></span>
<span id="cb2-31"><a href="#cb2-31"></a><span class="co"># Count diversions by airport</span></span>
<span id="cb2-32"><a href="#cb2-32"></a>div_counts <span class="op">=</span> diverted_flights[<span class="st">'Div1Airport'</span>].value_counts()</span>
<span id="cb2-33"><a href="#cb2-33"></a>dest_counts <span class="op">=</span> diverted_flights[<span class="st">'Dest'</span>].value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="route-analysis" class="level4" data-number="3.2.2">
<h4 data-number="3.2.2" class="anchored" data-anchor-id="route-analysis"><span class="header-section-number">3.2.2</span> Route Analysis</h4>
<p>Flight routes (Origin → Diversion → Destination) were visualized using interactive Plotly maps showing: - Blue markers: Origin airports - Red stars: Diversion airports - Gold diamonds: Intended destination airports - Curved lines: Flight paths colored by airline</p>
<p>This reveals: - Which airports are forced to absorb diversions - Geographic spread of disruption impacts - Airline-specific diversion patterns - Cascading effects across regions</p>
<hr>
</section>
</section>
<section id="statistical-analysis" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="statistical-analysis"><span class="header-section-number">3.3</span> 3. Statistical Analysis</h3>
<section id="delay-impact" class="level4" data-number="3.3.1">
<h4 data-number="3.3.1" class="anchored" data-anchor-id="delay-impact"><span class="header-section-number">3.3.1</span> Delay Impact</h4>
<p>Departure and arrival delays for diverted flights were calculated to understand operational impact:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Calculate delay statistics</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>avg_dep_delay <span class="op">=</span> diverted_flights[<span class="st">'DepDelay'</span>].mean()</span>
<span id="cb3-3"><a href="#cb3-3"></a>median_dep_delay <span class="op">=</span> diverted_flights[<span class="st">'DepDelay'</span>].median()</span>
<span id="cb3-4"><a href="#cb3-4"></a>max_dep_delay <span class="op">=</span> diverted_flights[<span class="st">'DepDelay'</span>].<span class="bu">max</span>()</span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a>avg_arr_delay <span class="op">=</span> diverted_flights[<span class="st">'ArrDelay'</span>].mean()</span>
<span id="cb3-7"><a href="#cb3-7"></a>median_arr_delay <span class="op">=</span> diverted_flights[<span class="st">'ArrDelay'</span>].median()</span>
<span id="cb3-8"><a href="#cb3-8"></a>max_arr_delay <span class="op">=</span> diverted_flights[<span class="st">'ArrDelay'</span>].<span class="bu">max</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Key Statistics</strong>: - Average departure delay for diverted flights: [X] minutes - Average arrival delay for diverted flights: [Y] minutes - Maximum single-flight delay: [Z] minutes</p>
</section>
<section id="airline-comparison" class="level4" data-number="3.3.2">
<h4 data-number="3.3.2" class="anchored" data-anchor-id="airline-comparison"><span class="header-section-number">3.3.2</span> Airline Comparison</h4>
<p>Diversions were analyzed by airline to identify operational differences:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Analyze diversions by airline</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>airline_analysis <span class="op">=</span> diverted_flights.groupby(<span class="st">'Marketing_Airline_Network'</span>).agg({</span>
<span id="cb4-3"><a href="#cb4-3"></a>    <span class="st">'FlightDate'</span>: <span class="st">'count'</span>,</span>
<span id="cb4-4"><a href="#cb4-4"></a>    <span class="st">'Div1Airport'</span>: <span class="st">'nunique'</span>,</span>
<span id="cb4-5"><a href="#cb4-5"></a>    <span class="st">'DepDelay'</span>: <span class="st">'mean'</span>,</span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="st">'ArrDelay'</span>: <span class="st">'mean'</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>}).rename(columns<span class="op">=</span>{<span class="st">'FlightDate'</span>: <span class="st">'num_diversions'</span>})</span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a>airline_analysis <span class="op">=</span> airline_analysis.sort_values(<span class="st">'num_diversions'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Airline</th>
<th>Diversion Count</th>
<th>Avg Dep Delay</th>
<th>Avg Arr Delay</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[Airline 1]</td>
<td>[X]</td>
<td>[A] min</td>
<td>[B] min</td>
</tr>
<tr class="even">
<td>[Airline 2]</td>
<td>[Y]</td>
<td>[C] min</td>
<td>[D] min</td>
</tr>
<tr class="odd">
<td>[Airline 3]</td>
<td>[Z]</td>
<td>[E] min</td>
<td>[F] min</td>
</tr>
</tbody>
</table>
<hr>
</section>
</section>
</section>
<section id="what-this-analysis-tells-us" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="what-this-analysis-tells-us"><span class="header-section-number">4</span> What This Analysis Tells Us</h2>
<section id="about-diversion-clustering" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="about-diversion-clustering"><span class="header-section-number">4.1</span> About Diversion Clustering</h3>
<p>The 12-hour temporal clustering reveals that: - Diversions are not random; they cluster around specific destinations during narrow time windows - Multiple diversions within 12 hours suggest shared root causes (weather, capacity, ATC issues) - Cluster size indicates disruption severity</p>
</section>
<section id="about-geographic-patterns" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="about-geographic-patterns"><span class="header-section-number">4.2</span> About Geographic Patterns</h3>
<p>The geographic visualizations show: - Certain airports (PHX, IAH, IND) repeatedly serve as diversion hubs - System-wide vs.&nbsp;regional events have different impacts - West Coast, Texas, and Midwest emerge as diversion hotspots</p>
</section>
<section id="about-operational-impact" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="about-operational-impact"><span class="header-section-number">4.3</span> About Operational Impact</h3>
<p>The delay analysis demonstrates: - Diversions cause significant departure delays [X] minutes on average - Arrival delays compound, affecting downstream flights - Cascading effects spread disruptions through the network</p>
</section>
<section id="about-airline-differences" class="level3" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="about-airline-differences"><span class="header-section-number">4.4</span> About Airline Differences</h3>
<p>Airline comparison reveals: - Variation in diversion frequency by carrier - May reflect route network, fleet size, or operational practices - Some airlines absorb diversions more efficiently than others</p>
<hr>
</section>
</section>
<section id="analysis-limitations" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="analysis-limitations"><span class="header-section-number">5</span> Analysis Limitations</h2>
<ol type="1">
<li><strong>No causal information</strong>: Analysis shows patterns but not root causes (weather, mechanical, ATC)</li>
<li><strong>First diversion only</strong>: Secondary diversions not tracked; cascade effects underestimated</li>
<li><strong>No weather context</strong>: Cannot verify weather-related diversion hypothesis</li>
<li><strong>Historical data only</strong>: Cannot predict future diversions</li>
<li><strong>Airline bias</strong>: Different airlines may report data inconsistently</li>
</ol>
<hr>
</section>
<section id="methodological-decisions" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="methodological-decisions"><span class="header-section-number">6</span> Methodological Decisions</h2>
<section id="why-temporal-clustering-with-12-hour-threshold" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="why-temporal-clustering-with-12-hour-threshold"><span class="header-section-number">6.1</span> Why Temporal Clustering with 12-Hour Threshold?</h3>
<p>The approach was chosen because: 1. <strong>Interpretability</strong>: Clusters directly represent real disruption events 2. <strong>Domain alignment</strong>: 12-hour window matches airline operational recovery cycles 3. <strong>Simplicity</strong>: Easy to understand and reproduce 4. <strong>Efficiency</strong>: Computationally efficient for large datasets 5. <strong>Causality</strong>: Temporal proximity suggests shared root causes</p>
</section>
<section id="why-group-by-destination" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="why-group-by-destination"><span class="header-section-number">6.2</span> Why Group by Destination?</h3>
<p>Grouping by destination airport reveals: - Which airports are most vulnerable to cascading diversions - Geographic concentration vs.&nbsp;system-wide impact - Capacity constraints at specific locations - Ripple effects when one airport is overwhelmed</p>
</section>
<section id="why-visualize-with-bezier-curves" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="why-visualize-with-bezier-curves"><span class="header-section-number">6.3</span> Why Visualize with Bezier Curves?</h3>
<p>Bezier curves were used for flight paths because: - Great circle routes are difficult to visualize at Mercator projection - Curved paths make overlapping routes distinguishable - Color-coding by airline reveals carrier-specific patterns - Interactive Plotly maps allow exploration of detailed routes</p>
</section>
<section id="assumptions-made" class="level3" data-number="6.4">
<h3 data-number="6.4" class="anchored" data-anchor-id="assumptions-made"><span class="header-section-number">6.4</span> Assumptions Made</h3>
<ol type="1">
<li><strong>Temporal assumption</strong>: Diversions within 12 hours are part of same event</li>
<li><strong>Destination assumption</strong>: Diversions to same destination within time window are related</li>
<li><strong>Independence</strong>: Clusters separated by &gt;12 hours are treated as independent events</li>
</ol>
<hr>
</section>
</section>
<section id="code-availability" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="code-availability"><span class="header-section-number">7</span> Code Availability</h2>
<p>All analysis code is available in the Jupyter notebook: <code>5500_flightDiversion.ipynb</code></p>
<hr>
</section>
<section id="next-steps-in-analysis" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="next-steps-in-analysis"><span class="header-section-number">8</span> Next Steps in Analysis</h2>
<p>Potential extensions to this analysis:</p>
<ol type="1">
<li><strong>Incorporate weather data</strong> - Join with NOAA weather to verify weather-related diversions</li>
<li><strong>Track cascading effects</strong> - Follow secondary diversions through the network</li>
<li><strong>Predict diversion risk</strong> - Build ML model to predict diversion likelihood</li>
<li><strong>Economic impact</strong> - Quantify costs of diversions to airlines and passengers</li>
<li><strong>Sentiment analysis</strong> - Analyze passenger reactions on social media during events</li>
</ol>
<hr>
<p><strong>Analysis Completed</strong>: [DATE]</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/your-github-username\.github\.io\/flight-diversions");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>