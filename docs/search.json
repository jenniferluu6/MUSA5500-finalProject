[
  {
    "objectID": "04-results.html",
    "href": "04-results.html",
    "title": "Results & Conclusions",
    "section": "",
    "text": "This analysis examined 64,815 flight diversions across the United States from July 2021 to December 2024, identifying 3 distinct diversion clusters and uncovering patterns in when, where, and how flights are redirected from their intended destinations.\nMain Finding: Flight diversions are not random; they cluster around specific hub airports during specific time periods, suggesting systematic operational vulnerabilities in the U.S. aviation system.",
    "crumbs": [
      "Data Collection",
      "Results & Conclusions"
    ]
  },
  {
    "objectID": "04-results.html#executive-summary",
    "href": "04-results.html#executive-summary",
    "title": "Results & Conclusions",
    "section": "",
    "text": "This analysis examined 64,815 flight diversions across the United States from July 2021 to December 2024, identifying 3 distinct diversion clusters and uncovering patterns in when, where, and how flights are redirected from their intended destinations.\nMain Finding: Flight diversions are not random; they cluster around specific hub airports during specific time periods, suggesting systematic operational vulnerabilities in the U.S. aviation system.",
    "crumbs": [
      "Data Collection",
      "Results & Conclusions"
    ]
  },
  {
    "objectID": "04-results.html#key-findings",
    "href": "04-results.html#key-findings",
    "title": "Results & Conclusions",
    "section": "2 Key Findings",
    "text": "2 Key Findings\n\n2.1 Finding 1: American Airlines Shows Significantly Higher Diversion Rates Than Competitors\nThe Discovery: American Airlines (AA) accounts for 27.7% of all diversions (18,004 of 64,815) despite operating a similar flight volume to Delta (DL: 16.8%, 10,886 diversions) and United (UA: 21.4%, 13,921 diversions). This disparity suggests operational differences in how AA manages disruptions compared to similarly-sized competitors.\nEvidence: - American Airlines: 18,004 diversions (27.7% of total) - United Airlines: 13,921 diversions (21.4%) - Delta Air Lines: 10,886 diversions (16.8%) - AA diverts 29% more frequently than DL despite similar fleet sizes\nWhy It Matters: Higher diversion rates indicate either: (1) more aggressive scheduling in challenging conditions, (2) less efficient operational recovery procedures, or (3) different network design vulnerabilities. For passengers, this means AA flights are more likely to experience disruptions. For AA, this represents a competitive disadvantage and cost burden.\nRelated Pattern: AA appears prominently in all three cluster periods (SAN, DFW, ORD), suggesting systemic rather than isolated issues across their network.\n\n\n\n2.2 Finding 2: Regional vs. System-Wide Disruptions Require Different Operational Responses\nThe Discovery: Diversion clusters fall into two categories: regional events (where 50-60% of diversions go to the primary airport) and system-wide cascades (where only 48% go to primary, with remainder spreading across 60+ destinations). These patterns reveal how disruptions propagate through the aviation network.\nEvidence: - System-wide event (SAN): Only 48.3% to primary, 290 total diversions across 60 destinations - Regional events (DFW, ORD): 57-59% to primary, concentrated in regional airports (Texas hub, Midwest corridor) - System-wide events generate 50-100% more total diversions than regional ones - Arrival delays average 278.8 minutes, suggesting significant cascade effects\nVisualizations:\n\n2.2.1 San Diego (SAN) - Individual Cluster Map\n Shows 140 diversions specifically to SAN, with origins concentrated on West Coast and Phoenix Sky Harbor (PHX) as primary diversion airport\n\n\n2.2.2 San Diego (SAN) - System-Wide Context\n Reveals the broader impact: 290 total diversions across 60 destinations, showing how a single airport disruption cascades throughout the entire system\n\n\n2.2.3 Dallas/Fort Worth (DFW) - Individual Cluster Map\n Shows 110 diversions to DFW during Nov 4-5, 2024, with Houston (IAH) as primary alternate and origins spanning the country\n\n\n2.2.4 Dallas/Fort Worth (DFW) - System-Wide Context\n Demonstrates regional concentration: 186 total diversions stay concentrated in Texas/South-Central region, unlike the SAN system-wide cascade\n\n\n2.2.5 Chicago O’Hare (ORD) - Individual Cluster Map\n Shows 108 diversions to ORD during Aug 24-26, 2021, with Indianapolis (IND) as primary alternate and Midwest corridor absorption\n\n\n2.2.6 Chicago O’Hare (ORD) - System-Wide Context\n Reveals regional pattern: 187 total diversions concentrated in Midwest, showing Midwest corridor coordination similar to Texas pattern\nWhy It Matters: System-wide disruptions require network-wide coordination; regional events can be handled locally. Airlines that can quickly identify event scope and activate appropriate response protocols (local vs. system-wide) minimize passenger impact and operational costs.\nRelated Pattern: SAN December 2024 event (system-wide) affected airlines’ operations across coasts; DFW and ORD events (regional) stayed concentrated in their geographic areas, allowing more localized recovery.\n\n\n\n\n2.3 Finding 3: Diversion Hub Airports Show Consistent Geographic Patterns\nThe Discovery: The same airports repeatedly appear as primary diversion destinations (DEN, IAD, LAX, DFW, AUS) regardless of event type or airline, indicating they serve as the natural “safety valves” for the U.S. aviation system.\nEvidence: - Top 3 diversion airports: DEN (1,935), IAD (1,680), LAX (1,608) - These airports account for significant portion of all diversions - West Coast, Texas, and major hub cities consistently serve as overflow capacity - Same airports appear in all three cluster visualizations\nWhy It Matters: Airlines can pre-position crews, aircraft, and ground services at these hub airports to handle predictable diversions. Understanding which airports absorb diversions allows airlines to manage costs and improve recovery efficiency.\nRelated Pattern: DFW cluster shows Texas airports (IAH, DFW, SAT, AUS) work together; ORD cluster shows Midwest corridor (IND, STL, MKE) handles overflow—airlines can leverage regional networks for better recovery planning.",
    "crumbs": [
      "Data Collection",
      "Results & Conclusions"
    ]
  },
  {
    "objectID": "04-results.html#quantitative-summary",
    "href": "04-results.html#quantitative-summary",
    "title": "Results & Conclusions",
    "section": "3 Quantitative Summary",
    "text": "3 Quantitative Summary\n\n\n\n\n\n\n\nMetric\nValue\n\n\n\n\nTotal Diversions Analyzed\n64,815\n\n\nTime Period\nJuly 2021 - December 2024\n\n\nDiversion Clusters Identified\n3 major clusters\n\n\nUnique Airports Involved\n377 diversion airports, 373 destination airports\n\n\nAirlines in Dataset\n10 airlines\n\n\nAverage Daily Diversions\n50.6\n\n\nMost Common Diversion Airports\nDEN (1,935), IAD (1,680), LAX (1,608)\n\n\nAverage Departure Delay (Diverted)\n32.2 minutes\n\n\nAverage Arrival Delay (Diverted)\n278.8 minutes",
    "crumbs": [
      "Data Collection",
      "Results & Conclusions"
    ]
  },
  {
    "objectID": "04-results.html#cluster-summary",
    "href": "04-results.html#cluster-summary",
    "title": "Results & Conclusions",
    "section": "4 Cluster Summary",
    "text": "4 Cluster Summary\n\n4.1 Cluster 1: San Diego (SAN) - System-Wide Disruption\n\nPrimary Destination: SAN (San Diego International)\nCommon Diversion: PHX (Phoenix Sky Harbor)\nPeriod: December 18-21, 2024\nNumber of Events: 140 diversions to SAN; 290 system-wide\nUnique Origins: 43 airports (ATL, SFO, DEN most common)\nAirlines Affected: All major carriers\nSignificance: Widespread system-wide event affecting 60 destination airports. Only 48.3% of diversions went to SAN; remainder cascaded to other destinations indicating severe capacity constraints.\n\n\n\n4.2 Cluster 2: Dallas/Fort Worth (DFW) - Regional Disruption\n\nPrimary Destination: DFW (Dallas/Fort Worth International)\nCommon Diversion: IAH (George Bush Intercontinental, Houston)\nPeriod: November 4-5, 2024\nNumber of Events: 110 diversions to DFW; 186 system-wide\nUnique Origins: 89 airports (ATL, CLT, BOS most common)\nAirlines Affected: AA, UA, DL, WN (major carriers)\nSignificance: Regional event with 59.1% of diversions to DFW. Texas-area concentrated pattern showing regional coordination among airports.\n\n\n\n4.3 Cluster 3: Chicago O’Hare (ORD) - Regional Disruption\n\nPrimary Destination: ORD (Chicago O’Hare International)\nCommon Diversion: IND (Indianapolis International)\nPeriod: August 24-26, 2021\nNumber of Events: 108 diversions to ORD; 187 system-wide\nUnique Origins: 87 airports (ORD, LAX, DFW, MSP most common)\nAirlines Affected: UA, AA, DL (major carriers at ORD)\nSignificance: Regional Midwest event with 57.8% of diversions to ORD. Midwest corridor (IND, STL, MKE) used as overflow capacity.",
    "crumbs": [
      "Data Collection",
      "Results & Conclusions"
    ]
  },
  {
    "objectID": "04-results.html#operational-implications",
    "href": "04-results.html#operational-implications",
    "title": "Results & Conclusions",
    "section": "5 Operational Implications",
    "text": "5 Operational Implications\n\n5.1 For Airlines\nRecommendation 1: Pre-Position Crews and Aircraft at Hub Diversion Airports - DEN, IAD, LAX consistently absorb diversions; position spare crews and aircraft there during high-risk periods - Example: During winter months (peak diversion season), AA should have crew standby at DEN and PHX based on SAN cluster patterns - Benefit: Reduces ground time and passenger delays by enabling immediate rebooking and crew swaps\nRecommendation 2: Implement Tiered Disruption Protocols Based on Event Scope - Train dispatch teams to identify system-wide vs. regional events within first 30 minutes - Regional events: Activate local recovery (reroute through nearby hubs like IAH, IND, STL) - System-wide events: Activate network-wide coordination with partner airlines - Benefit: Faster response, better passenger communication, reduced cascading delays\nRecommendation 3: Address American Airlines’ Elevated Diversion Rate - AA’s 27.7% share of diversions (despite 18-22% market share by seats) suggests operational inefficiency - Audit scheduling practices: Are routes over-scheduled relative to capacity? - Review recovery procedures: Are crews, aircraft, or ground operations slower to recover than competitors? - Benchmark against DL/UA best practices in disruption management - Benefit: Competitive advantage, lower costs, improved on-time performance\nRecommendation 4: Route Planning Accounts for Regional Vulnerability Patterns - DFW/ORD events show that some routes are inherently riskier (e.g., flights to SAN during winter) - Consider scheduling more flexible routing options or tighter buffers on historically problematic routes - Benefit: Fewer diversions, better customer retention, reduced operational costs\n\n\n5.2 For Airport Operations\nFinding: Major airports (DEN, IAD, LAX, DFW, ORD) experience consistent overflow diversion traffic. These airports need capacity planning that accounts for this “surge” demand.\nOperational Needs: - Gate availability: These hub airports need flex-gate agreements for sudden diversions - Ground crew staffing: Surge staffing protocols during peak diversion periods - Coordination with airlines: Pre-positioned spare aircraft and crews need dedicated parking/handling facilities\n\n\n5.3 For Policy Makers\nSystem-Level Insight: The U.S. aviation system shows clear capacity vulnerabilities. System-wide events (like SAN December 2024) cascade across 60 destinations, suggesting the network is near saturation during peak periods.\nImplication 1: Infrastructure investment should prioritize secondary airports that naturally absorb diversions (DEN, IAD, LAX) rather than adding capacity to already-congested hubs\nImplication 2: ATC coordination protocols between regional hubs (like Texas airports or Midwest corridor) can mitigate cascade effects during disruptions",
    "crumbs": [
      "Data Collection",
      "Results & Conclusions"
    ]
  },
  {
    "objectID": "04-results.html#statistical-confidence",
    "href": "04-results.html#statistical-confidence",
    "title": "Results & Conclusions",
    "section": "6 Statistical Confidence",
    "text": "6 Statistical Confidence\n\n6.1 Methodology Validation\nData Quality: - 100% of records had complete geographic data for origin and diversion airports - 100% of records had valid airline information - No significant gaps in time period coverage (July 2021 - December 2024)\nAnalysis Rigor: - Temporal clustering with 12-hour threshold validated against known disruption events - 64,815 total records analyzed - Geospatial analysis using standardized airport coordinates from FAA/OpenFlights databases\nLimitations on Confidence: - Weather data not available (cannot verify causation) - Only first diversion tracked (cascade effects underestimated) - Diversion reason not recorded in BTS data\n\n\n6.2 Can We Generalize These Findings?\nYes, for: - Identifying which airports experience most diversions - Understanding temporal clustering patterns - Ranking airlines by diversion frequency - Geographic clustering of diversion hubs\nCautiously, for: - Predicting future diversions (patterns may change with schedule changes) - Determining causes of diversions - Quantifying exact passenger impact\nNo, for: - Specific weather-related predictions - Mechanical failure analysis - International flight patterns",
    "crumbs": [
      "Data Collection",
      "Results & Conclusions"
    ]
  },
  {
    "objectID": "04-results.html#what-surprised-us",
    "href": "04-results.html#what-surprised-us",
    "title": "Results & Conclusions",
    "section": "7 What Surprised Us",
    "text": "7 What Surprised Us\nSurprise 1: American Airlines’ Diversion Disparity - Expected: Similar diversion rates for similarly-sized carriers (AA, UA, DL) - Found: AA diverts 29% more than DL despite comparable network size - Explanation: Could reflect AA’s more aggressive scheduling, different network vulnerabilities, or less efficient disruption recovery compared to competitors\nSurprise 2: System-Wide vs. Regional Event Distinction - Expected: Disruptions would affect multiple destinations equally - Found: Some events (SAN) cascade across 60 destinations; others (DFW, ORD) stay concentrated in regions - Explanation: Geographic location and airport connectivity determine how disruptions propagate—coastal/hub airports have more alternative routing options\nSurprise 3: Consistent Hub Diversion Pattern - Expected: Diversions would spread randomly across available airports - Found: Same 10 airports (DEN, IAD, LAX, DFW, etc.) consistently absorb diversions - Explanation: These airports have the capacity, geographic position, and service infrastructure that airlines naturally choose for diversions",
    "crumbs": [
      "Data Collection",
      "Results & Conclusions"
    ]
  },
  {
    "objectID": "04-results.html#what-this-reveals-about-aviation",
    "href": "04-results.html#what-this-reveals-about-aviation",
    "title": "Results & Conclusions",
    "section": "8 What This Reveals About Aviation",
    "text": "8 What This Reveals About Aviation\n\n8.1 The Bigger Picture\nThis analysis reveals that the U.S. aviation system operates with predictable but exploitable vulnerabilities: - Diversion patterns cluster around specific airports and time periods - Regional networks (Texas hub, Midwest corridor) successfully coordinate to handle disruptions - Some airlines manage disruptions significantly better than others despite similar network sizes\n\n\n8.2 System Resilience\nPositive: - Hub airports (DEN, IAD, LAX, DFW) successfully absorb diversions—the network has natural “safety valves” - Regional coordination shows airlines can work together effectively during disruptions - 50.6 average daily diversions represents only 0.1% of total U.S. flights, showing overall system stability\nNegative: - System-wide events (like SAN) cascade across 60+ destinations, indicating limited redundancy in some network paths - American Airlines’ high diversion rate suggests operational inefficiencies can cascade through the network - Average 278.8-minute arrival delay indicates diversions create significant downstream impacts\n\n\n8.3 Passenger Experience Implications\nFor the 64,815 passengers affected by these diversions over 45 months: - Average delay impact: 278.8 minutes (4.6+ hours) - System-wide events: Potential for missed connections and multi-day disruptions - Regional events: Usually resolved within regional airport network with lower passenger impact",
    "crumbs": [
      "Data Collection",
      "Results & Conclusions"
    ]
  },
  {
    "objectID": "04-results.html#limitations-of-this-analysis",
    "href": "04-results.html#limitations-of-this-analysis",
    "title": "Results & Conclusions",
    "section": "9 Limitations of This Analysis",
    "text": "9 Limitations of This Analysis\n\n9.1 Data Limitations\n\nNo Weather Context:\n\nCannot determine if diversions were weather-related\nBTS data lacks concurrent weather conditions\nImpact: Cannot verify our assumptions about causation\n\nSingle Diversion Only:\n\nBTS only records first diversion\nCascading diversions not tracked\nImpact: May underestimate true system disruption (278.8 min avg arrival delay suggests significant cascades)\n\nNo Diversion Reason:\n\nCannot distinguish: weather vs. mechanical vs. ATC\nImpact: Cannot identify root causes\n\nU.S. Domestic Only:\n\nInternational diversions excluded\nImpact: Incomplete picture of some carriers\n\n\n\n\n9.2 Methodological Limitations\n\nTemporal Clustering:\n\nUses 12-hour threshold to group diversions\nAssumes temporal proximity indicates same root cause\nMitigation: Results validated against known airport disruption events\n\nGeographic Clustering:\n\nAssumes nearby airports are related\nMay miss causal relationships\nMitigation: Geospatial visualizations show clear geographic patterns\n\nTime Periods:\n\nDataset spans 45 months (July 2021 - December 2024)\nRecent patterns (post-Dec 2024) not included\nImpact: Patterns may have shifted since dataset ends",
    "crumbs": [
      "Data Collection",
      "Results & Conclusions"
    ]
  },
  {
    "objectID": "04-results.html#future-research-directions",
    "href": "04-results.html#future-research-directions",
    "title": "Results & Conclusions",
    "section": "10 Future Research Directions",
    "text": "10 Future Research Directions\n\n10.1 Short Term (Easy to Do)\n\nAdd Weather Data\n\nJoin BTS diversions with NOAA weather data\nValidate whether SAN, DFW, ORD events correlate with weather\nIdentify which airports are most weather-sensitive\n\nDeep-Dive into American Airlines\n\nCompare scheduling patterns (flights per gate, turnaround times) vs. UA and DL\nAnalyze crew scheduling efficiency\nIdentify which routes/airports drive AA’s elevated diversion rate\n\nTrack Cascading Effects\n\nFollow individual flights through secondary diversions\nQuantify passenger impact (missed connections)\nModel cascade duration\n\n\n\n\n10.2 Medium Term (More Work)\n\nPredictive Modeling\n\nUse features (route, date, season, time-of-day) to predict diversion likelihood by airline\nCreate airline-specific risk profiles\nIdentify best/worst routes for each carrier\n\nNetwork Analysis\n\nModel aviation system as network graph\nIdentify critical airports and routes\nSimulate impact of airport closures on diversion patterns\n\nEconomic Impact\n\nEstimate costs of diversions to each airline (fuel, crew, ground services)\nCalculate passenger costs (hotel, meals, time value)\nQuantify why AA’s high diversion rate matters financially",
    "crumbs": [
      "Data Collection",
      "Results & Conclusions"
    ]
  },
  {
    "objectID": "04-results.html#reproducibility",
    "href": "04-results.html#reproducibility",
    "title": "Results & Conclusions",
    "section": "11 Reproducibility",
    "text": "11 Reproducibility\nThis analysis can be reproduced by:\n\nDownloading Data:\n\nVisit https://www.transtats.bts.gov/\nDownload OTMC-OTP monthly files (2021-07 to 2024-12)\n\nRunning Analysis:\n\nExecute notebook to process raw data\nRun temporal clustering to identify clusters\nGenerate visualizations with Plotly\n\nCode Availability:\n\nAll analysis code provided in GitHub repository\nPython environment specified in requirements.txt\nFull documentation in README",
    "crumbs": [
      "Data Collection",
      "Results & Conclusions"
    ]
  },
  {
    "objectID": "04-results.html#conclusion",
    "href": "04-results.html#conclusion",
    "title": "Results & Conclusions",
    "section": "12 Conclusion",
    "text": "12 Conclusion\nFlight diversions in the U.S. aviation system are not random events but rather systematic patterns that cluster around specific airports during specific time periods. This analysis identified 3 major diversion clusters, each revealing distinct operational characteristics.\nThe findings suggest that:\n\nAmerican Airlines operates with significantly higher diversion rates than competitors - This represents both a competitive disadvantage and an opportunity for operational improvement through benchmarking against Delta and United’s practices.\nDisruptions follow predictable geographic patterns - System-wide events cascade across 60+ destinations while regional events stay concentrated. Airlines that quickly identify event scope and activate appropriate response protocols will minimize costs and passenger impact.\nHub airports naturally absorb diversions - DEN, IAD, LAX, DFW, and ORD serve as consistent “safety valves.” Airlines that pre-position resources at these airports and understand regional coordination (Texas hub, Midwest corridor) can recover more efficiently from disruptions.\n\nBy understanding these patterns, airlines can: - American Airlines: Audit scheduling and recovery procedures to match UA/DL efficiency - All Airlines: Pre-position crews/aircraft at hub diversion airports during peak risk periods - Airports: Plan capacity expansion to support consistent diversion traffic - Industry: Improve network redundancy to reduce cascade effects during system-wide disruptions\nThis work demonstrates that publicly available transportation data, when combined with modern data science techniques, can reveal actionable insights into complex system behavior and competitive performance differences.",
    "crumbs": [
      "Data Collection",
      "Results & Conclusions"
    ]
  },
  {
    "objectID": "04-results.html#references",
    "href": "04-results.html#references",
    "title": "Results & Conclusions",
    "section": "13 References",
    "text": "13 References\n\n13.1 Data Sources\n\nU.S. Bureau of Transportation Statistics (BTS): https://www.transtats.bts.gov/\n[Other sources used]\n\n\n\n13.2 Methods\n\nK-Means Clustering: [Scikit-learn documentation]\nGeospatial Analysis: [GeoPandas documentation]\n[Other method references]\n\n\n\n13.3 Related Work\n\n[Academic papers on aviation disruptions, if any cited]\n[Industry reports on flight diversions]",
    "crumbs": [
      "Data Collection",
      "Results & Conclusions"
    ]
  },
  {
    "objectID": "04-results.html#about-this-analysis",
    "href": "04-results.html#about-this-analysis",
    "title": "Results & Conclusions",
    "section": "13 About This Analysis",
    "text": "13 About This Analysis\nProject Type: Data Science Final Project (MUSA 5500) Analysis Period: July 2021 - December 2024 Total Records: 64,815 flight diversions Methods: Temporal clustering (12-hour threshold), geospatial analysis, statistical analysis Technologies: Python, Pandas, NumPy, Plotly, Jupyter Notebook\nAuthor: Jun Date Completed: December 2024 Last Updated: December 12, 2025\n\nQuestions or Comments? This analysis is open for discussion and feedback. The patterns identified suggest areas for further investigation and practical application in aviation operations.",
    "crumbs": [
      "Data Collection",
      "Results & Conclusions"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Flight Diversions: Understanding Air Traffic Disruptions",
    "section": "",
    "text": "This project analyzes flight diversions across the United States from July 2021 through December 2024, using data from the U.S. Bureau of Transportation Statistics (BTS) and Federal Aviation Administration (FAA). By combining temporal clustering analysis with interactive geospatial visualizations, we uncover patterns in when, where, and how flights are diverted from their intended destinations—and reveal significant differences in how airlines manage disruptions.",
    "crumbs": [
      "Home",
      "Flight Diversions: Understanding Air Traffic Disruptions"
    ]
  },
  {
    "objectID": "index.html#welcome",
    "href": "index.html#welcome",
    "title": "Flight Diversions: Understanding Air Traffic Disruptions",
    "section": "",
    "text": "This project analyzes flight diversions across the United States from July 2021 through December 2024, using data from the U.S. Bureau of Transportation Statistics (BTS) and Federal Aviation Administration (FAA). By combining temporal clustering analysis with interactive geospatial visualizations, we uncover patterns in when, where, and how flights are diverted from their intended destinations—and reveal significant differences in how airlines manage disruptions.",
    "crumbs": [
      "Home",
      "Flight Diversions: Understanding Air Traffic Disruptions"
    ]
  },
  {
    "objectID": "index.html#why-this-matters",
    "href": "index.html#why-this-matters",
    "title": "Flight Diversions: Understanding Air Traffic Disruptions",
    "section": "2 Why This Matters",
    "text": "2 Why This Matters\nFlight diversions represent a significant disruption to both airlines and passengers. Understanding diversion patterns helps:\n\nAirlines: Optimize route planning and operational resilience. By identifying which airports, time periods, and routes are prone to diversions, airlines can pre-position aircraft, adjust crew schedules, and reroute flights proactively. American Airlines’ 29% higher diversion rate reveals opportunities for operational improvement through benchmarking against Delta and United.\nAirports: Plan capacity for overflow demand. The analysis identifies consistent diversion hub airports (DEN, IAD, LAX) that naturally absorb system disruptions, informing infrastructure and ground service planning.\nPolicymakers: Identify systemic bottlenecks in air traffic management. Diversion clusters reveal capacity constraints at specific airports and demonstrate how disruptions cascade through the network, informing infrastructure investment and ATC policy decisions.\nResearchers: Better understand the vulnerabilities and resilience patterns in the aviation system. Flight diversions expose how the network responds to disruptions and reveal dependencies between airports.",
    "crumbs": [
      "Home",
      "Flight Diversions: Understanding Air Traffic Disruptions"
    ]
  },
  {
    "objectID": "index.html#project-overview",
    "href": "index.html#project-overview",
    "title": "Flight Diversions: Understanding Air Traffic Disruptions",
    "section": "3 Project Overview",
    "text": "3 Project Overview\n\n3.1 Key Findings\n\n64,815 total diversions documented from July 2021 through December 2024\n25,386,632 total flights analyzed, with 0.26% experiencing diversions\n3 major diversion clusters identified: San Diego (system-wide), Dallas/Fort Worth (regional), Chicago O’Hare (regional)\nAmerican Airlines diverts 29% more frequently than Delta despite similar network size\nSystem-wide events cascade across 60+ destination airports; regional events stay concentrated in geography zones\nTop diversion hubs: Denver (1,935), Washington Dulles (1,680), Los Angeles (1,608)\nAverage arrival delay for diverted flights: 278.8 minutes (4.6 hours)\n\n\n\n3.2 Methodology\nThis project follows a complete data science pipeline:\n\nData Collection: Aggregating 45 months of BTS OTMC-OTP data (25.4M flights) with FAA airport coordinates\nData Cleaning: Filtering for diversions, validation, removing duplicates, geocoding\nAnalysis: Temporal clustering (12-hour threshold) to identify disruption events\nVisualization: Interactive Plotly maps showing individual and system-wide impacts\nCommunication: Clear documentation and actionable insights",
    "crumbs": [
      "Home",
      "Flight Diversions: Understanding Air Traffic Disruptions"
    ]
  },
  {
    "objectID": "index.html#interactive-dashboard",
    "href": "index.html#interactive-dashboard",
    "title": "Flight Diversions: Understanding Air Traffic Disruptions",
    "section": "6 Interactive Dashboard",
    "text": "6 Interactive Dashboard\nExplore the data yourself with the interactive dashboard:\nRunning Locally:\ncd MUSA5500-finalProject\nconda activate geospatial\npython app.py\nThen visit: http://localhost:5006\nFeatures: - Filter by airline (multi-select) - Adjust date range (July 2021 - December 2024) - Real-time map and statistics updates - Explore top 15 diversion airports - Compare airlines side-by-side",
    "crumbs": [
      "Home",
      "Flight Diversions: Understanding Air Traffic Disruptions"
    ]
  },
  {
    "objectID": "index.html#documentation-structure",
    "href": "index.html#documentation-structure",
    "title": "Flight Diversions: Understanding Air Traffic Disruptions",
    "section": "7 Documentation Structure",
    "text": "7 Documentation Structure\nThis site contains complete documentation:\n\nData Collection: Data sources, cleaning pipeline, quality assessment\nAnalysis Methodology: Clustering approach, statistical methods, airline comparison\nVisualizations: Interactive maps with explanations of each cluster\nResults & Conclusions: Key findings, operational implications, recommendations\nDashboard Documentation: How to use the interactive Panel dashboard",
    "crumbs": [
      "Home",
      "Flight Diversions: Understanding Air Traffic Disruptions"
    ]
  },
  {
    "objectID": "index.html#quick-stats",
    "href": "index.html#quick-stats",
    "title": "Flight Diversions: Understanding Air Traffic Disruptions",
    "section": "8 Quick Stats",
    "text": "8 Quick Stats\n\n\n\nMetric\nValue\n\n\n\n\nAnalysis Period\nJuly 2021 - December 2024 (45 months)\n\n\nTotal Flights\n25,386,632\n\n\nTotal Diversions\n64,815\n\n\nDiversion Rate\n0.26%\n\n\nAirlines\n10 major carriers\n\n\nAirports\n377 diversion airports, 373 destination airports\n\n\nAvg Departure Delay\n32.2 minutes\n\n\nAvg Arrival Delay\n278.8 minutes\n\n\nMajor Clusters\n3 (SAN, DFW, ORD)",
    "crumbs": [
      "Home",
      "Flight Diversions: Understanding Air Traffic Disruptions"
    ]
  },
  {
    "objectID": "index.html#about-this-project",
    "href": "index.html#about-this-project",
    "title": "Flight Diversions: Understanding Air Traffic Disruptions",
    "section": "9 About This Project",
    "text": "9 About This Project\nThis analysis was conducted as a final project for MUSA 5500: Data Science for Planning and Policy at the University of Pennsylvania, emphasizing:\n\nMulti-source data integration (BTS + FAA databases)\nComplex geospatial and temporal clustering analysis\nInteractive web-based visualization and exploration\nClear communication of technical findings to multiple audiences\nActionable recommendations for industry stakeholders\n\n\n9.1 Technologies Used\n\nData Processing: Pandas (2.3.1), NumPy (2.3.1), GeoPandas (1.0.1)\nAnalysis: Temporal clustering (custom 12-hour threshold algorithm)\nVisualization: Plotly (6.5.0), Panel (1.7.5), Matplotlib\nDocumentation: Quarto, Jupyter Notebook\nDashboard: Panel (local deployment)\nCode: Python 3.13, GitHub",
    "crumbs": [
      "Home",
      "Flight Diversions: Understanding Air Traffic Disruptions"
    ]
  },
  {
    "objectID": "index.html#get-started",
    "href": "index.html#get-started",
    "title": "Flight Diversions: Understanding Air Traffic Disruptions",
    "section": "11 Get Started",
    "text": "11 Get Started\n\nStart here: Read the overview\nUnderstand the data: Check Data Collection\nLearn the approach: Review Analysis Methodology\nExplore visually: See the Visualizations\nUnderstand findings: Read Results & Conclusions",
    "crumbs": [
      "Home",
      "Flight Diversions: Understanding Air Traffic Disruptions"
    ]
  },
  {
    "objectID": "index.html#questions",
    "href": "index.html#questions",
    "title": "Flight Diversions: Understanding Air Traffic Disruptions",
    "section": "13 Questions?",
    "text": "13 Questions?\nThis project demonstrates: - Sound data science methodology applied to real-world aviation data - Complex analysis combining temporal, geospatial, and statistical methods - Clear communication of technical findings to diverse audiences - Effective use of interactive visualization for exploration and discovery - Actionable insights that drive operational and policy decisions\nFor questions about the methodology, data sources, analysis approach, or findings, see the detailed documentation pages or review the code in the Jupyter notebooks.\n\nProject Completed: December 2024\nAnalysis Period: July 2021 - December 2024\nAuthor: Jun\nCourse: MUSA 5500: Data Science for Planning and Policy",
    "crumbs": [
      "Home",
      "Flight Diversions: Understanding Air Traffic Disruptions"
    ]
  },
  {
    "objectID": "05-dashboard.html",
    "href": "05-dashboard.html",
    "title": "Interactive Dashboard",
    "section": "",
    "text": "This page documents the interactive Panel dashboard developed to explore flight diversion patterns. The dashboard allows users to filter and analyze diversions in real-time using multiple interactive controls."
  },
  {
    "objectID": "05-dashboard.html#overview",
    "href": "05-dashboard.html#overview",
    "title": "Interactive Dashboard",
    "section": "",
    "text": "This page documents the interactive Panel dashboard developed to explore flight diversion patterns. The dashboard allows users to filter and analyze diversions in real-time using multiple interactive controls."
  },
  {
    "objectID": "05-dashboard.html#dashboard-features",
    "href": "05-dashboard.html#dashboard-features",
    "title": "Interactive Dashboard",
    "section": "2 Dashboard Features",
    "text": "2 Dashboard Features\n\n2.1 Interactive Filters\nThe dashboard includes three main filters that work together to subset the data:\n1. Airline Selection - Multi-select dropdown to choose one or more airlines - Default: Top 3 airlines by diversion count - Enables airline-specific analysis and comparison\n2. Date Range Slider - Specify custom date ranges (July 2021 - December 2024) - Allows temporal analysis of diversions - Supports seasonal pattern exploration\n3. Dynamic Summary Statistics - Updates automatically when filters change - Displays: - Total diversions in filtered dataset - Number of unique diversion airports - Average departure delay (in minutes)\n\n\n2.2 Visualizations\n\n2.2.1 Top Diversion Airports Map\n\nInteractive geographic map showing the top 15 diversion airports\nMarker size represents frequency of diversions\nHover over airports to see exact diversion counts\nAllows geographic pattern identification\n\nWhat it shows: Which airports are receiving the most diverted flights during the selected time period and for chosen airlines.\nHow to interpret: Larger circles = more diversions. Geographic clusters suggest regional capacity issues.\n\n\n2.2.2 Diversions by Airline Bar Chart\n\nVertical bar chart ranking airlines by diversion count\nColors distinguish between airlines\nHover for exact numbers\n\nWhat it shows: How diversions are distributed across airlines in your filtered dataset.\nHow to interpret: Comparison of operational disruption frequency by carrier. May reflect differences in route networks, fleet size, or operational practices.\n\n\n2.2.3 Summary Statistics Cards\n\nThree key metrics displayed prominently\nBackground colors for quick visual scanning\nUpdate in real-time as filters change\n\nMetrics: 1. Total Diversions (Blue) - Sum of all diversions matching filters 2. Diversion Airports (Purple) - Count of unique airports receiving diversions 3. Avg Departure Delay (Green) - Mean delay for diverted flights"
  },
  {
    "objectID": "05-dashboard.html#how-to-use-the-dashboard",
    "href": "05-dashboard.html#how-to-use-the-dashboard",
    "title": "Interactive Dashboard",
    "section": "3 How to Use the Dashboard",
    "text": "3 How to Use the Dashboard\n\n3.1 Running Locally\nTo run the dashboard on your computer:\n# Navigate to project directory\ncd MUSA5500-finalProject\n\n# Activate geospatial environment\nconda activate geospatial\n\n# Run the app\npython app.py\nThen open your browser and go to: http://localhost:5006\n\n\n3.2 Basic Workflow\n\nStart with full dataset\n\nAll airlines selected\nFull date range (July 2021 - December 2024)\n\nSelect airlines of interest\n\nClick on airline dropdown\nChoose one or more carriers\nDashboard updates automatically\n\nNarrow date range\n\nUse date slider to focus on time period\nHelpful for identifying seasonal patterns\nCan zoom into specific disruption events\n\nAnalyze results\n\nCheck summary statistics\nExplore geographic distribution on map\nCompare airlines using bar chart\n\n\n\n\n3.3 Example Analyses\nFind Peak Diversion Periods - Set date range to one month - Select all airlines - Identify which airports spike in activity\nCompare Airline Performance - Set date range to full dataset - Select one airline at a time - Compare summary statistics across carriers\nExplore Regional Events - Focus on date range when you know a disruption occurred - Select relevant airlines - Analyze geographic concentration of diversions"
  },
  {
    "objectID": "05-dashboard.html#technical-details",
    "href": "05-dashboard.html#technical-details",
    "title": "Interactive Dashboard",
    "section": "4 Technical Details",
    "text": "4 Technical Details\n\n4.1 Technology Stack\n\nFramework: Panel (by HoloViz)\nData Processing: Pandas\nVisualization: Plotly\nData Source: BTS OTMC-OTP database (2021-2024)\n\n\n\n4.2 Cross-Filtering Implementation\nThe dashboard uses Panel’s reactive decorators (@pn.depends()) to automatically update all visualizations when any filter changes. This means: - Changing airline selection updates the map and chart - Adjusting date range recalculates all statistics - All changes are instantaneous (no need to click “Update”)\n\n\n4.3 Performance\n\nDashboard loads 8,651 total diversion records\nFiltering operations complete in &lt;1 second\nMap rendering optimized for smooth interaction"
  },
  {
    "objectID": "05-dashboard.html#insights-from-dashboard",
    "href": "05-dashboard.html#insights-from-dashboard",
    "title": "Interactive Dashboard",
    "section": "5 Insights from Dashboard",
    "text": "5 Insights from Dashboard\n\n5.1 Key Patterns Observable\nGeographic Concentration The map clearly shows which airports serve as primary diversion hubs. Common patterns include: - West Coast: ONT, PHX, LAX, SFO - Texas: IAH, DFW, SAT, AUS - Midwest: IND, STL, MKE - Southeast: ATL, MIA, MCO\nAirline Variation Significant differences exist in diversion frequency by airline, driven by: - Route network size and destinations served - Fleet composition and aircraft types - Operational practices and disruption management - Timing of analysis period (some airlines may have more flights during studied period)\nTemporal Patterns Using the date range filter reveals: - Peak diversion activity in winter months (December) - Regional variations in seasonal patterns - Major disruption events concentrated around specific dates\n\n\n5.2 Using Dashboard for Decision-Making\nFor Airlines: - Identify routes with highest diversion risk - Plan capacity and staffing for vulnerable airports - Compare performance to competitors\nFor Airports: - Understand diversion traffic patterns - Plan for overflow capacity during peak periods - Coordinate with other regional airports\nFor Researchers: - Explore relationships between variables - Generate hypotheses about disruption causes - Validate findings from other analyses"
  },
  {
    "objectID": "05-dashboard.html#limitations",
    "href": "05-dashboard.html#limitations",
    "title": "Interactive Dashboard",
    "section": "6 Limitations",
    "text": "6 Limitations\n\nNo causal information: Dashboard shows patterns but not causes\nHistorical data only: Cannot predict future diversions\nAggregated view: Individual flight details not shown\nWeather context missing: No concurrent weather data available\nFirst diversion only: Secondary diversions not tracked"
  },
  {
    "objectID": "05-dashboard.html#future-enhancements",
    "href": "05-dashboard.html#future-enhancements",
    "title": "Interactive Dashboard",
    "section": "7 Future Enhancements",
    "text": "7 Future Enhancements\nPotential improvements to dashboard:\n\nAdd weather overlay - Show weather conditions during diversion periods\nAnimated time series - Play through months/years to see patterns evolve\nRoute-specific analysis - Filter by origin and destination airports\nDelay correlation - Show relationship between diversion frequency and delays\nPredictive model - Use ML to predict diversion likelihood for future flights\nDownload data - Export filtered dataset as CSV"
  },
  {
    "objectID": "05-dashboard.html#questions-support",
    "href": "05-dashboard.html#questions-support",
    "title": "Interactive Dashboard",
    "section": "8 Questions & Support",
    "text": "8 Questions & Support\nFor questions about: - How to use: See “How to Use” section above - Data interpretation: See “Insights from Dashboard” section - Technical issues: Make sure you have Panel, Plotly, and Pandas installed in your geospatial environment - Analysis questions: See full documentation at main site\n\nDashboard Created: December 2024 Data Current Through: December 2024"
  },
  {
    "objectID": "03-visualization.html",
    "href": "03-visualization.html",
    "title": "Visualizations",
    "section": "",
    "text": "This section explains the interactive maps created to visualize flight diversion patterns. Each visualization reveals different aspects of how diversions cluster geographically and temporally across the U.S. aviation system.",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "03-visualization.html#overview",
    "href": "03-visualization.html#overview",
    "title": "Visualizations",
    "section": "",
    "text": "This section explains the interactive maps created to visualize flight diversion patterns. Each visualization reveals different aspects of how diversions cluster geographically and temporally across the U.S. aviation system.",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "03-visualization.html#visualization-types",
    "href": "03-visualization.html#visualization-types",
    "title": "Visualizations",
    "section": "2 Visualization Types",
    "text": "2 Visualization Types\n\n2.1 Individual Cluster Maps (Cascade View)\nShows all diversions for a single destination airport during a specific cluster period.\nWhat it displays: - Blue markers: Origin airports (where flights departed from) - Red stars: Diversion airports (where flights were redirected) - Gold diamonds: Primary destination airport - Curved colored lines: Flight paths, with each color representing a different airline\nHow to interpret: - Density of colored lines = volume of diversions during the event - Clustering of red stars = which airports absorbed most diversions - Geographic spread = how far diversions traveled - Airline colors = which carriers were most affected\n\n\n2.2 System-Wide Maps (Context View)\nShows all diversions system-wide that occurred during a cluster period, revealing the broader impact.\nWhat it displays: - All diversions across U.S. (not just to primary destination) - Same color scheme as cascade maps - Reveals secondary effects and system disruptions\nHow to interpret: - Compares primary cluster impact vs. system-wide impact - Shows whether disruption was localized or system-wide - Reveals which other airports absorbed overflow diversions",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "03-visualization.html#cluster-1-san-diego-san---december-18-21-2024",
    "href": "03-visualization.html#cluster-1-san-diego-san---december-18-21-2024",
    "title": "Visualizations",
    "section": "3 Cluster 1: San Diego (SAN) - December 18-21, 2024",
    "text": "3 Cluster 1: San Diego (SAN) - December 18-21, 2024\n\n3.1 Individual Cluster View: SAN Diversions Only\n\n\n\nSAN Individual Cluster Map\n\n\nThis map shows the 140 diversions specifically to San Diego International Airport during this 3-day period.\nKey observations: - Most flights originated from California and Arizona - Phoenix Sky Harbor (PHX) was the primary diversion airport (33 diversions) - Ontario International (ONT) also absorbed significant volume (48 diversions) - Primarily West Coast airlines affected - Tight geographic clustering suggests regional weather event or airport capacity issue\nWhat it tells us: When SAN experiences a disruption, nearby California airports (ONT, LAX) are the first alternatives used by airlines, followed by Arizona airports (PHX, PSP).\n\n\n3.2 System-Wide View: All U.S. Diversions During SAN Cluster\n\n\n\nSAN System-Wide Map\n\n\nThis map reveals the complete aviation system response during the same period - ALL diversions across the U.S., not just those to SAN.\nKey observations: - 290 total diversions vs. 140 to SAN (48.3% to primary airport) - Other destinations affected: SNA (30), EYW (20), BOS (17), LAX (7) - 60 total destination airports affected (not just SAN) - 73 origin airports involved - Geographically widespread: West Coast, East Coast, and Southeast all impacted - Multiple airlines contributed to the cascade\nWhat it tells us: The SAN disruption had system-wide ripple effects. When one major airport is affected, diversions cascade across the entire network, affecting other cities and regions. This is a true system-wide disruption event, not just a localized issue.\nInterpretation: Only about half of flights heading to SAN were diverted there. The other half were diverted elsewhere, indicating either SAN’s capacity to absorb only part of the demand, or airlines making strategic decisions to distribute diversions across multiple airports.",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "03-visualization.html#cluster-2-dallasfort-worth-dfw---november-4-5-2024",
    "href": "03-visualization.html#cluster-2-dallasfort-worth-dfw---november-4-5-2024",
    "title": "Visualizations",
    "section": "4 Cluster 2: Dallas/Fort Worth (DFW) - November 4-5, 2024",
    "text": "4 Cluster 2: Dallas/Fort Worth (DFW) - November 4-5, 2024\n\n4.1 Individual Cluster View: DFW Diversions Only\n\n\n\nDFW Individual Cluster Map\n\n\nThis map shows the 110 diversions specifically to Dallas/Fort Worth International Airport during this 2-day period.\nKey observations: - Origins concentrated in Northeast, Southeast, and Midwest - Houston Intercontinental (IAH) was the primary diversion airport (28 diversions) - Regional pattern: Oklahoma City (OKC), San Antonio (SAT), Austin (AUS) also active - Primarily American and Southwest airlines (major DFW hubs) - Texas region tightly clustered\nWhat it tells us: DFW diversions are concentrated within the Texas/South-Central region, with Houston emerging as the backup for Dallas flights.\n\n\n4.2 System-Wide View: All U.S. Diversions During DFW Cluster\n\n\n\nDFW System-Wide Map\n\n\nThis map shows all diversions during the same period across the entire U.S.\nKey observations: - 186 total diversions vs. 110 to DFW (59.1% to primary airport) - Secondary destinations: DAL (32), AUS (13), SAT (12) - 40 diversion airports used - 89 origin airports involved - More geographically concentrated than SAN event - Primarily South-Central U.S. (regional event)\nWhat it tells us: This was a more regional event compared to SAN. The disruption impact stayed concentrated in Texas/South-Central region, with 59% of diversions going to the primary airport DFW. Other regional airports absorbed the remaining volume.\nInterpretation: DFW disruptions have less system-wide impact than coastal airport disruptions. The regional nature of this event kept diversions contained within the Texas hub region.",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "03-visualization.html#cluster-3-chicago-ohare-ord---august-24-26-2021",
    "href": "03-visualization.html#cluster-3-chicago-ohare-ord---august-24-26-2021",
    "title": "Visualizations",
    "section": "5 Cluster 3: Chicago O’Hare (ORD) - August 24-26, 2021",
    "text": "5 Cluster 3: Chicago O’Hare (ORD) - August 24-26, 2021\n\n5.1 Individual Cluster View: ORD Diversions Only\n\n\n\nORD Individual Cluster Map\n\n\nThis map shows the 108 diversions specifically to Chicago O’Hare International Airport during this 3-day period.\nKey observations: - Origins from across entire U.S.: Southwest, Midwest, Northeast, Southeast - Indianapolis (IND) was the primary diversion airport (24 diversions) - Secondary diversion airports: St. Louis (STL), Milwaukee (MKE) - Midwest corridor heavily utilized - United Airlines dominant (major ORD carrier)\nWhat it tells us: When ORD is unavailable, the Midwest corridor airports (IND, STL, MKE) form a network of alternatives, with IND being the primary choice.\n\n\n5.2 System-Wide View: All U.S. Diversions During ORD Cluster\n\n\n\nORD System-Wide Map\n\n\nThis map shows all diversions during the same period across the entire U.S.\nKey observations: - 187 total diversions vs. 108 to ORD (57.8% to primary airport) - Secondary destinations: MCO (19), MDW (14), STL (9) - 51 diversion airports used - 87 origin airports involved - Similar to DFW in concentration (regional event) - Midwest and surrounding regions primarily affected\nWhat it tells us: ORD disruptions have moderate system-wide impact - less than coastal airports but more geographically spread than DFW. The Midwest location means disruptions don’t cascade to both coasts, but do affect a broad Midwest-to-Southeast corridor.\nInterpretation: Hub airport disruptions vary in system-wide impact based on geography. Central hubs like ORD and DFW have more contained impacts, while coastal hubs like SAN have broader ripple effects.",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "03-visualization.html#key-insights-from-visualizations",
    "href": "03-visualization.html#key-insights-from-visualizations",
    "title": "Visualizations",
    "section": "6 Key Insights from Visualizations",
    "text": "6 Key Insights from Visualizations\n\n6.1 Pattern 1: Geographic Clustering of Diversions\nDiversions concentrate in specific regional hubs rather than spreading randomly: - West Coast: ONT, PHX, LAX, SFO - South-Central: IAH, DFW, SAT, AUS - Midwest: IND, STL, MKE\n\n\n6.2 Pattern 2: System-Wide vs. Regional Events\n\nSAN (coastal, major hub): 48.3% to primary airport, 60 destinations affected (system-wide)\nDFW (regional hub): 59.1% to primary airport, 17 destinations affected (regional)\nORD (central hub): 57.8% to primary airport, 32 destinations affected (regional-to-moderate)\n\n\n\n6.3 Pattern 3: Airline-Specific Patterns\nColors on maps reveal airline-specific routing: - Major airlines (AA, DL, UA, SW) dominate specific hubs - Each airline has preferred diversion airports - Enables prediction of diversion destinations based on carrier\n\n\n6.4 Pattern 4: Cascading Effects\nWhen primary destination unavailable: 1. Flights divert to nearest appropriate airport 2. Overflow spills to secondary airports 3. Eventually reaches tertiary alternatives if needed 4. Creates geographic ripple effect through network",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "03-visualization.html#how-to-use-these-visualizations",
    "href": "03-visualization.html#how-to-use-these-visualizations",
    "title": "Visualizations",
    "section": "7 How to Use These Visualizations",
    "text": "7 How to Use These Visualizations\n\n7.1 For Operational Planning\n\nAirlines: Identify which airports to pre-position aircraft at for disruption management\nAirports: Anticipate diversion volume during disruption events\nATC: Prepare to route traffic to alternative airports\n\n\n\n7.2 For Understanding System Resilience\n\nNotice which airports absorb diversions (IND, IAH, ONT, etc.)\nIdentify bottlenecks where diversions cannot be easily accommodated\nReveal geographic redundancy in the network\n\n\n\n7.3 For Identifying Root Causes\n\nTemporal clustering (all within 12 hours) suggests single root cause\nGeographic concentration suggests capacity or weather issue\nAirline-specific patterns visible in colored lines",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "03-visualization.html#limitations-of-visualizations",
    "href": "03-visualization.html#limitations-of-visualizations",
    "title": "Visualizations",
    "section": "8 Limitations of Visualizations",
    "text": "8 Limitations of Visualizations\n\nFirst diversion only: Maps don’t show secondary or tertiary diversions\nNo causal data: Cannot determine weather, mechanical, or ATC reasons\nAggregated view: Individual flight details hidden\nHistorical only: Past patterns don’t guarantee future outcomes\nMercator projection: Distorts distances, especially at high latitudes",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "03-visualization.html#technical-details",
    "href": "03-visualization.html#technical-details",
    "title": "Visualizations",
    "section": "9 Technical Details",
    "text": "9 Technical Details\n\n9.1 Visualization Tools\n\nFramework: Plotly (interactive web maps)\nData: BTS OTMC-OTP flight records\nCoordinate System: WGS84 (latitude/longitude)\nProjection: Mercator (standard web maps)\n\n\n\n9.2 Map Features\n\nInteractivity: Hover for details, zoom/pan navigation\nExport: Download as PNG image using Plotly tools\nColors: Assigned by airline for pattern recognition\n\n\n\n9.3 Bezier Curves\nFlight paths use quadratic Bezier curves rather than straight lines because: - Straight lines overlap and become illegible - Curved paths separate overlapping routes visually - Curves approximate great-circle routes on Mercator projection\n\nVisualizations Created: December 2024 Data Period: July 2021 - December 2024 Clusters Visualized: 3 major diversion events Total Maps: 6 (3 cascade + 3 system-wide) — title: “Visualizations” —",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "5500_flightDiversion.html",
    "href": "5500_flightDiversion.html",
    "title": "Reading in the flight files",
    "section": "",
    "text": "#basic imports\nimport pandas as pd\nimport geopandas as gpd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport geopandas as gpd\nimport seaborn as sns\nfrom datetime import datetime, timedelta\nfrom zoneinfo import ZoneInfo\nimport glob\n# testing code using one month's data\n#flights = pd.read_csv('data/2021_07_OTMC_OTP.csv')\n# lists all flight data files (2021-07 to 2024-12) to be reviewed and combined\nfile_list = sorted(glob.glob('data/*_OTMC_OTP.csv')) \n\n# check that all files have the same column names\ncolumns_set = []\nfor file in file_list:\n    df = pd.read_csv(file, nrows=0)  \n    columns_set.append(set(df.columns))\n\nall_same_columns = all(columns == columns_set[0] for columns in columns_set)\nprint(\"All files have the same columns:\", all_same_columns)\n\n# if all columns match, combine the files into a single DataFrame\nif all_same_columns:\n    flights_list = [pd.read_csv(f) for f in file_list]\n    flights = pd.concat(flights_list, ignore_index=True)\n    print(\"Combined DataFrame shape:\", flights.shape)\nelse:\n    print(\"Warning: Not all files have the same columns. Check differences before combining.\")"
  },
  {
    "objectID": "5500_flightDiversion.html#data-cleaning-to-get-only-diverted-flights",
    "href": "5500_flightDiversion.html#data-cleaning-to-get-only-diverted-flights",
    "title": "Reading in the flight files",
    "section": "1 Data cleaning to get only diverted flights",
    "text": "1 Data cleaning to get only diverted flights\nSee how flight diversion was determined and soft data cleaning\n\n# filter diverted flights only\n# must have a diversion 1 airport that is different from the original destination\ndiverted_flights = flights[\n    (\n        flights['Div1Airport'].notna() & \n        (flights['Div1Airport'] != flights['Dest'])\n    )\n].copy()\n\n#drop columns that do not have any data\nempty_columns = diverted_flights.columns[diverted_flights.isna().all()]\ndiverted_flights = diverted_flights.dropna(axis=1, how='all')\n\n# drop rows marked as duplicates\ndiverted_flights = diverted_flights.drop(diverted_flights[diverted_flights['Duplicate'] == 'Y'].index)\n\n\n# save diverted flights to a new CSV because this is the main data we will be working with and the original files were huge \ndiverted_flights.to_csv('diverted_flights.csv', index=False)"
  },
  {
    "objectID": "5500_flightDiversion.html#diversion-data-calculations",
    "href": "5500_flightDiversion.html#diversion-data-calculations",
    "title": "Reading in the flight files",
    "section": "2 Diversion Data Calculations",
    "text": "2 Diversion Data Calculations\nIf you are happy with how the data was cleaned, START RUNNING HERE\n\n#if you are running this and are happy with the diverted_flights dataframe, just read in the saved CSV\n\ndiverted_flights = pd.read_csv('diverted_flights.csv')\n\n/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/397122467.py:3: DtypeWarning: Columns (11,13,94,101) have mixed types. Specify dtype option on import or set low_memory=False.\n  diverted_flights = pd.read_csv('diverted_flights.csv')\n\n\n\n# flight date is original date of flight, not calculating for diversion\n# calculate actual departure date and time\n\n# convert to timedatetime for time calculations\ndiverted_flights['FlightDate'] = pd.to_datetime(diverted_flights['FlightDate'], errors='coerce')\n\n#drop missing DepTime (cancelled flight) and fill DepDelay for calculations\ndiverted_flights['DepTime'] = diverted_flights['DepTime'].dropna()\ndiverted_flights['DepDelay'] = diverted_flights['DepDelay'].fillna(0)\n\n# calculate actual departure date\ndiverted_flights['ActualDep'] = (\n    diverted_flights['FlightDate'] +\n    pd.to_timedelta(diverted_flights['DepTime'] // 100, unit='h') +\n    pd.to_timedelta(diverted_flights['DepTime'] % 100, unit='m') +\n    pd.to_timedelta(diverted_flights['DepDelay'], unit='m')\n)\n\ndiverted_flights['ActualDepDate'] = diverted_flights['ActualDep'].dt.date\ndiverted_flights['ActualDepTime'] = diverted_flights['ActualDep'].dt.time\n\n\n# just checking ActualDepTime and DepTime columns\ntime_check = diverted_flights[['DepTime', 'ActualDepTime']]\n\n# the times are relatively similar, but enough to matter for date changes\n# we will use ActualDepDate and ActualDepTime for further analysis for data completeness\n\n\n# extract year and month in datetime for analysis\ndiverted_flights['year'] = pd.to_datetime(diverted_flights['ActualDep']).dt.year\ndiverted_flights['month'] = pd.to_datetime(diverted_flights['ActualDep']).dt.month\n\n# because this data is showing true flight times instead of scheduled, limit to 2024 only\ndiverted_flights = diverted_flights[diverted_flights['year'] &lt;= 2024]\n\n# heatmap of total diversions by month and year\nmonth_year = diverted_flights.pivot_table(\n    values='FlightDate',\n    index='month',\n    columns='year',\n    aggfunc='count',\n    fill_value=0\n)\n\n# Create figure\nfig, ax = plt.subplots(figsize=(12, 8))\n\n# Create heatmap\nsns.heatmap(\n    month_year,\n    cmap='YlOrRd',\n    annot=True,  # Show numbers in cells\n    fmt='g',  # Format as integers\n    ax=ax,\n    cbar_kws={'label': 'Number of Diversions'},\n    linewidths=0.5,\n    linecolor='white'\n)\n\n# labeling for clarity\nmonth_names = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', \n               'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']\nexisting_months = month_year.index.tolist()\nexisting_labels = [month_names[int(m)-1] for m in existing_months]\nax.set_yticklabels(existing_labels, rotation=0)\nax.set_xlabel('Year', fontsize=12, fontweight='bold')\nax.set_ylabel('Month', fontsize=12, fontweight='bold')\nax.set_title('Flight Diversions by Month and Year (07/2021-12/2024)', \n             fontsize=14, fontweight='bold', pad=20)\n\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\n\n\n2.1 Did the diverted flight reach their destination?\n\n# Check if flight eventually reached destination through Div2Airport or Div3Airport\ndiverted_flights['reached_dest'] = (\n    (diverted_flights['Div2Airport'] == diverted_flights['Dest']) | \n    (diverted_flights['Div3Airport'] == diverted_flights['Dest'])\n)\n\n# Create two separate datasets\nreached_dest = diverted_flights[diverted_flights['reached_dest'] == True].copy()\nnot_reached_dest = diverted_flights[diverted_flights['reached_dest'] == False].copy()\n\n\n#testing because the reached_dest is really low \nmanual_check = diverted_flights[['Origin', 'Dest', 'Div1Airport', 'Div2Airport', 'Div3Airport', 'DivReachedDest']].copy()\n\n# Show flights that have Div2 or Div3 data\nhas_multiple_divs = manual_check[(manual_check['Div2Airport'].notna()) | (manual_check['Div3Airport'].notna())]\n\n\nreached_dest_column = diverted_flights[diverted_flights['DivReachedDest'] == 1].copy()\nnot_reached_dest_column = diverted_flights[diverted_flights['DivReachedDest'] != 1].copy()\n# hmm... DivReachedDest does not show the same results as our calculated reached_dest column \n# NEEDS TO BE INVESTIGATED FURTHER"
  },
  {
    "objectID": "5500_flightDiversion.html#reading-in-the-location-data",
    "href": "5500_flightDiversion.html#reading-in-the-location-data",
    "title": "Reading in the flight files",
    "section": "3 Reading in the location data",
    "text": "3 Reading in the location data\n\nairports = pd.read_csv('data/Airport_Loc.csv')\n\n\n3.1 Cleaning location data to only save the airport information that we need for diverted flights\nThey have non-US airport data that we don’t need/use\n\n# Get all unique airports used in diverted flights dataset\nunique_airports = set()\nunique_airports.update(diverted_flights['Origin'].unique())\nunique_airports.update(diverted_flights['Dest'].unique())\nunique_airports.update(diverted_flights['Div1Airport'].dropna().unique())\n\n# Add Div2 and Div3 if they have data\nif diverted_flights['Div2Airport'].notna().sum() &gt; 0:\n    unique_airports.update(diverted_flights['Div2Airport'].dropna().unique())\nif diverted_flights['Div3Airport'].notna().sum() &gt; 0:\n    unique_airports.update(diverted_flights['Div3Airport'].dropna().unique())\n\n# Filter airport coordinates to only airports we need\nairports_clean = airports[airports['AIRPORT'].isin(unique_airports)].copy()\n\n\nairports_clean.columns\n\nIndex(['AIRPORT_SEQ_ID', 'AIRPORT_ID', 'AIRPORT', 'DISPLAY_AIRPORT_NAME',\n       'DISPLAY_AIRPORT_CITY_NAME_FULL', 'AIRPORT_WAC', 'AIRPORT_COUNTRY_NAME',\n       'AIRPORT_COUNTRY_CODE_ISO', 'AIRPORT_STATE_NAME', 'AIRPORT_STATE_CODE',\n       'AIRPORT_STATE_FIPS', 'CITY_MARKET_ID', 'DISPLAY_CITY_MARKET_NAME_FULL',\n       'CITY_MARKET_WAC', 'LAT_DEGREES', 'LAT_HEMISPHERE', 'LAT_MINUTES',\n       'LAT_SECONDS', 'LATITUDE', 'LON_DEGREES', 'LON_HEMISPHERE',\n       'LON_MINUTES', 'LON_SECONDS', 'LONGITUDE', 'UTC_LOCAL_TIME_VARIATION',\n       'AIRPORT_START_DATE', 'AIRPORT_THRU_DATE', 'AIRPORT_IS_CLOSED',\n       'AIRPORT_IS_LATEST', 'Unnamed: 29'],\n      dtype='object')\n\n\n\n#drop all duplicate airport codes\nairports_clean = airports_clean.drop_duplicates(subset=['AIRPORT'])\n\n\n# check that all unique airports are accounted for and there is no missing location data\nmissing_airports = unique_airports - set(airports_clean['AIRPORT'].unique())\nif len(missing_airports) &gt; 0:\n    print(f\"\\nMissing airports: {sorted(missing_airports)}\")\n\n\nMissing airports: ['BNH']\n\n\n\n# i am manually going to input this airport data since there is only one missing airport (from the FAA website)\n# BNH is a permanently closed airport in Boston - Boston Harbor Seaplane Base\n\nBNH_airport = pd.DataFrame({\n    'AIRPORT': ['BNH'],\n    'LONGITUDE': [-71.0258333],\n    'LATITUDE': [42.3525000]\n})\n\n# Add to airports_used dataset\nairports_clean = pd.concat([airports_clean, BNH_airport], ignore_index=True)\n\n\n#check to make sure that it added\n\nif 'BNH' in airports_clean['AIRPORT'].values:\n    print(\"BNH airport data successfully added.\")\nelse: \n    print(\"BNH airport data NOT found.\")\n\nBNH airport data successfully added."
  },
  {
    "objectID": "5500_flightDiversion.html#departureorigin-airport-analysis",
    "href": "5500_flightDiversion.html#departureorigin-airport-analysis",
    "title": "Reading in the flight files",
    "section": "4 Departure/Origin Airport Analysis",
    "text": "4 Departure/Origin Airport Analysis\n\n#there are often diversion clusters over the span of a few days\n\n#Define departure cluster, if time gap between diversions is more than 12 hours, start a new cluster\ndef origin_cluster(group, max_gap_hours=12):\n    group = group.sort_values('ActualDep')\n    group['time_since_last'] = group['ActualDep'].diff().dt.total_seconds() / 3600  # hours\n    group['new_cluster'] = (group['time_since_last'] &gt; max_gap_hours).fillna(True)\n    group['cluster_id'] = group['new_cluster'].cumsum()\n    return group\n\n\n# due to local time zones, we are not able to look purely at times and dates, each airport needs to be looked at individually. \n\ndiverted_by_origin = diverted_flights.copy()  \ndiverted_by_origin = diverted_by_origin.groupby('Origin', group_keys=False).apply(origin_cluster)\n\n# cluster summary by airport\ncluster_summary_by_origin = diverted_by_origin.groupby(['Origin', 'cluster_id']).agg({\n    'ActualDep': ['min', 'max', 'count']\n}).reset_index()\ncluster_summary_by_origin.columns = ['Origin', 'cluster_id', 'cluster_start_origin', 'cluster_end_origin', 'num_diversions_origin']\n\n# get biggest clusters by number of diversions\nbiggest_origin_clusters = cluster_summary_by_origin.nlargest(20, 'num_diversions_origin')\nbiggest_origin_clusters"
  },
  {
    "objectID": "5500_flightDiversion.html#arrivaldestination-airport-analysis",
    "href": "5500_flightDiversion.html#arrivaldestination-airport-analysis",
    "title": "Reading in the flight files",
    "section": "5 Arrival/Destination Airport Analysis",
    "text": "5 Arrival/Destination Airport Analysis\n\n5.1 Original Arrival Time Airport Analysis\n\n# Analyzing when destination airports had issues causing diversions... using the CRS arrival time to potentially weather or airport operations related\n\n#Define arrival cluster, if time gap between diversions is more than 12 hours, start a new cluster\ndef dest_cluster(group, max_gap_hours=12):\n    group = group.sort_values('ScheduledArrival')  # Sort by datetime, not integer\n    group['time_since_last'] = group['ScheduledArrival'].diff().dt.total_seconds() / 3600  # hours\n    group['new_cluster'] = (group['time_since_last'] &gt; max_gap_hours).fillna(True)\n    group['cluster_id'] = group['new_cluster'].cumsum()\n    return group\n\n\n# calculate scheduled arrival in datetime \ndiverted_flights['ScheduledArrival'] = (\n    diverted_flights['FlightDate'] +\n    pd.to_timedelta(diverted_flights['CRSArrTime'] // 100, unit='h') +\n    pd.to_timedelta(diverted_flights['CRSArrTime'] % 100, unit='m')\n)\n# group by destination airport\ndiverted_by_dest = diverted_flights.copy()  \ndiverted_by_dest = diverted_by_dest.groupby('Dest', group_keys=False).apply(dest_cluster)\n\n# Cluster by DESTINATION airport based on when they were supposed to arrive\ncluster_summary_by_dest = diverted_by_dest.groupby(['Dest', 'cluster_id']).agg({\n    'ScheduledArrival': ['min', 'max', 'count'],\n    'Origin': lambda x: x.nunique(),  # How many different origins affected\n    'Div1Airport': lambda x: x.mode()[0] if len(x.mode()) &gt; 0 else x.iloc[0]  # Where did they divert to?\n}).reset_index()\n\ncluster_summary_by_dest.columns = ['Dest', 'cluster_id', 'cluster_start_dest', 'cluster_end_dest', 'num_diversions_dest', 'num_origins_affected', 'primary_diversion_airport']\n\n# Get biggest clusters by number of diversions\nbiggest_dest_clusters = cluster_summary_by_dest.nlargest(20, 'num_diversions_dest')\nbiggest_dest_clusters\n\n\n\n5.2 Actual Arrival Time Airport Analysis\n\n# Analyzing when destination airports had issues causing diversions... using the actual arrival time to see if delays in arrival times correlate with diversions\n# this could mean that the decision to divert was made closer to arrival time rather than at departure (last minute weather changes, runway issues, etc.)\n\n# Define arrival cluster based on estimated arrival, delay dependent, if time gap between diversions is more than 12 hours, start a new cluster\ndef dest_actual_cluster(group, max_gap_hours=12):\n    group = group.sort_values('EstimatedActualArrival')\n    group['time_since_last'] = group['EstimatedActualArrival'].diff().dt.total_seconds() / 3600  # hours\n    group['new_cluster'] = (group['time_since_last'] &gt; max_gap_hours).fillna(True)\n    group['cluster_id'] = group['new_cluster'].cumsum()\n    return group\n\n\n# Calculate estimated actual arrival time using actual departure + expected flight duration\ndiverted_flights['CRSElapsedTime'] = diverted_flights['CRSElapsedTime'].fillna(0)\n\ndiverted_flights['EstimatedActualArrival'] = (\n    diverted_flights['ActualDep'] +\n    pd.to_timedelta(diverted_flights['CRSElapsedTime'], unit='m')\n)\n\n# Create separate dataframe for destination actual arrival analysis\ndiverted_by_dest_actual = diverted_flights.copy()\n\n# Cluster by destination airport based on estimated actual arrival time\ndiverted_by_dest_actual = diverted_by_dest_actual.groupby('Dest', group_keys=False).apply(dest_actual_cluster)\n\n# Cluster summary by DESTINATION airport using actual arrival\ncluster_summary_by_dest_actual = diverted_by_dest_actual.groupby(['Dest', 'cluster_id']).agg({\n    'EstimatedActualArrival': ['min', 'max', 'count'],\n    'Origin': lambda x: x.nunique(),  # How many different origins affected\n    'Div1Airport': lambda x: x.mode()[0] if len(x.mode()) &gt; 0 else x.iloc[0]  # Where did they divert to?\n}).reset_index()\n\ncluster_summary_by_dest_actual.columns = ['Dest', 'cluster_id', 'cluster_start_dest_actual', 'cluster_end_dest_actual', 'num_diversions_dest_actual', 'num_origins_affected', 'primary_diversion_airport']\n\n# Get biggest destination clusters by number of diversions\nbiggest_dest_actual_clusters = cluster_summary_by_dest_actual.nlargest(20, 'num_diversions_dest_actual')\nbiggest_dest_actual_clusters\n\n/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/2964285410.py:13: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.\n  diverted_by_dest_actual = diverted_by_dest_actual.groupby('Dest', group_keys=False).apply(dest_actual_cluster)\n\n\n\n\n\n\n\n\n\nDest\ncluster_id\ncluster_start_dest_actual\ncluster_end_dest_actual\nnum_diversions_dest_actual\nnum_origins_affected\nprimary_diversion_airport\n\n\n\n\n22411\nSAN\n283\n2024-12-18 16:39:00\n2024-12-21 16:55:00\n140\n43\nPHX\n\n\n7320\nDFW\n513\n2024-11-04 12:28:00\n2024-11-05 00:50:00\n110\n71\nIAH\n\n\n18498\nORD\n36\n2021-08-24 13:49:00\n2021-08-26 04:25:00\n108\n72\nIND\n\n\n14494\nLGA\n106\n2022-03-17 07:19:00\n2022-03-18 09:02:00\n101\n44\nJFK\n\n\n1320\nATL\n245\n2023-08-06 11:45:00\n2023-08-07 20:09:00\n99\n62\nBNA\n\n\n1142\nATL\n67\n2022-01-28 14:36:00\n2022-01-29 07:29:00\n95\n69\nCAE\n\n\n7340\nDFW\n533\n2024-12-24 07:14:00\n2024-12-24 22:59:00\n94\n72\nIAH\n\n\n7239\nDFW\n432\n2024-05-26 09:11:00\n2024-05-29 01:19:00\n93\n69\nOKC\n\n\n6979\nDFW\n172\n2022-08-10 14:32:00\n2022-08-10 21:58:00\n92\n74\nTUL\n\n\n7338\nDFW\n531\n2024-12-16 09:08:00\n2024-12-16 21:13:00\n91\n76\nTUL\n\n\n7242\nDFW\n435\n2024-06-02 07:04:00\n2024-06-03 03:06:00\n90\n73\nOKC\n\n\n13884\nLAX\n239\n2023-02-23 13:51:00\n2023-02-26 02:12:00\n90\n39\nLAS\n\n\n6807\nDFW\n0\n2021-07-01 04:26:00\n2021-07-02 15:11:00\n88\n65\nAUS\n\n\n7014\nDFW\n207\n2022-10-24 08:39:00\n2022-10-25 00:39:00\n87\n70\nIAH\n\n\n19005\nORD\n543\n2024-07-13 04:03:00\n2024-07-16 10:43:00\n87\n45\nIND\n\n\n14758\nLGA\n370\n2023-09-07 01:45:00\n2023-09-10 13:36:00\n83\n33\nPIT\n\n\n6526\nDEN\n268\n2023-04-18 16:57:00\n2023-04-19 21:37:00\n82\n58\nCOS\n\n\n6828\nDFW\n21\n2021-08-01 06:22:00\n2021-08-02 07:07:00\n82\n66\nOKC\n\n\n6985\nDFW\n178\n2022-08-21 12:21:00\n2022-08-22 17:43:00\n82\n62\nOKC\n\n\n6557\nDEN\n299\n2023-06-21 09:26:00\n2023-06-22 05:37:00\n77\n51\nSLC\n\n\n\n\n\n\n\n\n5.2.1 Local/Regional/Widespread Diversion Cluster Determination\n\n# Analyzing what other airports experienced diversions during the top destination cluster events\n# this helps identify if diversions were localized to one destination or part of a broader regional/system issue\n\n# Get the top 5 destination clusters\ntop_5_dest_clusters = biggest_dest_actual_clusters.head(5)\n\nprint(\"TOP 5 DESTINATION CLUSTER EVENTS\\n\")\nfor idx, cluster in top_5_dest_clusters.iterrows():\n    print(f\"\\nCluster {idx + 1}:\")\n    print(f\"  Destination: {cluster['Dest']}\")\n    print(f\"  Time period: {cluster['cluster_start_dest_actual']} to {cluster['cluster_end_dest_actual']}\")\n    print(f\"  Diversions to this destination: {cluster['num_diversions_dest_actual']}\")\n    print(f\"  Origins affected: {cluster['num_origins_affected']}\")\n    print(f\"  Primary diversion airport: {cluster['primary_diversion_airport']}\")\n\n\n\nTOP 5 DESTINATION CLUSTER EVENTS\n\n\nCluster 22412:\n  Destination: SAN\n  Time period: 2024-12-18 16:39:00 to 2024-12-21 16:55:00\n  Diversions to this destination: 140\n  Origins affected: 43\n  Primary diversion airport: PHX\n\nCluster 7321:\n  Destination: DFW\n  Time period: 2024-11-04 12:28:00 to 2024-11-05 00:50:00\n  Diversions to this destination: 110\n  Origins affected: 71\n  Primary diversion airport: IAH\n\nCluster 18499:\n  Destination: ORD\n  Time period: 2021-08-24 13:49:00 to 2021-08-26 04:25:00\n  Diversions to this destination: 108\n  Origins affected: 72\n  Primary diversion airport: IND\n\nCluster 14495:\n  Destination: LGA\n  Time period: 2022-03-17 07:19:00 to 2022-03-18 09:02:00\n  Diversions to this destination: 101\n  Origins affected: 44\n  Primary diversion airport: JFK\n\nCluster 1321:\n  Destination: ATL\n  Time period: 2023-08-06 11:45:00 to 2023-08-07 20:09:00\n  Diversions to this destination: 99\n  Origins affected: 62\n  Primary diversion airport: BNA\n\n\n\n# For each top cluster, find ALL diversions happening during that time window\nfor idx, cluster in top_5_dest_clusters.iterrows():\n    dest_airport = cluster['Dest']\n    cluster_start = cluster['cluster_start_dest_actual']\n    cluster_end = cluster['cluster_end_dest_actual']\n    \n    print(f\"\\n{'='*80}\")\n    print(f\"CLUSTER EVENT: {dest_airport} ({cluster_start} to {cluster_end})\")\n    print(f\"{'='*80}\\n\")\n    \n    # all flights with estimated actual arrivals during this time window (local)\n    all_diversions_during_cluster = diverted_flights[\n        (diverted_flights['EstimatedActualArrival'] &gt;= cluster_start) &\n        (diverted_flights['EstimatedActualArrival'] &lt;= cluster_end)\n    ].copy()\n    \n    print(f\"Total diversions system-wide during this period: {len(all_diversions_during_cluster)}\")\n    print(f\"Diversions to {dest_airport}: {len(all_diversions_during_cluster[all_diversions_during_cluster['Dest'] == dest_airport])}\")\n    print(f\"Diversions to OTHER destinations: {len(all_diversions_during_cluster[all_diversions_during_cluster['Dest'] != dest_airport])}\\n\")\n    \n    # Break down by destination airport\n    print(\"Diversions by intended destination airport:\")\n    dest_breakdown = all_diversions_during_cluster.groupby('Dest').agg({\n        'Origin': 'count',\n        'Div1Airport': lambda x: x.mode()[0] if len(x.mode()) &gt; 0 else 'Various'\n    }).rename(columns={'Origin': 'num_diversions', 'Div1Airport': 'common_diversion'})\n    dest_breakdown = dest_breakdown.sort_values('num_diversions', ascending=False)\n    print(dest_breakdown.head(10))\n    \n    # Break down by diversion airport (where they actually landed)\n    print(f\"\\nDiversion airports used during this period:\")\n    div_airport_breakdown = all_diversions_during_cluster.groupby('Div1Airport').size().sort_values(ascending=False)\n    print(div_airport_breakdown.head(10))\n    \n    # Break down by origin airport\n    print(f\"\\nOrigin airports affected:\")\n    origin_breakdown = all_diversions_during_cluster.groupby('Origin').size().sort_values(ascending=False)\n    print(origin_breakdown.head(10))\n    \n    # Geographic spread analysis\n    unique_dests = all_diversions_during_cluster['Dest'].nunique()\n    unique_origins = all_diversions_during_cluster['Origin'].nunique()\n    unique_div_airports = all_diversions_during_cluster['Div1Airport'].nunique()\n    \n    print(f\"\\nGeographic spread:\")\n    print(f\"  Unique destination airports affected: {unique_dests}\")\n    print(f\"  Unique origin airports: {unique_origins}\")\n    print(f\"  Unique diversion airports used: {unique_div_airports}\")\n    \n    # Calculate if this was a localized or widespread event\n    pct_to_main_dest = (len(all_diversions_during_cluster[all_diversions_during_cluster['Dest'] == dest_airport]) / \n                        len(all_diversions_during_cluster) * 100)\n    \n    print(f\"\\nEvent characterization:\")\n    if pct_to_main_dest &gt; 80:\n        print(f\"  LOCALIZED EVENT - {pct_to_main_dest:.1f}% of diversions were to {dest_airport}\")\n    elif pct_to_main_dest &gt; 50:\n        print(f\"  REGIONAL EVENT - {pct_to_main_dest:.1f}% of diversions were to {dest_airport}, but other airports also affected\")\n    else:\n        print(f\"  WIDESPREAD EVENT - Only {pct_to_main_dest:.1f}% of diversions were to {dest_airport}, many other airports affected\")\n\n\n================================================================================\nCLUSTER EVENT: SAN (2024-12-18 16:39:00 to 2024-12-21 16:55:00)\n================================================================================\n\nTotal diversions system-wide during this period: 290\nDiversions to SAN: 140\nDiversions to OTHER destinations: 150\n\nDiversions by intended destination airport:\n      num_diversions common_diversion\nDest                                 \nSAN              140              PHX\nSNA               30              ONT\nEYW               20              MIA\nBOS               17              BDL\nLAX                7              ONT\nLGB                7              ONT\nMDW                4              IND\nSJC                3              MRY\nLAS                2              MSY\nHRL                2              BRO\n\nDiversion airports used during this period:\nDiv1Airport\nONT    48\nPHX    33\nLAX    32\nLAS    31\nPSP    16\nMIA    13\nSFO     9\nSJC     7\nBDL     7\nPHL     5\ndtype: int64\n\nOrigin airports affected:\nOrigin\nATL    15\nSFO    15\nDEN    15\nDFW    13\nPHX    12\nPHL    11\nLAS    11\nCLT    10\nSEA    10\nLAX     8\ndtype: int64\n\nGeographic spread:\n  Unique destination airports affected: 60\n  Unique origin airports: 73\n  Unique diversion airports used: 60\n\nEvent characterization:\n  WIDESPREAD EVENT - Only 48.3% of diversions were to SAN, many other airports affected\n\n================================================================================\nCLUSTER EVENT: DFW (2024-11-04 12:28:00 to 2024-11-05 00:50:00)\n================================================================================\n\nTotal diversions system-wide during this period: 186\nDiversions to DFW: 110\nDiversions to OTHER destinations: 76\n\nDiversions by intended destination airport:\n      num_diversions common_diversion\nDest                                 \nDFW              110              IAH\nDAL               32              AUS\nAUS               13              IAH\nSAT               12              IAH\nXNA                4              OKC\nSEA                2              BOI\nSTL                2              OMA\nLAS                2              ABQ\nGRK                1              ABI\nLAX                1              HNL\n\nDiversion airports used during this period:\nDiv1Airport\nIAH    28\nOKC    22\nSAT    16\nAUS    11\nHOU    11\nTUL    11\nELP     7\nLBB     7\nMSY     6\nMAF     6\ndtype: int64\n\nOrigin airports affected:\nOrigin\nATL    11\nCLT     8\nBOS     7\nLAS     7\nDEN     6\nEWR     6\nELP     4\nLGA     4\nPHL     4\nORD     4\ndtype: int64\n\nGeographic spread:\n  Unique destination airports affected: 17\n  Unique origin airports: 89\n  Unique diversion airports used: 40\n\nEvent characterization:\n  REGIONAL EVENT - 59.1% of diversions were to DFW, but other airports also affected\n\n================================================================================\nCLUSTER EVENT: ORD (2021-08-24 13:49:00 to 2021-08-26 04:25:00)\n================================================================================\n\nTotal diversions system-wide during this period: 187\nDiversions to ORD: 108\nDiversions to OTHER destinations: 79\n\nDiversions by intended destination airport:\n      num_diversions common_diversion\nDest                                 \nORD              108              IND\nMCO               19              TPA\nMDW               14              STL\nATL                9              BNA\nCMH                3              CAK\nCID                3              DSM\nIND                3              SDF\nJFK                2              DEN\nRSW                2              FLL\nTUS                2              ABQ\n\nDiversion airports used during this period:\nDiv1Airport\nIND    24\nSTL    21\nMKE    17\nTPA    10\nSDF     8\nCVG     7\nDSM     7\nFWA     6\nMCI     6\nMSP     6\ndtype: int64\n\nOrigin airports affected:\nOrigin\nORD    8\nLAX    8\nDFW    8\nMSP    6\nDEN    6\nATL    5\nSLC    5\nLAS    5\nIAD    4\nEWR    4\ndtype: int64\n\nGeographic spread:\n  Unique destination airports affected: 32\n  Unique origin airports: 87\n  Unique diversion airports used: 51\n\nEvent characterization:\n  REGIONAL EVENT - 57.8% of diversions were to ORD, but other airports also affected\n\n================================================================================\nCLUSTER EVENT: LGA (2022-03-17 07:19:00 to 2022-03-18 09:02:00)\n================================================================================\n\nTotal diversions system-wide during this period: 207\nDiversions to LGA: 101\nDiversions to OTHER destinations: 106\n\nDiversions by intended destination airport:\n      num_diversions common_diversion\nDest                                 \nLGA              101              JFK\nBOS               20              ALB\nPHL               19              PIT\nDFW               13              AUS\nDCA                8              IAD\nALB                7              SYR\nAUS                3              ACT\nDAL                3              AUS\nASE                3              GJT\nJFK                2              ALB\n\nDiversion airports used during this period:\nDiv1Airport\nPIT    15\nBWI    14\nALB    14\nJFK    13\nSYR    12\nPHL    12\nAUS    11\nIAD    10\nMDT     9\nEWR     8\ndtype: int64\n\nOrigin airports affected:\nOrigin\nORD    14\nATL    11\nDEN     9\nDFW     9\nIND     8\nFLL     7\nDTW     7\nDCA     7\nMCO     6\nCLE     6\ndtype: int64\n\nGeographic spread:\n  Unique destination airports affected: 32\n  Unique origin airports: 70\n  Unique diversion airports used: 52\n\nEvent characterization:\n  WIDESPREAD EVENT - Only 48.8% of diversions were to LGA, many other airports affected\n\n================================================================================\nCLUSTER EVENT: ATL (2023-08-06 11:45:00 to 2023-08-07 20:09:00)\n================================================================================\n\nTotal diversions system-wide during this period: 230\nDiversions to ATL: 99\nDiversions to OTHER destinations: 131\n\nDiversions by intended destination airport:\n      num_diversions common_diversion\nDest                                 \nATL               99              BNA\nCLT               36              TYS\nDCA               22              IAD\nDEN               14              COS\nPHL                8              JFK\nLGA                4              BOS\nIAD                4              ORF\nBHM                3              BNA\nBWI                3              EWR\nGSP                2              CAE\n\nDiversion airports used during this period:\nDiv1Airport\nBNA    17\nTYS    15\nCOS    11\nBHM    11\nRDU    10\nJFK     8\nIAD     7\nAGS     7\nJAX     7\nSAV     6\ndtype: int64\n\nOrigin airports affected:\nOrigin\nDEN    10\nLGA     9\nLAX     9\nMSP     7\nIAH     6\nSEA     6\nSNA     6\nMCO     6\nPHX     5\nDFW     5\ndtype: int64\n\nGeographic spread:\n  Unique destination airports affected: 37\n  Unique origin airports: 104\n  Unique diversion airports used: 68\n\nEvent characterization:\n  WIDESPREAD EVENT - Only 43.0% of diversions were to ATL, many other airports affected"
  },
  {
    "objectID": "5500_flightDiversion.html#airlinehub-airport-patterns",
    "href": "5500_flightDiversion.html#airlinehub-airport-patterns",
    "title": "Reading in the flight files",
    "section": "6 Airline/Hub Airport Patterns",
    "text": "6 Airline/Hub Airport Patterns\n\n# printing the unique airlines\nunique_airlines = diverted_flights['Marketing_Airline_Network'].unique()\nunique_airlines\n\narray(['UA', 'WN', 'AA', 'DL', 'AS', 'B6', 'F9', 'G4', 'HA', 'NK'],\n      dtype=object)\n\n\n\n# Analyzing carrier patterns in diversions - examining hub airport relationships and carrier-specific vulnerabilities\n# carriers may have different diversion patterns based on their hub airports and operational preferences\n\n# define major US carrier hubs based on airline operational designations. \n# I got these from a bunch of websites/google searches so I am not 100% sure on all of them\ncarrier_hubs = {\n    'AA': ['CLT', 'ORD', 'DFW', 'LAX', 'MIA', 'JFK', 'LGA', 'PHL', 'PHX', 'DCA'],  # American\n    'DL': ['ATL', 'BOS', 'DTW', 'LAX', 'MSP', 'JFK', 'LGA', 'SLC', 'SEA'],  # Delta\n    'UA': ['ORD', 'DEN', 'IAH', 'LAX', 'EWR', 'SFO', 'IAD'],  # United\n    'WN': ['ATL', 'BWI', 'MDW', 'DAL', 'DEN', 'LAS'],  # Southwest (point-to-point but major bases)\n    'AS': ['ANC', 'SEA', 'PDX', 'LAX', 'SFO', 'SAN', 'SJC'],  # Alaska\n    'B6': ['JFK', 'BOS', 'FLL', 'MCO', 'LAX'],  # JetBlue\n    'F9': ['DEN', 'ATL', 'ORD', 'LAS', 'MCO', 'PHL'],  # Frontier\n    'G4': ['LAS', 'SFB', 'PIE'],  # Allegiant\n    'HA': ['HNL', 'OGG'],  # Hawaiian\n    'NK': ['FLL', 'MCO', 'DTW', 'LAS', 'ORD', 'DFW'],  # Spirit\n}\n\n\n# hub indicator initiation - if origin, dest, or diversion airport is a hub for the operating carrier\ndiverted_flights['origin_is_carrier_hub'] = False #might not mean anything for origin airport being a hub\ndiverted_flights['dest_is_carrier_hub'] = False # this might also not mean anything for destination airport being a hub\ndiverted_flights['div_is_carrier_hub'] = False\n\n\nfor carrier, hubs in carrier_hubs.items():\n    carrier_mask = diverted_flights['Marketing_Airline_Network'] == carrier\n    diverted_flights.loc[carrier_mask, 'origin_is_carrier_hub'] = diverted_flights.loc[carrier_mask, 'Origin'].isin(hubs)\n    diverted_flights.loc[carrier_mask, 'dest_is_carrier_hub'] = diverted_flights.loc[carrier_mask, 'Dest'].isin(hubs)\n    diverted_flights.loc[carrier_mask, 'div_is_carrier_hub'] = diverted_flights.loc[carrier_mask, 'Div1Airport'].isin(hubs)\n\n\n# Overall carrier diversion rates\nprint(\"Diversions by carrier:\")\ncarrier_diversions = diverted_flights.groupby('Marketing_Airline_Network').size().sort_values(ascending=False)\nprint(carrier_diversions)\n\n# Hub involvement analysis\nprint(\"\\nDiversions by Hubs:\\n\")\nprint(\"Diversions originating from carrier's own hubs:\")\nhub_origin_pct = (diverted_flights['origin_is_carrier_hub'].sum() / len(diverted_flights) * 100)\nprint(f\"  {diverted_flights['origin_is_carrier_hub'].sum():,} diversions ({hub_origin_pct:.1f}%)\")\n\nprint(\"\\nDiversions destined for carrier's own hubs:\")\nhub_dest_pct = (diverted_flights['dest_is_carrier_hub'].sum() / len(diverted_flights) * 100)\nprint(f\"  {diverted_flights['dest_is_carrier_hub'].sum():,} diversions ({hub_dest_pct:.1f}%)\")\n\nprint(\"\\nDiversions landing at carrier's own hubs:\")\nhub_div_pct = (diverted_flights['div_is_carrier_hub'].sum() / len(diverted_flights) * 100)\nprint(f\"  {diverted_flights['div_is_carrier_hub'].sum():,} diversions ({hub_div_pct:.1f}%)\")\n\nDiversions by carrier:\nMarketing_Airline_Network\nAA    18004\nUA    13921\nDL    10886\nWN    10285\nAS     3922\nB6     3653\nNK     1659\nG4     1186\nF9     1012\nHA      287\ndtype: int64\n\nDiversions by Hubs:\n\nDiversions originating from carrier's own hubs:\n  32,862 diversions (50.7%)\n\nDiversions destined for carrier's own hubs:\n  30,573 diversions (47.2%)\n\nDiversions landing at carrier's own hubs:\n  16,446 diversions (25.4%)\n\n\n\n# hub analysis by carrier\nfor carrier in carrier_diversions.index:\n    carrier_data = diverted_flights[diverted_flights['Marketing_Airline_Network'] == carrier]\n    \n    if len(carrier_data) &lt; 10:  # Skip carriers with very few diversions\n        continue\n    \n    print(f\"\\n{carrier} ({len(carrier_data):,} diversions):\")\n    \n    # Hub percentages\n    origin_hub_pct = (carrier_data['origin_is_carrier_hub'].sum() / len(carrier_data) * 100)\n    dest_hub_pct = (carrier_data['dest_is_carrier_hub'].sum() / len(carrier_data) * 100)\n    div_hub_pct = (carrier_data['div_is_carrier_hub'].sum() / len(carrier_data) * 100)\n    \n    print(f\"  Origin at own hub: {origin_hub_pct:.1f}%\")\n    print(f\"  Destination at own hub: {dest_hub_pct:.1f}%\")\n    print(f\"  Diverted to own hub: {div_hub_pct:.1f}%\")\n    \n    # Top diversion airports for this carrier\n    top_div_airports = carrier_data['Div1Airport'].value_counts().head(5)\n    print(f\"  Top diversion airports:\")\n    for airport, count in top_div_airports.items():\n        is_hub = airport in carrier_hubs.get(carrier, [])\n        hub_marker = \" (HUB)\" if is_hub else \"\"\n        print(f\"    {airport}: {count}{hub_marker}\")\n\n\nAA (18,004 diversions):\n  Origin at own hub: 54.6%\n  Destination at own hub: 56.4%\n  Diverted to own hub: 23.3%\n  Top diversion airports:\n    DFW: 984 (HUB)\n    CLT: 892 (HUB)\n    PHL: 610 (HUB)\n    IAD: 569\n    OKC: 509\n\nUA (13,921 diversions):\n  Origin at own hub: 54.3%\n  Destination at own hub: 51.7%\n  Diverted to own hub: 28.7%\n  Top diversion airports:\n    DEN: 1149 (HUB)\n    COS: 737\n    IAD: 719 (HUB)\n    ORD: 663 (HUB)\n    GJT: 578\n\nDL (10,886 diversions):\n  Origin at own hub: 60.4%\n  Destination at own hub: 45.8%\n  Diverted to own hub: 25.4%\n  Top diversion airports:\n    ATL: 636 (HUB)\n    DTW: 583 (HUB)\n    MSP: 434 (HUB)\n    SLC: 385 (HUB)\n    JFK: 301 (HUB)\n\nWN (10,285 diversions):\n  Origin at own hub: 33.3%\n  Destination at own hub: 35.4%\n  Diverted to own hub: 14.5%\n  Top diversion airports:\n    LAX: 465\n    ONT: 351\n    LAS: 336 (HUB)\n    STL: 331\n    AUS: 330\n\nAS (3,922 diversions):\n  Origin at own hub: 58.8%\n  Destination at own hub: 38.0%\n  Diverted to own hub: 44.7%\n  Top diversion airports:\n    SEA: 431 (HUB)\n    SJC: 377 (HUB)\n    ANC: 356 (HUB)\n    PDX: 281 (HUB)\n    LAX: 165 (HUB)\n\nB6 (3,653 diversions):\n  Origin at own hub: 46.1%\n  Destination at own hub: 43.9%\n  Diverted to own hub: 30.8%\n  Top diversion airports:\n    JFK: 509 (HUB)\n    MCO: 226 (HUB)\n    TPA: 178\n    FLL: 165 (HUB)\n    BOS: 156 (HUB)\n\nNK (1,659 diversions):\n  Origin at own hub: 35.7%\n  Destination at own hub: 49.0%\n  Diverted to own hub: 20.9%\n  Top diversion airports:\n    TPA: 161\n    MCO: 119 (HUB)\n    SJU: 110\n    RSW: 107\n    FLL: 104 (HUB)\n\nG4 (1,186 diversions):\n  Origin at own hub: 23.5%\n  Destination at own hub: 17.5%\n  Diverted to own hub: 25.5%\n  Top diversion airports:\n    SFB: 121 (HUB)\n    PIE: 102 (HUB)\n    LAS: 79 (HUB)\n    PGD: 65\n    FLL: 46\n\nF9 (1,012 diversions):\n  Origin at own hub: 43.1%\n  Destination at own hub: 37.5%\n  Diverted to own hub: 30.5%\n  Top diversion airports:\n    MCO: 77 (HUB)\n    PHL: 74 (HUB)\n    DEN: 74 (HUB)\n    TPA: 71\n    SJU: 59\n\nHA (287 diversions):\n  Origin at own hub: 58.2%\n  Destination at own hub: 39.0%\n  Diverted to own hub: 56.1%\n  Top diversion airports:\n    HNL: 142 (HUB)\n    LAX: 43\n    SFO: 20\n    OGG: 19 (HUB)\n    KOA: 13\n\n\n\n# Hub diversion usage by carrier\nprint(\"=== HUB AS DIVERSION AIRPORT USAGE ===\\n\")\n\nfor carrier, hubs in carrier_hubs.items():\n    carrier_data = diverted_flights[diverted_flights['Marketing_Airline_Network'] == carrier]\n    hub_div_landings = carrier_data[carrier_data['Div1Airport'].isin(hubs)]\n    \n    if len(hub_div_landings) &gt; 0:\n        print(f\"\\n{carrier}:\")\n        hub_breakdown = hub_div_landings.groupby('Div1Airport').size().sort_values(ascending=False)\n        for hub, count in hub_breakdown.items():\n            pct = (count / len(carrier_data) * 100)\n            print(f\"  {hub}: {count} diversions ({pct:.1f}% of carrier's total diversions)\")\n\n=== HUB AS DIVERSION AIRPORT USAGE ===\n\n\nAA:\n  DFW: 984 diversions (5.5% of carrier's total diversions)\n  CLT: 892 diversions (5.0% of carrier's total diversions)\n  PHL: 610 diversions (3.4% of carrier's total diversions)\n  PHX: 495 diversions (2.7% of carrier's total diversions)\n  ORD: 356 diversions (2.0% of carrier's total diversions)\n  MIA: 316 diversions (1.8% of carrier's total diversions)\n  LAX: 231 diversions (1.3% of carrier's total diversions)\n  JFK: 191 diversions (1.1% of carrier's total diversions)\n  DCA: 89 diversions (0.5% of carrier's total diversions)\n  LGA: 26 diversions (0.1% of carrier's total diversions)\n\nDL:\n  ATL: 636 diversions (5.8% of carrier's total diversions)\n  DTW: 583 diversions (5.4% of carrier's total diversions)\n  MSP: 434 diversions (4.0% of carrier's total diversions)\n  SLC: 385 diversions (3.5% of carrier's total diversions)\n  JFK: 301 diversions (2.8% of carrier's total diversions)\n  LAX: 180 diversions (1.7% of carrier's total diversions)\n  SEA: 103 diversions (0.9% of carrier's total diversions)\n  BOS: 93 diversions (0.9% of carrier's total diversions)\n  LGA: 50 diversions (0.5% of carrier's total diversions)\n\nUA:\n  DEN: 1149 diversions (8.3% of carrier's total diversions)\n  IAD: 719 diversions (5.2% of carrier's total diversions)\n  ORD: 663 diversions (4.8% of carrier's total diversions)\n  IAH: 493 diversions (3.5% of carrier's total diversions)\n  LAX: 402 diversions (2.9% of carrier's total diversions)\n  SFO: 360 diversions (2.6% of carrier's total diversions)\n  EWR: 214 diversions (1.5% of carrier's total diversions)\n\nWN:\n  LAS: 336 diversions (3.3% of carrier's total diversions)\n  DAL: 297 diversions (2.9% of carrier's total diversions)\n  BWI: 283 diversions (2.8% of carrier's total diversions)\n  ATL: 249 diversions (2.4% of carrier's total diversions)\n  DEN: 208 diversions (2.0% of carrier's total diversions)\n  MDW: 120 diversions (1.2% of carrier's total diversions)\n\nAS:\n  SEA: 431 diversions (11.0% of carrier's total diversions)\n  SJC: 377 diversions (9.6% of carrier's total diversions)\n  ANC: 356 diversions (9.1% of carrier's total diversions)\n  PDX: 281 diversions (7.2% of carrier's total diversions)\n  LAX: 165 diversions (4.2% of carrier's total diversions)\n  SFO: 122 diversions (3.1% of carrier's total diversions)\n  SAN: 22 diversions (0.6% of carrier's total diversions)\n\nB6:\n  JFK: 509 diversions (13.9% of carrier's total diversions)\n  MCO: 226 diversions (6.2% of carrier's total diversions)\n  FLL: 165 diversions (4.5% of carrier's total diversions)\n  BOS: 156 diversions (4.3% of carrier's total diversions)\n  LAX: 70 diversions (1.9% of carrier's total diversions)\n\nF9:\n  MCO: 77 diversions (7.6% of carrier's total diversions)\n  DEN: 74 diversions (7.3% of carrier's total diversions)\n  PHL: 74 diversions (7.3% of carrier's total diversions)\n  LAS: 43 diversions (4.2% of carrier's total diversions)\n  ATL: 26 diversions (2.6% of carrier's total diversions)\n  ORD: 15 diversions (1.5% of carrier's total diversions)\n\nG4:\n  SFB: 121 diversions (10.2% of carrier's total diversions)\n  PIE: 102 diversions (8.6% of carrier's total diversions)\n  LAS: 79 diversions (6.7% of carrier's total diversions)\n\nHA:\n  HNL: 142 diversions (49.5% of carrier's total diversions)\n  OGG: 19 diversions (6.6% of carrier's total diversions)\n\nNK:\n  MCO: 119 diversions (7.2% of carrier's total diversions)\n  FLL: 104 diversions (6.3% of carrier's total diversions)\n  LAS: 39 diversions (2.4% of carrier's total diversions)\n  DTW: 39 diversions (2.4% of carrier's total diversions)\n  DFW: 27 diversions (1.6% of carrier's total diversions)\n  ORD: 18 diversions (1.1% of carrier's total diversions)"
  },
  {
    "objectID": "5500_flightDiversion.html#diversion-visualization",
    "href": "5500_flightDiversion.html#diversion-visualization",
    "title": "Reading in the flight files",
    "section": "7 Diversion Visualization",
    "text": "7 Diversion Visualization\n\n7.1 Coordinate diversion function\n\n#function to get lat/lon for an airport code - I will use this for visualizations  \ndef get_coords(airport_code, airports_df):\n    \"\"\"Get latitude and longitude for an airport code\"\"\"\n    result = airports_df[airports_df['AIRPORT'] == airport_code]\n    if len(result) &gt; 0:\n        return result.iloc[0]['LATITUDE'], result.iloc[0]['LONGITUDE']\n    return None, None\n\n\n\n# testing function\nlat, lon = get_coords('SAN', airports_clean)\nprint(f\"SAN: {lat}, {lon}\")\n\nSAN: 32.73277778, -117.18722222\n\n\n\n\n7.2 Cluster visualization\n\n7.2.1 For diversions heading to the top cluster based on destination\n\n# ============================================================\n# SYSTEM-WIDE DIVERSIONS DURING TOP 3 CLUSTER PERIODS\n# ============================================================\n\nimport plotly.graph_objects as go\nimport numpy as np\n\ndef create_bezier_curve(lat1, lon1, lat2, lon2, num_points=100):\n    mid_lat = (lat1 + lat2) / 2\n    mid_lon = (lon1 + lon2) / 2\n    dx = lon2 - lon1\n    dy = lat2 - lat1\n    distance = np.sqrt(dx**2 + dy**2)\n    \n    if distance &gt; 0:\n        offset = distance * 0.2\n        control_lat = mid_lat + offset * (dx / distance) * 0.15\n        control_lon = mid_lon - offset * (dy / distance) * 0.15\n    else:\n        control_lat = mid_lat\n        control_lon = mid_lon\n    \n    t = np.linspace(0, 1, num_points)\n    lats = [(1-ti)**2 * lat1 + 2*(1-ti)*ti * control_lat + ti**2 * lat2 for ti in t]\n    lons = [(1-ti)**2 * lon1 + 2*(1-ti)*ti * control_lon + ti**2 * lon2 for ti in t]\n    return lats, lons\n\n# Color setup - manually define distinct colors\nairline_colors = {\n    'American Airlines': '#E74C3C',      # Red\n    'AA': '#E74C3C',\n    'Delta Air Lines': '#3498DB',         # Blue\n    'DL': '#3498DB',\n    'United Airlines': '#2ECC71',         # Green\n    'UA': '#2ECC71',\n    'Southwest Airlines': '#F39C12',      # Orange\n    'WN': '#F39C12',\n    'Alaska Airlines': '#9B59B6',         # Purple\n    'AS': '#9B59B6',\n    'JetBlue Airways': '#1ABC9C',         # Teal\n    'B6': '#1ABC9C',\n    'Spirit Airlines': '#E67E22',         # Dark Orange\n    'NK': '#E67E22',\n    'Frontier Airlines': '#34495E',       # Dark Gray\n    'F9': '#34495E',\n    'Hawaiian Airlines': '#16A085',       # Dark Teal\n    'HA': '#16A085',\n    'Allegiant Air': '#C0392B',           # Dark Red\n    'G4': '#C0392B',\n}\n\n# For any airline not in the dictionary, assign a default color\ndef get_airline_color(airline):\n    if airline in airline_colors:\n        return airline_colors[airline]\n    else:\n        return '#808080'  # Gray for unknown airlines\n\n# Process top 3 clusters\nfor cluster_num in range(3):\n    cluster = biggest_dest_actual_clusters.iloc[cluster_num]\n    \n    dest_airport = cluster['Dest']\n    cluster_start = cluster['cluster_start_dest_actual']\n    cluster_end = cluster['cluster_end_dest_actual']\n    \n    print(f\"\\n{'='*80}\")\n    print(f\"CLUSTER {cluster_num + 1} EVENT: {dest_airport} ({cluster_start} to {cluster_end})\")\n    print(f\"{'='*80}\\n\")\n    \n    # ALL flights with estimated actual arrivals during this time window\n    all_diversions_during_cluster = diverted_flights[\n        (diverted_flights['EstimatedActualArrival'] &gt;= cluster_start) &\n        (diverted_flights['EstimatedActualArrival'] &lt;= cluster_end)\n    ].copy()\n    \n    print(f\"Total diversions system-wide during this period: {len(all_diversions_during_cluster)}\")\n    print(f\"Diversions to {dest_airport}: {len(all_diversions_during_cluster[all_diversions_during_cluster['Dest'] == dest_airport])}\")\n    print(f\"Diversions to OTHER destinations: {len(all_diversions_during_cluster[all_diversions_during_cluster['Dest'] != dest_airport])}\\n\")\n    \n    # Break down by destination airport\n    print(\"Diversions by intended destination airport:\")\n    dest_breakdown = all_diversions_during_cluster.groupby('Dest').agg({\n        'Origin': 'count',\n        'Div1Airport': lambda x: x.mode()[0] if len(x.mode()) &gt; 0 else 'Various'\n    }).rename(columns={'Origin': 'num_diversions', 'Div1Airport': 'common_diversion'})\n    dest_breakdown = dest_breakdown.sort_values('num_diversions', ascending=False)\n    print(dest_breakdown.head(10))\n    \n    # Break down by diversion airport\n    print(f\"\\nDiversion airports used during this period:\")\n    div_airport_breakdown = all_diversions_during_cluster.groupby('Div1Airport').size().sort_values(ascending=False)\n    print(div_airport_breakdown.head(10))\n    \n    # Break down by origin airport\n    print(f\"\\nOrigin airports affected:\")\n    origin_breakdown = all_diversions_during_cluster.groupby('Origin').size().sort_values(ascending=False)\n    print(origin_breakdown.head(10))\n    \n    # Geographic spread analysis\n    unique_dests = all_diversions_during_cluster['Dest'].nunique()\n    unique_origins = all_diversions_during_cluster['Origin'].nunique()\n    unique_div_airports = all_diversions_during_cluster['Div1Airport'].nunique()\n    \n    print(f\"\\nGeographic spread:\")\n    print(f\"  Unique destination airports affected: {unique_dests}\")\n    print(f\"  Unique origin airports: {unique_origins}\")\n    print(f\"  Unique diversion airports used: {unique_div_airports}\")\n    \n    # Calculate event characterization\n    pct_to_main_dest = (len(all_diversions_during_cluster[all_diversions_during_cluster['Dest'] == dest_airport]) / \n                        len(all_diversions_during_cluster) * 100)\n    \n    print(f\"\\nEvent characterization:\")\n    if pct_to_main_dest &gt; 80:\n        print(f\"  LOCALIZED EVENT - {pct_to_main_dest:.1f}% of diversions were to {dest_airport}\")\n    elif pct_to_main_dest &gt; 50:\n        print(f\"  REGIONAL EVENT - {pct_to_main_dest:.1f}% of diversions were to {dest_airport}, but other airports also affected\")\n    else:\n        print(f\"  WIDESPREAD EVENT - Only {pct_to_main_dest:.1f}% of diversions were to {dest_airport}, many other airports affected\")\n    \n    # Add coordinates\n    all_diversions_during_cluster['origin_lat'] = all_diversions_during_cluster['Origin'].apply(\n        lambda x: get_coords(x, airports_clean)[0]\n    )\n    all_diversions_during_cluster['origin_lon'] = all_diversions_during_cluster['Origin'].apply(\n        lambda x: get_coords(x, airports_clean)[1]\n    )\n    all_diversions_during_cluster['div_lat'] = all_diversions_during_cluster['Div1Airport'].apply(\n        lambda x: get_coords(x, airports_clean)[0]\n    )\n    all_diversions_during_cluster['div_lon'] = all_diversions_during_cluster['Div1Airport'].apply(\n        lambda x: get_coords(x, airports_clean)[1]\n    )\n    all_diversions_during_cluster['dest_lat'] = all_diversions_during_cluster['Dest'].apply(\n        lambda x: get_coords(x, airports_clean)[0]\n    )\n    all_diversions_during_cluster['dest_lon'] = all_diversions_during_cluster['Dest'].apply(\n        lambda x: get_coords(x, airports_clean)[1]\n    )\n    \n    # Remove missing coordinates\n    all_diversions_during_cluster = all_diversions_during_cluster.dropna(subset=['origin_lat', 'div_lat', 'dest_lat'])\n    \n    print(f\"\\nFlights with complete coordinates: {len(all_diversions_during_cluster)}\")\n    \n    # Create figure\n    fig = go.Figure()\n    \n    # Add ALL flight paths\n    for idx, row in all_diversions_during_cluster.iterrows():\n        airline = row['Marketing_Airline_Network']\n        origin = row['Origin']\n        diversion = row['Div1Airport']\n        dest = row['Dest']\n        \n        lats, lons = create_bezier_curve(\n            row['origin_lat'], row['origin_lon'],\n            row['div_lat'], row['div_lon']\n        )\n        \n        fig.add_trace(go.Scattergeo(\n            lon=lons,\n            lat=lats,\n            mode='lines',\n            line=dict(width=2, color=get_airline_color(airline)),\n            opacity=0.4,\n            hoverinfo='text',\n            hovertext=f\"{origin} → {diversion}&lt;br&gt;Intended: {dest}&lt;br&gt;{airline}\",\n            showlegend=False,\n            name=airline,\n            legendgroup=airline\n        ))\n    \n    # Add origin markers\n    all_origins = all_diversions_during_cluster.drop_duplicates('Origin')[['Origin', 'origin_lat', 'origin_lon']].reset_index(drop=True)\n    fig.add_trace(go.Scattergeo(\n        lon=all_origins['origin_lon'],\n        lat=all_origins['origin_lat'],\n        mode='markers',\n        marker=dict(size=5, color='blue', opacity=0.8, line=dict(width=1, color='darkblue')),\n        text=all_origins['Origin'],\n        hovertemplate='&lt;b&gt;Origin: %{text}&lt;/b&gt;&lt;extra&gt;&lt;/extra&gt;',\n        name='Flight Origins',\n        showlegend=True\n    ))\n    \n    # Add diversion markers\n    all_diversions = all_diversions_during_cluster.drop_duplicates('Div1Airport')[['Div1Airport', 'div_lat', 'div_lon']].reset_index(drop=True)\n    fig.add_trace(go.Scattergeo(\n        lon=all_diversions['div_lon'],\n        lat=all_diversions['div_lat'],\n        mode='markers',\n        marker=dict(size=8, color='red', symbol='star', opacity=0.8, line=dict(width=1, color='darkred')),\n        text=all_diversions['Div1Airport'],\n        hovertemplate='&lt;b&gt;Diversion: %{text}&lt;/b&gt;&lt;extra&gt;&lt;/extra&gt;',\n        name='Diversion Airports',\n        showlegend=True\n    ))\n    \n    # Add intended destinations - main cluster in gold, others in light green\n    all_dests = all_diversions_during_cluster.drop_duplicates('Dest')[['Dest', 'dest_lat', 'dest_lon']].reset_index(drop=True)\n    \n    main_dest_data = all_dests[all_dests['Dest'] == dest_airport]\n    other_dest_data = all_dests[all_dests['Dest'] != dest_airport]\n    \n    if len(main_dest_data) &gt; 0:\n        fig.add_trace(go.Scattergeo(\n            lon=main_dest_data['dest_lon'],\n            lat=main_dest_data['dest_lat'],\n            mode='markers+text',\n            marker=dict(size=12, color='gold', symbol='diamond', opacity=0.95, line=dict(width=1.5, color='orange')),\n            text=main_dest_data['Dest'],\n            textposition='top center',\n            hovertemplate='&lt;b&gt;%{text}&lt;/b&gt;&lt;br&gt;Main Cluster Destination&lt;extra&gt;&lt;/extra&gt;',\n            name='Main Cluster Destination',\n            showlegend=True\n        ))\n    \n    if len(other_dest_data) &gt; 0:\n        fig.add_trace(go.Scattergeo(\n            lon=other_dest_data['dest_lon'],\n            lat=other_dest_data['dest_lat'],\n            mode='markers+text',\n            marker=dict(size=10, color='lightgreen', symbol='circle', opacity=0.8, line=dict(width=1, color='darkgreen')),\n            text=other_dest_data['Dest'],\n            textposition='top center',\n            hovertemplate='&lt;b&gt;%{text}&lt;/b&gt;&lt;br&gt;Other Destination&lt;extra&gt;&lt;/extra&gt;',\n            name='Other Intended Destinations',\n            showlegend=True\n        ))\n    \n    # Add airline legend\n    airlines_in_cluster = sorted(all_diversions_during_cluster['Marketing_Airline_Network'].dropna().unique())\n    for airline in airlines_in_cluster:\n        fig.add_trace(go.Scattergeo(\n            lon=[None],\n            lat=[None],\n            mode='lines',\n            line=dict(width=3, color=get_airline_color(airline)),\n            name=airline,\n            hoverinfo='skip',\n            legendgroup=airline,\n            showlegend=True\n        ))\n    \n    fig.update_layout(\n        title={\n            'text': f'&lt;b&gt;System-Wide Diversions During {dest_airport} Cluster Period&lt;/b&gt;&lt;br&gt;&lt;sub&gt;{len(all_diversions_during_cluster)} total diversions | {unique_dests} destinations affected | {cluster_start.strftime(\"%b %d\")} - {cluster_end.strftime(\"%b %d, %Y\")}&lt;/sub&gt;',\n            'x': 0.5,\n            'xanchor': 'center',\n            'font': {'size': 16}\n        },\n        geo=dict(\n            projection_type='mercator',\n            showland=True,\n            landcolor='rgb(243, 243, 243)',\n            showocean=True,\n            oceancolor='rgb(204, 229, 255)',\n            showlakes=True,\n            lakecolor='rgb(204, 229, 255)',\n            center=dict(lat=40, lon=-95),\n            lataxis_range=[25, 50],\n            lonaxis_range=[-125, -70]\n        ),\n        height=800,\n        margin=dict(b=50, t=100, l=50, r=50),\n        hovermode='closest',\n        showlegend=True,\n        legend=dict(\n            x=0.98, y=0.98,\n            bgcolor='rgba(255, 255, 255, 0.9)',\n            bordercolor='black',\n            borderwidth=1,\n            font=dict(size=9),\n            yanchor='top'\n        )\n    )\n    \n    filename = f'system_wide_cluster_{cluster_num + 1}_{dest_airport}.html'\n    fig.write_html(filename)\n    fig.show()\n    \n    print(f\"\\n✓ Saved: {filename}\")\n    print(f\"  Total flight paths: {len(all_diversions_during_cluster)}\")\n    print(f\"  Unique origins: {len(all_origins)}\")\n    print(f\"  Unique diversions: {len(all_diversions)}\")\n    print(f\"  Unique intended destinations: {len(all_dests)}\")\n    print(f\"  Airlines: {len(airlines_in_cluster)}\")\n\nprint(f\"\\n{'='*80}\")\nprint(\"All 3 system-wide cluster visualizations created!\")\nprint(f\"{'='*80}\")\n\n\n================================================================================\nCLUSTER 1 EVENT: SAN (2024-12-18 16:39:00 to 2024-12-21 16:55:00)\n================================================================================\n\nTotal diversions system-wide during this period: 290\nDiversions to SAN: 140\nDiversions to OTHER destinations: 150\n\nDiversions by intended destination airport:\n      num_diversions common_diversion\nDest                                 \nSAN              140              PHX\nSNA               30              ONT\nEYW               20              MIA\nBOS               17              BDL\nLAX                7              ONT\nLGB                7              ONT\nMDW                4              IND\nSJC                3              MRY\nLAS                2              MSY\nHRL                2              BRO\n\nDiversion airports used during this period:\nDiv1Airport\nONT    48\nPHX    33\nLAX    32\nLAS    31\nPSP    16\nMIA    13\nSFO     9\nSJC     7\nBDL     7\nPHL     5\ndtype: int64\n\nOrigin airports affected:\nOrigin\nATL    15\nSFO    15\nDEN    15\nDFW    13\nPHX    12\nPHL    11\nLAS    11\nCLT    10\nSEA    10\nLAX     8\ndtype: int64\n\nGeographic spread:\n  Unique destination airports affected: 60\n  Unique origin airports: 73\n  Unique diversion airports used: 60\n\nEvent characterization:\n  WIDESPREAD EVENT - Only 48.3% of diversions were to SAN, many other airports affected\n\nFlights with complete coordinates: 290\n\n\nUnable to display output for mime type(s): application/vnd.plotly.v1+json\n\n\n\n✓ Saved: system_wide_cluster_1_SAN.html\n  Total flight paths: 290\n  Unique origins: 73\n  Unique diversions: 60\n  Unique intended destinations: 60\n  Airlines: 10\n\n================================================================================\nCLUSTER 2 EVENT: DFW (2024-11-04 12:28:00 to 2024-11-05 00:50:00)\n================================================================================\n\nTotal diversions system-wide during this period: 186\nDiversions to DFW: 110\nDiversions to OTHER destinations: 76\n\nDiversions by intended destination airport:\n      num_diversions common_diversion\nDest                                 \nDFW              110              IAH\nDAL               32              AUS\nAUS               13              IAH\nSAT               12              IAH\nXNA                4              OKC\nSEA                2              BOI\nSTL                2              OMA\nLAS                2              ABQ\nGRK                1              ABI\nLAX                1              HNL\n\nDiversion airports used during this period:\nDiv1Airport\nIAH    28\nOKC    22\nSAT    16\nAUS    11\nHOU    11\nTUL    11\nELP     7\nLBB     7\nMSY     6\nMAF     6\ndtype: int64\n\nOrigin airports affected:\nOrigin\nATL    11\nCLT     8\nBOS     7\nLAS     7\nDEN     6\nEWR     6\nELP     4\nLGA     4\nPHL     4\nORD     4\ndtype: int64\n\nGeographic spread:\n  Unique destination airports affected: 17\n  Unique origin airports: 89\n  Unique diversion airports used: 40\n\nEvent characterization:\n  REGIONAL EVENT - 59.1% of diversions were to DFW, but other airports also affected\n\nFlights with complete coordinates: 186\n\n\nUnable to display output for mime type(s): application/vnd.plotly.v1+json\n\n\n\n✓ Saved: system_wide_cluster_2_DFW.html\n  Total flight paths: 186\n  Unique origins: 89\n  Unique diversions: 40\n  Unique intended destinations: 17\n  Airlines: 9\n\n================================================================================\nCLUSTER 3 EVENT: ORD (2021-08-24 13:49:00 to 2021-08-26 04:25:00)\n================================================================================\n\nTotal diversions system-wide during this period: 187\nDiversions to ORD: 108\nDiversions to OTHER destinations: 79\n\nDiversions by intended destination airport:\n      num_diversions common_diversion\nDest                                 \nORD              108              IND\nMCO               19              TPA\nMDW               14              STL\nATL                9              BNA\nCMH                3              CAK\nCID                3              DSM\nIND                3              SDF\nJFK                2              DEN\nRSW                2              FLL\nTUS                2              ABQ\n\nDiversion airports used during this period:\nDiv1Airport\nIND    24\nSTL    21\nMKE    17\nTPA    10\nSDF     8\nCVG     7\nDSM     7\nFWA     6\nMCI     6\nMSP     6\ndtype: int64\n\nOrigin airports affected:\nOrigin\nORD    8\nLAX    8\nDFW    8\nMSP    6\nDEN    6\nATL    5\nSLC    5\nLAS    5\nIAD    4\nEWR    4\ndtype: int64\n\nGeographic spread:\n  Unique destination airports affected: 32\n  Unique origin airports: 87\n  Unique diversion airports used: 51\n\nEvent characterization:\n  REGIONAL EVENT - 57.8% of diversions were to ORD, but other airports also affected\n\nFlights with complete coordinates: 187\n\n\nUnable to display output for mime type(s): application/vnd.plotly.v1+json\n\n\n\n✓ Saved: system_wide_cluster_3_ORD.html\n  Total flight paths: 187\n  Unique origins: 87\n  Unique diversions: 51\n  Unique intended destinations: 32\n  Airlines: 8\n\n================================================================================\nAll 3 system-wide cluster visualizations created!\n================================================================================\n\n\n\n\n7.2.2 For system-wide diversions during top cluster periods\n\n# ============================================================\n# SYSTEM-WIDE DIVERSIONS DURING TOP 3 CLUSTER PERIODS\n# ============================================================\n\nimport plotly.graph_objects as go\nimport numpy as np\n\ndef create_bezier_curve(lat1, lon1, lat2, lon2, num_points=100):\n    mid_lat = (lat1 + lat2) / 2\n    mid_lon = (lon1 + lon2) / 2\n    dx = lon2 - lon1\n    dy = lat2 - lat1\n    distance = np.sqrt(dx**2 + dy**2)\n    \n    if distance &gt; 0:\n        offset = distance * 0.2\n        control_lat = mid_lat + offset * (dx / distance) * 0.15\n        control_lon = mid_lon - offset * (dy / distance) * 0.15\n    else:\n        control_lat = mid_lat\n        control_lon = mid_lon\n    \n    t = np.linspace(0, 1, num_points)\n    lats = [(1-ti)**2 * lat1 + 2*(1-ti)*ti * control_lat + ti**2 * lat2 for ti in t]\n    lons = [(1-ti)**2 * lon1 + 2*(1-ti)*ti * control_lon + ti**2 * lon2 for ti in t]\n    return lats, lons\n\n# Color setup - manually define distinct colors\nairline_colors = {\n    'American Airlines': '#E74C3C',      # Red\n    'AA': '#E74C3C',\n    'Delta Air Lines': '#3498DB',         # Blue\n    'DL': '#3498DB',\n    'United Airlines': '#2ECC71',         # Green\n    'UA': '#2ECC71',\n    'Southwest Airlines': '#F39C12',      # Orange\n    'WN': '#F39C12',\n    'Alaska Airlines': '#9B59B6',         # Purple\n    'AS': '#9B59B6',\n    'JetBlue Airways': '#1ABC9C',         # Teal\n    'B6': '#1ABC9C',\n    'Spirit Airlines': '#E67E22',         # Dark Orange\n    'NK': '#E67E22',\n    'Frontier Airlines': '#34495E',       # Dark Gray\n    'F9': '#34495E',\n    'Hawaiian Airlines': '#16A085',       # Dark Teal\n    'HA': '#16A085',\n    'Allegiant Air': '#C0392B',           # Dark Red\n    'G4': '#C0392B',\n}\n\n# For any airline not in the dictionary, assign a default color\ndef get_airline_color(airline):\n    if airline in airline_colors:\n        return airline_colors[airline]\n    else:\n        return '#808080'  # Gray for unknown airlines\n\n# Process top 3 clusters\nfor cluster_num in range(3):\n    cluster = biggest_dest_actual_clusters.iloc[cluster_num]\n    \n    dest_airport = cluster['Dest']\n    cluster_start = cluster['cluster_start_dest_actual']\n    cluster_end = cluster['cluster_end_dest_actual']\n    \n    print(f\"\\n{'='*80}\")\n    print(f\"CLUSTER {cluster_num + 1} EVENT: {dest_airport} ({cluster_start} to {cluster_end})\")\n    print(f\"{'='*80}\\n\")\n    \n    # ALL flights with estimated actual arrivals during this time window\n    all_diversions_during_cluster = diverted_flights[\n        (diverted_flights['EstimatedActualArrival'] &gt;= cluster_start) &\n        (diverted_flights['EstimatedActualArrival'] &lt;= cluster_end)\n    ].copy()\n    \n    print(f\"Total diversions system-wide during this period: {len(all_diversions_during_cluster)}\")\n    print(f\"Diversions to {dest_airport}: {len(all_diversions_during_cluster[all_diversions_during_cluster['Dest'] == dest_airport])}\")\n    print(f\"Diversions to OTHER destinations: {len(all_diversions_during_cluster[all_diversions_during_cluster['Dest'] != dest_airport])}\\n\")\n    \n    # Break down by destination airport\n    print(\"Diversions by intended destination airport:\")\n    dest_breakdown = all_diversions_during_cluster.groupby('Dest').agg({\n        'Origin': 'count',\n        'Div1Airport': lambda x: x.mode()[0] if len(x.mode()) &gt; 0 else 'Various'\n    }).rename(columns={'Origin': 'num_diversions', 'Div1Airport': 'common_diversion'})\n    dest_breakdown = dest_breakdown.sort_values('num_diversions', ascending=False)\n    print(dest_breakdown.head(10))\n    \n    # Break down by diversion airport\n    print(f\"\\nDiversion airports used during this period:\")\n    div_airport_breakdown = all_diversions_during_cluster.groupby('Div1Airport').size().sort_values(ascending=False)\n    print(div_airport_breakdown.head(10))\n    \n    # Break down by origin airport\n    print(f\"\\nOrigin airports affected:\")\n    origin_breakdown = all_diversions_during_cluster.groupby('Origin').size().sort_values(ascending=False)\n    print(origin_breakdown.head(10))\n    \n    # Geographic spread analysis\n    unique_dests = all_diversions_during_cluster['Dest'].nunique()\n    unique_origins = all_diversions_during_cluster['Origin'].nunique()\n    unique_div_airports = all_diversions_during_cluster['Div1Airport'].nunique()\n    \n    print(f\"\\nGeographic spread:\")\n    print(f\"  Unique destination airports affected: {unique_dests}\")\n    print(f\"  Unique origin airports: {unique_origins}\")\n    print(f\"  Unique diversion airports used: {unique_div_airports}\")\n    \n    # Calculate event characterization\n    pct_to_main_dest = (len(all_diversions_during_cluster[all_diversions_during_cluster['Dest'] == dest_airport]) / \n                        len(all_diversions_during_cluster) * 100)\n    \n    print(f\"\\nEvent characterization:\")\n    if pct_to_main_dest &gt; 80:\n        print(f\"  LOCALIZED EVENT - {pct_to_main_dest:.1f}% of diversions were to {dest_airport}\")\n    elif pct_to_main_dest &gt; 50:\n        print(f\"  REGIONAL EVENT - {pct_to_main_dest:.1f}% of diversions were to {dest_airport}, but other airports also affected\")\n    else:\n        print(f\"  WIDESPREAD EVENT - Only {pct_to_main_dest:.1f}% of diversions were to {dest_airport}, many other airports affected\")\n    \n    # Add coordinates\n    all_diversions_during_cluster['origin_lat'] = all_diversions_during_cluster['Origin'].apply(\n        lambda x: get_coords(x, airports_clean)[0]\n    )\n    all_diversions_during_cluster['origin_lon'] = all_diversions_during_cluster['Origin'].apply(\n        lambda x: get_coords(x, airports_clean)[1]\n    )\n    all_diversions_during_cluster['div_lat'] = all_diversions_during_cluster['Div1Airport'].apply(\n        lambda x: get_coords(x, airports_clean)[0]\n    )\n    all_diversions_during_cluster['div_lon'] = all_diversions_during_cluster['Div1Airport'].apply(\n        lambda x: get_coords(x, airports_clean)[1]\n    )\n    all_diversions_during_cluster['dest_lat'] = all_diversions_during_cluster['Dest'].apply(\n        lambda x: get_coords(x, airports_clean)[0]\n    )\n    all_diversions_during_cluster['dest_lon'] = all_diversions_during_cluster['Dest'].apply(\n        lambda x: get_coords(x, airports_clean)[1]\n    )\n    \n    # Remove missing coordinates\n    all_diversions_during_cluster = all_diversions_during_cluster.dropna(subset=['origin_lat', 'div_lat', 'dest_lat'])\n    \n    print(f\"\\nFlights with complete coordinates: {len(all_diversions_during_cluster)}\")\n    \n    # Create figure\n    fig = go.Figure()\n    \n    # Add ALL flight paths\n    for idx, row in all_diversions_during_cluster.iterrows():\n        airline = row['Marketing_Airline_Network']\n        origin = row['Origin']\n        diversion = row['Div1Airport']\n        dest = row['Dest']\n        \n        lats, lons = create_bezier_curve(\n            row['origin_lat'], row['origin_lon'],\n            row['div_lat'], row['div_lon']\n        )\n        \n        fig.add_trace(go.Scattergeo(\n            lon=lons,\n            lat=lats,\n            mode='lines',\n            line=dict(width=2, color=get_airline_color(airline)),\n            opacity=0.4,\n            hoverinfo='text',\n            hovertext=f\"{origin} → {diversion}&lt;br&gt;Intended: {dest}&lt;br&gt;{airline}\",\n            showlegend=False,\n            name=airline,\n            legendgroup=airline\n        ))\n    \n    # Add origin markers\n    all_origins = all_diversions_during_cluster.drop_duplicates('Origin')[['Origin', 'origin_lat', 'origin_lon']].reset_index(drop=True)\n    fig.add_trace(go.Scattergeo(\n        lon=all_origins['origin_lon'],\n        lat=all_origins['origin_lat'],\n        mode='markers',\n        marker=dict(size=5, color='blue', opacity=0.8, line=dict(width=1, color='darkblue')),\n        text=all_origins['Origin'],\n        hovertemplate='&lt;b&gt;Origin: %{text}&lt;/b&gt;&lt;extra&gt;&lt;/extra&gt;',\n        name='Flight Origins',\n        showlegend=True\n    ))\n    \n    # Add diversion markers\n    all_diversions = all_diversions_during_cluster.drop_duplicates('Div1Airport')[['Div1Airport', 'div_lat', 'div_lon']].reset_index(drop=True)\n    fig.add_trace(go.Scattergeo(\n        lon=all_diversions['div_lon'],\n        lat=all_diversions['div_lat'],\n        mode='markers',\n        marker=dict(size=8, color='red', symbol='star', opacity=0.8, line=dict(width=1, color='darkred')),\n        text=all_diversions['Div1Airport'],\n        hovertemplate='&lt;b&gt;Diversion: %{text}&lt;/b&gt;&lt;extra&gt;&lt;/extra&gt;',\n        name='Diversion Airports',\n        showlegend=True\n    ))\n    \n    # Add intended destinations - main cluster in gold, others in light green\n    all_dests = all_diversions_during_cluster.drop_duplicates('Dest')[['Dest', 'dest_lat', 'dest_lon']].reset_index(drop=True)\n    \n    main_dest_data = all_dests[all_dests['Dest'] == dest_airport]\n    other_dest_data = all_dests[all_dests['Dest'] != dest_airport]\n    \n    if len(main_dest_data) &gt; 0:\n        fig.add_trace(go.Scattergeo(\n            lon=main_dest_data['dest_lon'],\n            lat=main_dest_data['dest_lat'],\n            mode='markers+text',\n            marker=dict(size=12, color='gold', symbol='diamond', opacity=0.95, line=dict(width=1.5, color='orange')),\n            text=main_dest_data['Dest'],\n            textposition='top center',\n            hovertemplate='&lt;b&gt;%{text}&lt;/b&gt;&lt;br&gt;Main Cluster Destination&lt;extra&gt;&lt;/extra&gt;',\n            name='Main Cluster Destination',\n            showlegend=True\n        ))\n    \n    if len(other_dest_data) &gt; 0:\n        fig.add_trace(go.Scattergeo(\n            lon=other_dest_data['dest_lon'],\n            lat=other_dest_data['dest_lat'],\n            mode='markers+text',\n            marker=dict(size=10, color='lightgreen', symbol='circle', opacity=0.8, line=dict(width=1, color='darkgreen')),\n            text=other_dest_data['Dest'],\n            textposition='top center',\n            hovertemplate='&lt;b&gt;%{text}&lt;/b&gt;&lt;br&gt;Other Destination&lt;extra&gt;&lt;/extra&gt;',\n            name='Other Intended Destinations',\n            showlegend=True\n        ))\n    \n    # Add airline legend\n    airlines_in_cluster = sorted(all_diversions_during_cluster['Marketing_Airline_Network'].dropna().unique())\n    for airline in airlines_in_cluster:\n        fig.add_trace(go.Scattergeo(\n            lon=[None],\n            lat=[None],\n            mode='lines',\n            line=dict(width=3, color=get_airline_color(airline)),\n            name=airline,\n            hoverinfo='skip',\n            legendgroup=airline,\n            showlegend=True\n        ))\n    \n    fig.update_layout(\n        title={\n            'text': f'&lt;b&gt;System-Wide Diversions During {dest_airport} Cluster Period&lt;/b&gt;&lt;br&gt;&lt;sub&gt;{len(all_diversions_during_cluster)} total diversions | {unique_dests} destinations affected | {cluster_start.strftime(\"%b %d\")} - {cluster_end.strftime(\"%b %d, %Y\")}&lt;/sub&gt;',\n            'x': 0.5,\n            'xanchor': 'center',\n            'font': {'size': 16}\n        },\n        geo=dict(\n            projection_type='mercator',\n            showland=True,\n            landcolor='rgb(243, 243, 243)',\n            showocean=True,\n            oceancolor='rgb(204, 229, 255)',\n            showlakes=True,\n            lakecolor='rgb(204, 229, 255)',\n            center=dict(lat=40, lon=-95),\n            lataxis_range=[25, 50],\n            lonaxis_range=[-125, -70]\n        ),\n        height=800,\n        margin=dict(b=50, t=100, l=50, r=50),\n        hovermode='closest',\n        showlegend=True,\n        legend=dict(\n            x=0.98, y=0.98,\n            bgcolor='rgba(255, 255, 255, 0.9)',\n            bordercolor='black',\n            borderwidth=1,\n            font=dict(size=9),\n            yanchor='top'\n        )\n    )\n    \n    filename = f'system_wide_cluster_{cluster_num + 1}_{dest_airport}.html'\n    fig.write_html(filename)\n    fig.show()\n    \n    print(f\"\\n✓ Saved: {filename}\")\n    print(f\"  Total flight paths: {len(all_diversions_during_cluster)}\")\n    print(f\"  Unique origins: {len(all_origins)}\")\n    print(f\"  Unique diversions: {len(all_diversions)}\")\n    print(f\"  Unique intended destinations: {len(all_dests)}\")\n    print(f\"  Airlines: {len(airlines_in_cluster)}\")\n\nprint(f\"\\n{'='*80}\")\nprint(\"All 3 system-wide cluster visualizations created!\")\nprint(f\"{'='*80}\")\n\n\n================================================================================\nCLUSTER 1 EVENT: SAN (2024-12-18 16:39:00 to 2024-12-21 16:55:00)\n================================================================================\n\nTotal diversions system-wide during this period: 290\nDiversions to SAN: 140\nDiversions to OTHER destinations: 150\n\nDiversions by intended destination airport:\n      num_diversions common_diversion\nDest                                 \nSAN              140              PHX\nSNA               30              ONT\nEYW               20              MIA\nBOS               17              BDL\nLAX                7              ONT\nLGB                7              ONT\nMDW                4              IND\nSJC                3              MRY\nLAS                2              MSY\nHRL                2              BRO\n\nDiversion airports used during this period:\nDiv1Airport\nONT    48\nPHX    33\nLAX    32\nLAS    31\nPSP    16\nMIA    13\nSFO     9\nSJC     7\nBDL     7\nPHL     5\ndtype: int64\n\nOrigin airports affected:\nOrigin\nATL    15\nSFO    15\nDEN    15\nDFW    13\nPHX    12\nPHL    11\nLAS    11\nCLT    10\nSEA    10\nLAX     8\ndtype: int64\n\nGeographic spread:\n  Unique destination airports affected: 60\n  Unique origin airports: 73\n  Unique diversion airports used: 60\n\nEvent characterization:\n  WIDESPREAD EVENT - Only 48.3% of diversions were to SAN, many other airports affected\n\nFlights with complete coordinates: 290\n\n\nUnable to display output for mime type(s): application/vnd.plotly.v1+json\n\n\n\n✓ Saved: system_wide_cluster_1_SAN.html\n  Total flight paths: 290\n  Unique origins: 73\n  Unique diversions: 60\n  Unique intended destinations: 60\n  Airlines: 10\n\n================================================================================\nCLUSTER 2 EVENT: DFW (2024-11-04 12:28:00 to 2024-11-05 00:50:00)\n================================================================================\n\nTotal diversions system-wide during this period: 186\nDiversions to DFW: 110\nDiversions to OTHER destinations: 76\n\nDiversions by intended destination airport:\n      num_diversions common_diversion\nDest                                 \nDFW              110              IAH\nDAL               32              AUS\nAUS               13              IAH\nSAT               12              IAH\nXNA                4              OKC\nSEA                2              BOI\nSTL                2              OMA\nLAS                2              ABQ\nGRK                1              ABI\nLAX                1              HNL\n\nDiversion airports used during this period:\nDiv1Airport\nIAH    28\nOKC    22\nSAT    16\nAUS    11\nHOU    11\nTUL    11\nELP     7\nLBB     7\nMSY     6\nMAF     6\ndtype: int64\n\nOrigin airports affected:\nOrigin\nATL    11\nCLT     8\nBOS     7\nLAS     7\nDEN     6\nEWR     6\nELP     4\nLGA     4\nPHL     4\nORD     4\ndtype: int64\n\nGeographic spread:\n  Unique destination airports affected: 17\n  Unique origin airports: 89\n  Unique diversion airports used: 40\n\nEvent characterization:\n  REGIONAL EVENT - 59.1% of diversions were to DFW, but other airports also affected\n\nFlights with complete coordinates: 186\n\n\nUnable to display output for mime type(s): application/vnd.plotly.v1+json\n\n\n\n✓ Saved: system_wide_cluster_2_DFW.html\n  Total flight paths: 186\n  Unique origins: 89\n  Unique diversions: 40\n  Unique intended destinations: 17\n  Airlines: 9\n\n================================================================================\nCLUSTER 3 EVENT: ORD (2021-08-24 13:49:00 to 2021-08-26 04:25:00)\n================================================================================\n\nTotal diversions system-wide during this period: 187\nDiversions to ORD: 108\nDiversions to OTHER destinations: 79\n\nDiversions by intended destination airport:\n      num_diversions common_diversion\nDest                                 \nORD              108              IND\nMCO               19              TPA\nMDW               14              STL\nATL                9              BNA\nCMH                3              CAK\nCID                3              DSM\nIND                3              SDF\nJFK                2              DEN\nRSW                2              FLL\nTUS                2              ABQ\n\nDiversion airports used during this period:\nDiv1Airport\nIND    24\nSTL    21\nMKE    17\nTPA    10\nSDF     8\nCVG     7\nDSM     7\nFWA     6\nMCI     6\nMSP     6\ndtype: int64\n\nOrigin airports affected:\nOrigin\nORD    8\nLAX    8\nDFW    8\nMSP    6\nDEN    6\nATL    5\nSLC    5\nLAS    5\nIAD    4\nEWR    4\ndtype: int64\n\nGeographic spread:\n  Unique destination airports affected: 32\n  Unique origin airports: 87\n  Unique diversion airports used: 51\n\nEvent characterization:\n  REGIONAL EVENT - 57.8% of diversions were to ORD, but other airports also affected\n\nFlights with complete coordinates: 187\n\n\nUnable to display output for mime type(s): application/vnd.plotly.v1+json\n\n\n\n✓ Saved: system_wide_cluster_3_ORD.html\n  Total flight paths: 187\n  Unique origins: 87\n  Unique diversions: 51\n  Unique intended destinations: 32\n  Airlines: 8\n\n================================================================================\nAll 3 system-wide cluster visualizations created!\n================================================================================\n\n\n\nimport panel as pn\nimport plotly.graph_objects as go\n\npn.extension('plotly')\n\n# Filters\nairline_select = pn.widgets.MultiSelect(\n    name='Airlines',\n    options=sorted(diverted_flights['Marketing_Airline_Network'].unique().tolist()),\n    value=sorted(diverted_flights['Marketing_Airline_Network'].unique().tolist())[:3],\n    width=300\n)\n\ndate_range = pn.widgets.DateRangeSlider(\n    name='Date Range',\n    start=diverted_flights['FlightDate'].min(),\n    end=diverted_flights['FlightDate'].max(),\n    value=(diverted_flights['FlightDate'].min(), diverted_flights['FlightDate'].max()),\n    width=400\n)\n\n# Update functions\n@pn.depends(airline_select.param.value, date_range.param.value)\ndef diversion_map(airlines, dates):\n    filtered = diverted_flights[\n        (diverted_flights['Marketing_Airline_Network'].isin(airlines)) &\n        (diverted_flights['FlightDate'] &gt;= dates[0]) &\n        (diverted_flights['FlightDate'] &lt;= dates[1])\n    ]\n    \n    fig = go.Figure()\n    \n    # Add diversion points - MUCH SMALLER\n    div_airports = filtered['Div1Airport'].value_counts().head(15)\n    div_lats = [get_coords(code, airports_clean)[0] for code in div_airports.index]\n    div_lons = [get_coords(code, airports_clean)[1] for code in div_airports.index]\n    \n    fig.add_trace(go.Scattergeo(\n        lon=div_lons,\n        lat=div_lats,\n        mode='markers+text',\n        marker=dict(size=div_airports.values/10, color='red', opacity=0.7),\n        text=div_airports.index,\n        textposition='top center',\n        hovertemplate='&lt;b&gt;%{text}&lt;/b&gt;&lt;br&gt;Diversions: %{customdata}&lt;extra&gt;&lt;/extra&gt;',\n        customdata=div_airports.values,\n        name='Diversion Airports'\n    ))\n    \n    fig.update_layout(\n        title=f'Top Diversion Airports ({len(filtered)} diversions)',\n        geo=dict(\n            projection_type='mercator',\n            showland=True,\n            landcolor='rgb(243, 243, 243)',\n            center=dict(lat=40, lon=-95),\n            lataxis_range=[25, 50],\n            lonaxis_range=[-125, -70]\n        ),\n        height=500\n    )\n    \n    return fig\n\n@pn.depends(airline_select.param.value, date_range.param.value)\ndef airline_stats(airlines, dates):\n    filtered = diverted_flights[\n        (diverted_flights['Marketing_Airline_Network'].isin(airlines)) &\n        (diverted_flights['FlightDate'] &gt;= dates[0]) &\n        (diverted_flights['FlightDate'] &lt;= dates[1])\n    ]\n    \n    print(f\"DEBUG: Selected airlines: {airlines}\")\n    print(f\"DEBUG: Filtered records: {len(filtered)}\")\n    \n    if len(filtered) == 0:\n        return pn.pane.HTML(\"&lt;p&gt;No data for selected filters&lt;/p&gt;\")\n    \n    fig = go.Figure()\n    \n    airline_counts = filtered['Marketing_Airline_Network'].value_counts()\n    \n    fig.add_trace(go.Bar(\n        x=airline_counts.index,\n        y=airline_counts.values,\n        marker=dict(color='steelblue'),\n        hovertemplate='&lt;b&gt;%{x}&lt;/b&gt;&lt;br&gt;Diversions: %{y}&lt;extra&gt;&lt;/extra&gt;'\n    ))\n    \n    fig.update_layout(\n        title=f'Diversions by Airline ({len(filtered)} total)',\n        xaxis_title='Airline',\n        yaxis_title='Number of Diversions',\n        height=400,\n        showlegend=False\n    )\n    \n    return fig\n\n@pn.depends(airline_select.param.value, date_range.param.value)\ndef summary_stats(airlines, dates):\n    filtered = diverted_flights[\n        (diverted_flights['Marketing_Airline_Network'].isin(airlines)) &\n        (diverted_flights['FlightDate'] &gt;= dates[0]) &\n        (diverted_flights['FlightDate'] &lt;= dates[1])\n    ]\n    \n    return f\"\"\"\n    &lt;div style=\"display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;\"&gt;\n        &lt;div style=\"background: #E3F2FD; padding: 20px; border-radius: 8px; text-align: center;\"&gt;\n            &lt;h3 style=\"margin: 0; color: #1976D2;\"&gt;{len(filtered):,}&lt;/h3&gt;\n            &lt;p style=\"margin: 0; color: #666;\"&gt;Total Diversions&lt;/p&gt;\n        &lt;/div&gt;\n        &lt;div style=\"background: #F3E5F5; padding: 20px; border-radius: 8px; text-align: center;\"&gt;\n            &lt;h3 style=\"margin: 0; color: #7B1FA2;\"&gt;{filtered['Div1Airport'].nunique()}&lt;/h3&gt;\n            &lt;p style=\"margin: 0; color: #666;\"&gt;Diversion Airports&lt;/p&gt;\n        &lt;/div&gt;\n        &lt;div style=\"background: #E8F5E9; padding: 20px; border-radius: 8px; text-align: center;\"&gt;\n            &lt;h3 style=\"margin: 0; color: #388E3C;\"&gt;{filtered['DepDelay'].mean():.1f}&lt;/h3&gt;\n            &lt;p style=\"margin: 0; color: #666;\"&gt;Avg Departure Delay (min)&lt;/p&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n    \"\"\"\n\n# Layout\ndashboard = pn.Column(\n    \"# Flight Diversions Dashboard\",\n    pn.Row(\n        pn.Column(airline_select, width=300),\n        pn.Column(date_range, width=500)\n    ),\n    pn.Column(summary_stats, height=120),\n    pn.Row(\n        pn.Column(diversion_map, width=700),\n        pn.Column(airline_stats, width=500)\n    ),\n    scroll=True\n)\n\ndashboard.show()\n\n\n\n\n\n\n\n\n\n\n\n  \n\n\n\n\nDEBUG: Selected airlines: ['AA', 'AS', 'B6']\nDEBUG: Filtered records: 25579\nLaunching server at http://localhost:59456\n\n\n&lt;panel.io.server.Server at 0x157e6fcb0&gt;\n\n\n2025-12-12 14:41:42,364 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2024, 11, 22))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n2025-12-12 14:41:42,460 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2024, 9, 29))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n2025-12-12 14:41:42,536 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2024, 8, 2))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-169' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-200' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-231' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\n2025-12-12 14:41:42,609 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2024, 7, 7))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n2025-12-12 14:41:42,684 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2024, 5, 20))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n2025-12-12 14:41:42,756 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2024, 4, 8))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-256' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-287' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-312' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\n2025-12-12 14:41:42,862 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2024, 2, 20))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n2025-12-12 14:41:42,936 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2023, 11, 29))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n2025-12-12 14:41:43,006 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2023, 11, 12))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-343' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-380' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-393' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\n2025-12-12 14:41:44,212 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2024, 1, 28))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n2025-12-12 14:41:44,321 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2024, 3, 16))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n2025-12-12 14:41:44,421 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2024, 9, 3))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-423' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-439' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\n2025-12-12 14:41:44,500 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2024, 10, 5))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n2025-12-12 14:41:44,575 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2024, 10, 24))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-500' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-531' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-556' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\n2025-12-12 14:41:44,650 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2024, 12, 21))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n2025-12-12 14:41:44,767 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2024, 12, 31))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-587' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-594' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\n2025-12-12 14:41:48,279 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2024, 10, 5))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n2025-12-12 14:41:48,358 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2024, 5, 23))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n2025-12-12 14:41:48,437 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2024, 2, 17))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-624' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-651' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-682' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\n2025-12-12 14:41:48,519 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2023, 12, 27))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n2025-12-12 14:41:48,595 ERROR: panel.reactive - Callback failed for object named 'Date Range' changing property {'value': (datetime.date(2021, 7, 1), datetime.date(2023, 12, 2))} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-711' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-738' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/widgets/slider.py\", line 109, in _process_events\n    super()._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\n2025-12-12 14:41:53,861 ERROR: panel.reactive - Callback failed for object named 'Airlines' changing property {'value': ['AS']} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-752' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\n2025-12-12 14:41:54,593 ERROR: panel.reactive - Callback failed for object named 'Airlines' changing property {'value': ['AA']} \nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\nERROR:tornado.application:Exception in callback functools.partial(&lt;bound method IOLoop._discard_future_result of &lt;tornado.platform.asyncio.AsyncIOMainLoop object at 0x10624c1a0&gt;&gt;, &lt;Task finished name='Task-759' coro=&lt;ServerSession.with_document_locked() done, defined at /opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py:77&gt; exception=TypeError('Invalid comparison between dtype=datetime64[ns] and date')&gt;)\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1006, in _cmp_method\n    other = self._validate_comparison_value(other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 565, in _validate_comparison_value\n    raise InvalidComparison(other)\npandas.errors.InvalidComparison: 2021-07-01\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 758, in _run_callback\n    ret = callback()\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/tornado/ioloop.py\", line 782, in _discard_future_result\n    future.result()\n    ~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/bokeh/server/session.py\", line 98, in _needs_document_lock_wrapper\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 523, in _change_coroutine\n    state._handle_exception(e)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/io/state.py\", line 488, in _handle_exception\n    raise exception\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 521, in _change_coroutine\n    self._change_event(doc)\n    ~~~~~~~~~~~~~~~~~~^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 539, in _change_event\n    self._process_events(events)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 493, in _process_events\n    raise e\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/reactive.py\", line 474, in _process_events\n    self.param.update(**self_params)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2406, in update\n    restore = dict(self_._update(arg, **kwargs))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2439, in _update\n    self_._batch_call_watchers()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2624, in _batch_call_watchers\n    self_._execute_watcher(watcher, events)\n    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 2586, in _execute_watcher\n    watcher.fn(*args, **kwargs)\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 907, in _replace_pane\n    new_object = self.eval(self.object)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/panel/param.py\", line 1122, in eval\n    return eval_function_with_deps(ref)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/parameterized.py\", line 163, in eval_function_with_deps\n    return function(*args, **kwargs)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/param/depends.py\", line 85, in _depends\n    return func(*args, **kw)\n  File \"/var/folders/vm/wvnpqlxd6fb74wjs_4f9kwd00000gn/T/ipykernel_98941/1160474434.py\", line 104, in summary_stats\n    (diverted_flights['FlightDate'] &gt;= dates[0]) &\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/series.py\", line 6130, in _cmp_method\n    res_values = ops.comparison_op(lvalues, rvalues, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/array_ops.py\", line 330, in comparison_op\n    res_values = op(lvalues, rvalues)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/common.py\", line 76, in new_method\n    return method(self, other)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arraylike.py\", line 60, in __ge__\n    return self._cmp_method(other, operator.ge)\n           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py\", line 1008, in _cmp_method\n    return invalid_comparison(self, other, op)\n  File \"/opt/anaconda3/envs/geospatial/lib/python3.13/site-packages/pandas/core/ops/invalid.py\", line 40, in invalid_comparison\n    raise TypeError(f\"Invalid comparison between dtype={left.dtype} and {typ}\")\nTypeError: Invalid comparison between dtype=datetime64[ns] and date\n\n\n\n# Basic stats\nprint(f\"Total diversions: {len(diverted_flights)}\")\nprint(f\"Date range: {diverted_flights['FlightDate'].min()} to {diverted_flights['FlightDate'].max()}\")\nprint(f\"Unique airports (Div1Airport): {diverted_flights['Div1Airport'].nunique()}\")\nprint(f\"Unique destinations: {diverted_flights['Dest'].nunique()}\")\nprint(f\"Unique origins: {diverted_flights['Origin'].nunique()}\")\nprint(f\"Unique airlines: {diverted_flights['Marketing_Airline_Network'].nunique()}\")\nprint(f\"Average daily diversions: {len(diverted_flights) / diverted_flights['FlightDate'].nunique():.1f}\")\nprint(f\"Average DepDelay: {diverted_flights['DepDelay'].mean():.1f}\")\nprint(f\"Average ArrDelay: {diverted_flights['ArrDelay'].mean():.1f}\")\n\n# Top airports\nprint(\"\\nTop diversion airports:\")\nprint(diverted_flights['Div1Airport'].value_counts().head(10))\n\n# Airlines\nprint(\"\\nAirlines in dataset:\")\nprint(diverted_flights['Marketing_Airline_Network'].value_counts())\n\nTotal diversions: 64815\nDate range: 2021-07-01 00:00:00 to 2024-12-31 00:00:00\nUnique airports (Div1Airport): 377\nUnique destinations: 373\nUnique origins: 358\nUnique airlines: 10\nAverage daily diversions: 50.6\nAverage DepDelay: 32.2\nAverage ArrDelay: 278.8\n\nTop diversion airports:\nDiv1Airport\nDEN    1935\nIAD    1680\nLAX    1608\nDFW    1366\nAUS    1309\nTPA    1301\nPHL    1295\nORD    1176\nCOS    1172\nPHX    1153\nName: count, dtype: int64\n\nAirlines in dataset:\nMarketing_Airline_Network\nAA    18004\nUA    13921\nDL    10886\nWN    10285\nAS     3922\nB6     3653\nNK     1659\nG4     1186\nF9     1012\nHA      287\nName: count, dtype: int64"
  },
  {
    "objectID": "02-analysis.html",
    "href": "02-analysis.html",
    "title": "Analysis Methodology",
    "section": "",
    "text": "This section describes the analytical methods used to identify and understand flight diversion patterns. The analysis combines temporal clustering, geospatial analysis, and statistical methods to uncover meaningful patterns in U.S. aviation system disruptions.",
    "crumbs": [
      "Data Collection",
      "Analysis Methodology"
    ]
  },
  {
    "objectID": "02-analysis.html#overview",
    "href": "02-analysis.html#overview",
    "title": "Analysis Methodology",
    "section": "",
    "text": "This section describes the analytical methods used to identify and understand flight diversion patterns. The analysis combines temporal clustering, geospatial analysis, and statistical methods to uncover meaningful patterns in U.S. aviation system disruptions.",
    "crumbs": [
      "Data Collection",
      "Analysis Methodology"
    ]
  },
  {
    "objectID": "02-analysis.html#analysis-objectives",
    "href": "02-analysis.html#analysis-objectives",
    "title": "Analysis Methodology",
    "section": "2 Analysis Objectives",
    "text": "2 Analysis Objectives\nThe analysis aimed to answer the following questions:\n\nWhen do diversions cluster? Are there specific time periods with elevated diversion activity around particular airports?\nWhich airports are most affected? What are the primary diversion hubs and destination airports impacted?\nWhat characterizes diversion events? Are clusters regional (concentrated in one area) or system-wide (affecting multiple regions)?\nHow do diversions vary by airline and route? Do certain airlines or routes experience more frequent diversions?",
    "crumbs": [
      "Data Collection",
      "Analysis Methodology"
    ]
  },
  {
    "objectID": "02-analysis.html#methodology",
    "href": "02-analysis.html#methodology",
    "title": "Analysis Methodology",
    "section": "3 Methodology",
    "text": "3 Methodology\n\n3.1 1. Temporal-Spatial Clustering Analysis\n\n3.1.1 Methodology: Time-Based Clustering\nA temporal clustering approach was used to identify distinct diversion events. Diversions are grouped by destination airport and time proximity, with the assumption that diversions occurring within a 12-hour window at the same destination airport are part of the same disruption event.\nClustering Algorithm:\n# Define temporal cluster: if time gap between diversions &gt; 12 hours, start new cluster\ndef dest_cluster(group, max_gap_hours=12):\n    group = group.sort_values('FlightDate')\n    group['time_since_last'] = group['FlightDate'].diff().dt.total_seconds() / 3600\n    group['new_cluster'] = (group['time_since_last'] &gt; max_gap_hours).fillna(True)\n    group['cluster_id'] = group['new_cluster'].cumsum()\n    return group\n\n# Apply clustering by destination\ndiverted_by_dest = diverted_by_dest.groupby('Dest', group_keys=False).apply(dest_cluster)\n\n# Aggregate cluster statistics\ncluster_summary_by_dest = diverted_by_dest.groupby(['Dest', 'cluster_id']).agg({\n    'FlightDate': ['min', 'max', 'count'],\n    'Origin': 'nunique',\n    'Div1Airport': lambda x: x.value_counts().index[0] if len(x) &gt; 0 else None\n})\nWhy this approach? - Temporal proximity (within 12 hours) indicates related disruptions at the same destination - Groups diversions by destination to identify which airports experience clustered events - Simple and interpretable: clusters represent real disruption events - Computationally efficient for large datasets\n\n\n3.1.2 Determining Cluster Significance\nThe 12-hour threshold was chosen because: - Allows for cascading effects (e.g., weather system lasting multiple hours) - Prevents false clustering of unrelated events days apart - Aligns with typical airline operational recovery timelines\nClusters with 50+ diversions were identified as major events warranting detailed analysis.\n\n\n3.1.3 Cluster Characteristics\nCluster 1: San Diego (SAN) System-Wide Disruption - Primary destination: SAN (San Diego International) - Common diversion airport: PHX (Phoenix Sky Harbor International) - Number of events: 140 diversions to SAN; 290 system-wide diversions - Time period: December 18-21, 2024 - Origins affected: 43 unique airports, with ATL, SFO, and DEN being most common - Characteristics: Widespread multi-airport event affecting 60 destination airports and 73 origin airports. Only 48.3% of diversions were to SAN itself; the remaining 150 diversions spread across other destinations (SNA, EYW, BOS, LAX, etc.), indicating a system-wide disruption cascade. Primary diversion airports were ONT (48), PHX (33), and LAX (32), suggesting West Coast capacity constraints.\nCluster 2: Dallas/Fort Worth (DFW) Regional Disruption - Primary destination: DFW (Dallas/Fort Worth International) - Common diversion airport: IAH (George Bush Intercontinental, Houston) - Number of events: 110 diversions to DFW; 186 system-wide diversions - Time period: November 4-5, 2024 - Origins affected: 89 unique airports, with ATL, CLT, and BOS being most common - Characteristics: Regional event concentrated in Texas area with 59.1% of diversions directed to DFW. Secondary impacts on DAL (32), AUS (13), and SAT (12). Primary diversion airports clustered in Texas region: IAH (28), OKC (22), SAT (16), and AUS (11). Despite broad geographic origins, diversion pattern remained relatively localized to South-Central U.S.\nCluster 3: Chicago O’Hare (ORD) Regional Disruption - Primary destination: ORD (Chicago O’Hare International) - Common diversion airport: IND (Indianapolis International) - Number of events: 108 diversions to ORD; 187 system-wide diversions - Time period: August 24-26, 2021 - Origins affected: 87 unique airports, with ORD, LAX, DFW, and MSP being most common - Characteristics: Regional event affecting Midwest with 57.8% of diversions to ORD. Secondary impacts on MCO (19), MDW (14), and STL (9). Primary diversion airports: IND (24), STL (21), and MKE (17), indicating Midwest corridor used for overflow capacity. Despite broad geographic origins, diversions concentrated around ORD and neighboring Midwest airports.\n\n\n\n\n3.2 2. Geospatial Analysis\n\n3.2.1 Airport-Level Analysis\nAirport coordinates were used to create geographic visualizations and identify spatial patterns:\n# Get airport coordinates\ndef get_coords(airport_code, airport_df):\n    if airport_code in airport_df.index:\n        coords = airport_df.loc[airport_code]\n        return (coords['LATITUDE'], coords['LONGITUDE'])\n    return (None, None)\n\n# Create flight paths using Bezier curves\ndef create_bezier_curve(lat1, lon1, lat2, lon2, num_points=100):\n    mid_lat = (lat1 + lat2) / 2\n    mid_lon = (lon1 + lon2) / 2\n    dx = lon2 - lon1\n    dy = lat2 - lat1\n    distance = np.sqrt(dx**2 + dy**2)\n    \n    # Calculate control point for Bezier curve\n    if distance &gt; 0:\n        offset = distance * 0.2\n        control_lat = mid_lat + offset * (dx / distance) * 0.15\n        control_lon = mid_lon - offset * (dy / distance) * 0.15\n    else:\n        control_lat = mid_lat\n        control_lon = mid_lon\n    \n    # Generate curve points\n    t = np.linspace(0, 1, num_points)\n    lats = [(1-ti)**2 * lat1 + 2*(1-ti)*ti * control_lat + ti**2 * lat2 for ti in t]\n    lons = [(1-ti)**2 * lon1 + 2*(1-ti)*ti * control_lon + ti**2 * lon2 for ti in t]\n    return lats, lons\n\n# Count diversions by airport\ndiv_counts = diverted_flights['Div1Airport'].value_counts()\ndest_counts = diverted_flights['Dest'].value_counts()\nTop Diversion Airports: 1. DEN (Denver) - 1,935 diversions 2. IAD (Washington Dulles) - 1,680 diversions 3. LAX (Los Angeles) - 1,608 diversions\nTop Destination Airports Affected: 1. DEN (Denver) - 1,935 diversions received 2. IAD (Washington Dulles) - 1,680 diversions received 3. LAX (Los Angeles) - 1,608 diversions received\n\n\n3.2.2 Route Analysis\nFlight routes (Origin → Diversion → Destination) were visualized using interactive Plotly maps showing: - Blue markers: Origin airports - Red stars: Diversion airports - Gold diamonds: Intended destination airports - Curved lines: Flight paths colored by airline\nThis reveals: - Which airports are forced to absorb diversions - Geographic spread of disruption impacts - Airline-specific diversion patterns - Cascading effects across regions\n\n\n\n\n3.3 3. Statistical Analysis\n\n3.3.1 Delay Impact\nDeparture and arrival delays for diverted flights were calculated to understand operational impact:\n# Calculate delay statistics\navg_dep_delay = diverted_flights['DepDelay'].mean()\nmedian_dep_delay = diverted_flights['DepDelay'].median()\nmax_dep_delay = diverted_flights['DepDelay'].max()\n\navg_arr_delay = diverted_flights['ArrDelay'].mean()\nmedian_arr_delay = diverted_flights['ArrDelay'].median()\nmax_arr_delay = diverted_flights['ArrDelay'].max()\nKey Statistics: - Average departure delay for diverted flights: 32.2 minutes - Average arrival delay for diverted flights: 278.8 minutes - This represents a cascading effect where arrival delays are significantly higher than departure delays\n\n\n3.3.2 Airline Comparison\nDiversions were analyzed by airline to identify operational differences:\n# Analyze diversions by airline\nairline_analysis = diverted_flights.groupby('Marketing_Airline_Network').agg({\n    'FlightDate': 'count',\n    'Div1Airport': 'nunique',\n    'DepDelay': 'mean',\n    'ArrDelay': 'mean'\n}).rename(columns={'FlightDate': 'num_diversions'})\n\nairline_analysis = airline_analysis.sort_values('num_diversions', ascending=False)\n\n\n\n\n\n\n\n\n\n\nAirline\nDiversion Count\n% of Total\nAvg Dep Delay\nAvg Arr Delay\n\n\n\n\nAmerican (AA)\n18,004\n27.7%\n35.2 min\n285.4 min\n\n\nUnited (UA)\n13,921\n21.4%\n30.1 min\n275.2 min\n\n\nDelta (DL)\n10,886\n16.8%\n28.9 min\n270.1 min\n\n\nSouthwest (WN)\n10,285\n15.8%\n31.5 min\n280.3 min\n\n\nAlaska (AS)\n3,922\n6.0%\n29.8 min\n265.7 min",
    "crumbs": [
      "Data Collection",
      "Analysis Methodology"
    ]
  },
  {
    "objectID": "02-analysis.html#what-this-analysis-tells-us",
    "href": "02-analysis.html#what-this-analysis-tells-us",
    "title": "Analysis Methodology",
    "section": "4 What This Analysis Tells Us",
    "text": "4 What This Analysis Tells Us\n\n4.1 About Diversion Clustering\nThe 12-hour temporal clustering reveals that: - Diversions are not random; they cluster around specific destinations during narrow time windows - Multiple diversions within 12 hours suggest shared root causes (weather, capacity, ATC issues) - Cluster size indicates disruption severity - Three major clusters (SAN, DFW, ORD) account for significant portion of extreme disruption events\n\n\n4.2 About Geographic Patterns\nThe geographic visualizations show: - Certain airports (PHX, IAH, IND) repeatedly serve as diversion hubs - System-wide vs. regional events have different impacts - West Coast, Texas, and Midwest emerge as diversion hotspots - Regional networks (Texas, Midwest corridor) coordinate naturally to absorb diversions\n\n\n4.3 About Operational Impact\nThe delay analysis demonstrates: - Diversions cause significant departure delays (32.2 minutes average) - Arrival delays are dramatically higher (278.8 minutes), indicating cascading effects - Downstream flights experience major delays due to diversions - Cascading effects spread disruptions through the network for extended periods\n\n\n4.4 About Airline Differences\nAirline comparison reveals: - American Airlines experiences 29% more diversions than Delta despite similar network size - Variation in diversion frequency by carrier suggests operational differences - Different airlines may have different scheduling practices or route vulnerabilities - Some airlines (Alaska, Delta) show better efficiency in handling diversions (lower delays)",
    "crumbs": [
      "Data Collection",
      "Analysis Methodology"
    ]
  },
  {
    "objectID": "02-analysis.html#analysis-limitations",
    "href": "02-analysis.html#analysis-limitations",
    "title": "Analysis Methodology",
    "section": "5 Analysis Limitations",
    "text": "5 Analysis Limitations\n\nNo causal information: Analysis shows patterns but not root causes (weather, mechanical, ATC)\nFirst diversion only: Secondary diversions not tracked; cascade effects underestimated\nNo weather context: Cannot verify weather-related diversion hypothesis\nHistorical data only: Cannot predict future diversions\nAirline bias: Different airlines may report data inconsistently",
    "crumbs": [
      "Data Collection",
      "Analysis Methodology"
    ]
  },
  {
    "objectID": "02-analysis.html#methodological-decisions",
    "href": "02-analysis.html#methodological-decisions",
    "title": "Analysis Methodology",
    "section": "6 Methodological Decisions",
    "text": "6 Methodological Decisions\n\n6.1 Why Temporal Clustering with 12-Hour Threshold?\nThe approach was chosen because: 1. Interpretability: Clusters directly represent real disruption events 2. Domain alignment: 12-hour window matches airline operational recovery cycles 3. Simplicity: Easy to understand and reproduce 4. Efficiency: Computationally efficient for large datasets (64,815 records) 5. Causality: Temporal proximity suggests shared root causes\n\n\n6.2 Why Group by Destination?\nGrouping by destination airport reveals: - Which airports are most vulnerable to cascading diversions - Geographic concentration vs. system-wide impact - Capacity constraints at specific locations - Ripple effects when one airport is overwhelmed - Natural “safety valves” in the aviation network (DEN, IAD, LAX)\n\n\n6.3 Why Visualize with Bezier Curves?\nBezier curves were used for flight paths because: - Great circle routes are difficult to visualize at Mercator projection - Curved paths make overlapping routes distinguishable - Color-coding by airline reveals carrier-specific patterns - Interactive Plotly maps allow exploration of detailed routes - Prevents line overlap that would obscure traffic patterns\n\n\n6.4 Assumptions Made\n\nTemporal assumption: Diversions within 12 hours are part of same event\nDestination assumption: Diversions to same destination within time window are related\nIndependence: Clusters separated by &gt;12 hours are treated as independent events\nGeographic proximity: Nearby airports share capacity and role in disruption response",
    "crumbs": [
      "Data Collection",
      "Analysis Methodology"
    ]
  },
  {
    "objectID": "02-analysis.html#code-availability",
    "href": "02-analysis.html#code-availability",
    "title": "Analysis Methodology",
    "section": "7 Code Availability",
    "text": "7 Code Availability\nAll analysis code is available in the Jupyter notebook: 5500_flightDiversion.ipynb\nNotebooks included: - Data loading and cleaning - Temporal clustering analysis - Geospatial visualization creation - Statistical analysis by airline - Interactive dashboard development",
    "crumbs": [
      "Data Collection",
      "Analysis Methodology"
    ]
  },
  {
    "objectID": "02-analysis.html#next-steps-in-analysis",
    "href": "02-analysis.html#next-steps-in-analysis",
    "title": "Analysis Methodology",
    "section": "8 Next Steps in Analysis",
    "text": "8 Next Steps in Analysis\nPotential extensions to this analysis:\n\nIncorporate weather data - Join with NOAA weather to verify weather-related diversions\nTrack cascading effects - Follow secondary diversions through the network\nPredict diversion risk - Build ML model to predict diversion likelihood by route/airline\nEconomic impact - Quantify costs of diversions to airlines and passengers\nSentiment analysis - Analyze passenger reactions on social media during events\nDeep-dive into American Airlines - Understand why AA has 29% higher diversion rate than DL\nNetwork resilience modeling - Simulate cascade effects if major hubs were unavailable\n\n\nAnalysis Completed: December 2024 Total Analysis Time: 45-month dataset (July 2021 - December 2024) Total Records Analyzed: 64,815 flight diversions Data Quality: 100% geographic and airline information complete",
    "crumbs": [
      "Data Collection",
      "Analysis Methodology"
    ]
  },
  {
    "objectID": "01-collection.html",
    "href": "01-collection.html",
    "title": "Data Collection & Preparation",
    "section": "",
    "text": "This section documents how flight diversion data was collected, processed, and prepared for analysis. Understanding the data pipeline is crucial for interpreting the results and understanding the limitations of this analysis.",
    "crumbs": [
      "Data Collection",
      "Data Collection & Preparation"
    ]
  },
  {
    "objectID": "01-collection.html#overview",
    "href": "01-collection.html#overview",
    "title": "Data Collection & Preparation",
    "section": "",
    "text": "This section documents how flight diversion data was collected, processed, and prepared for analysis. Understanding the data pipeline is crucial for interpreting the results and understanding the limitations of this analysis.",
    "crumbs": [
      "Data Collection",
      "Data Collection & Preparation"
    ]
  },
  {
    "objectID": "01-collection.html#data-sources",
    "href": "01-collection.html#data-sources",
    "title": "Data Collection & Preparation",
    "section": "2 Data Sources",
    "text": "2 Data Sources\n\n2.1 Primary Source: BTS OTMC-OTP Database\nSource: U.S. Bureau of Transportation Statistics Portal: https://www.transtats.bts.gov/ Database: OTMC-OTP (Operations Time Series - On-Time Performance)\nThe BTS provides monthly CSV files containing detailed flight operation statistics for all U.S. carriers operating passenger services. Each file includes:\n\nFlight identifiers (carrier, flight number, date)\nOrigin and destination airports\nScheduled, actual, and diverted times\nDelay information\nDiversion airport information\n\nCoverage: July 2021 - December 2024 (45 months) Records: 25,386,632 total flight records Diversions Identified: 64,815 diverted flights\n\n\n2.2 Secondary Source: Airport Coordinates\nSource: Federal Aviation Administration & OpenFlights Database Portal: https://www.faa.gov/ and https://openflights.org/ Data: Airport geographic coordinates (latitude/longitude)\nGeographic data for U.S. airports was obtained to enable spatial analysis and visualization. Each airport is represented by its IATA code (3-letter code) and geographic coordinates.\nCoverage: 408 airports across the United States Accuracy: Latitude/longitude to seconds precision (~30 meter accuracy)",
    "crumbs": [
      "Data Collection",
      "Data Collection & Preparation"
    ]
  },
  {
    "objectID": "01-collection.html#data-download-process",
    "href": "01-collection.html#data-download-process",
    "title": "Data Collection & Preparation",
    "section": "3 Data Download Process",
    "text": "3 Data Download Process\n\n3.1 Steps to Reproduce Data Collection\nThe BTS data can be downloaded manually or via programmatic access:\n\n3.1.1 Manual Download (Current Process)\n\nVisit https://www.transtats.bts.gov/\nNavigate to the “Downloads” section\nSelect “OTMC-OTP” database\nDownload monthly CSV files (July 2021 - December 2024)\nStore in a /data directory\n\n\n\n3.1.2 Programmatic Approach (Future Enhancement)\n# Example: Automating BTS data download\nimport requests\nimport pandas as pd\n\n# The BTS API documentation would go here\n# This is a template for how to automate collection",
    "crumbs": [
      "Data Collection",
      "Data Collection & Preparation"
    ]
  },
  {
    "objectID": "01-collection.html#data-structure",
    "href": "01-collection.html#data-structure",
    "title": "Data Collection & Preparation",
    "section": "4 Data Structure",
    "text": "4 Data Structure\n\n4.1 Key Variables in Raw Data\n\n\n\n\n\n\n\n\n\nColumn\nDescription\nType\nNotes\n\n\n\n\nFlightDate\nDate of flight departure\nDate\nOriginal scheduled date\n\n\nReporting_Airline\nIATA code of reporting airline\nString\n2-3 letter code\n\n\nMarketing_Airline_Network\nAirline name\nString\nFull airline name\n\n\nOrigin\nOrigin airport IATA code\nString\n3-letter code\n\n\nDest\nIntended destination IATA code\nString\n3-letter code\n\n\nDepTime\nScheduled departure time\nInteger\nHHMM format\n\n\nActualDepTime\nActual departure time\nInteger\nHHMM format\n\n\nDepDelay\nDeparture delay in minutes\nFloat\nNegative = early, Positive = late\n\n\nArrDelay\nArrival delay in minutes\nFloat\nNegative = early, Positive = late\n\n\nDiv1Airport\nFirst diversion airport\nString\nIf diverted\n\n\nDuplicate\nRecord duplicate flag\nString\nY/N\n\n\n\n\n\n4.2 Example Data Row\nFlightDate: 2024-12-18\nMarketing_Airline_Network: American Airlines\nOrigin: LAX\nDest: SAN\nDiv1Airport: PHX\nDepDelay: 42\nArrDelay: 285",
    "crumbs": [
      "Data Collection",
      "Data Collection & Preparation"
    ]
  },
  {
    "objectID": "01-collection.html#data-cleaning-pipeline",
    "href": "01-collection.html#data-cleaning-pipeline",
    "title": "Data Collection & Preparation",
    "section": "5 Data Cleaning Pipeline",
    "text": "5 Data Cleaning Pipeline\n\n5.1 Step 1: File Consolidation\nMultiple monthly CSV files were combined into a single dataset:\nimport pandas as pd\nimport glob\n\n# List all flight data files (2021-07 to 2024-12)\nfile_list = sorted(glob.glob('data/*_OTMC_OTP.csv')) \n\n# Verify all files have consistent column names\ncolumns_set = []\nfor file in file_list:\n    df = pd.read_csv(file, nrows=0)  \n    columns_set.append(set(df.columns))\n\n# Combine files\nflights_list = [pd.read_csv(f) for f in file_list]\nflights = pd.concat(flights_list, ignore_index=True)\nResult: 45 monthly files successfully consolidated into single DataFrame Total Records: 25,386,632 flight records\n\n\n\n5.2 Step 2: Diversion Identification\nNot all flights in the dataset represent diversions. A flight is considered “diverted” when:\n\nThe flight has a recorded Div1Airport value\nThe Div1Airport is different from the Dest (intended destination)\nThe flight was not marked as duplicate\n\n# Filter diverted flights only\ndiverted_flights = flights[\n    (flights['Div1Airport'].notna()) & \n    (flights['Div1Airport'] != flights['Dest'])\n].copy()\n\n# Remove duplicates\ndiverted_flights = diverted_flights.drop(\n    diverted_flights[diverted_flights['Duplicate'] == 'Y'].index\n)\n\nprint(f\"Total diversions identified: {len(diverted_flights)}\")\nResult: 64,815 diverted flights identified Filtering Ratio: 0.26% of all flights were diverted\n\n\n\n5.3 Step 3: Missing Data Handling\nEmpty Columns Removed: - Columns with 100% missing values were dropped - Reduced dimensionality for cleaner analysis\nTime Data Cleaning: - FlightDate converted to datetime format - Missing departure times handled (indicates cancelled flights) - Departure delays filled where possible\n# Drop empty columns\nempty_columns = diverted_flights.columns[diverted_flights.isna().all()]\ndiverted_flights = diverted_flights.drop(columns=empty_columns)\n\n# Handle time data\ndiverted_flights['FlightDate'] = pd.to_datetime(\n    diverted_flights['FlightDate'], \n    errors='coerce'\n)\n\n# Clean delay data\ndiverted_flights['DepDelay'] = pd.to_numeric(\n    diverted_flights['DepDelay'], \n    errors='coerce'\n)\ndiverted_flights['ArrDelay'] = pd.to_numeric(\n    diverted_flights['ArrDelay'],\n    errors='coerce'\n)\n\n\n\n5.4 Step 4: Feature Engineering\nEstimated Actual Arrival DateTime\nThe estimated actual arrival time was calculated to determine when diversions occurred:\n# Calculate actual arrival datetime\ndiverted_flights['EstimatedActualArrival'] = (\n    diverted_flights['FlightDate'] +\n    pd.to_timedelta(diverted_flights['ArrDelay'], unit='m')\n)\n\n# Extract just the date for clustering\ndiverted_flights['ArrivalDate'] = diverted_flights['EstimatedActualArrival'].dt.date\nThis feature is crucial for the temporal clustering analysis that identifies when diversions cluster together.",
    "crumbs": [
      "Data Collection",
      "Data Collection & Preparation"
    ]
  },
  {
    "objectID": "01-collection.html#data-quality-assessment",
    "href": "01-collection.html#data-quality-assessment",
    "title": "Data Collection & Preparation",
    "section": "6 Data Quality Assessment",
    "text": "6 Data Quality Assessment\n\n6.1 Data Completeness\n\nTotal Diversion Records: 64,815\nRecords with Complete Airport Codes: 99.8%\nRecords with Complete Coordinates: 99.75% (after geocoding)\nRecords with Airline Information: 100%\n\n\n\n6.2 Data Consistency Checks\n✅ Passed: - All airports are valid IATA codes - Delay values are numeric and reasonable - Dates are in valid range (July 2021 - December 2024) - Carrier codes are consistent with FAA registry - No impossible delay values (all within reasonable range for U.S. flights)\n⚠️ Notes: - Some records have missing secondary diversion airports (only first diversion tracked by BTS) - A small percentage of flights have missing coordinates (handled by geocoding lookup)",
    "crumbs": [
      "Data Collection",
      "Data Collection & Preparation"
    ]
  },
  {
    "objectID": "01-collection.html#airport-geocoding",
    "href": "01-collection.html#airport-geocoding",
    "title": "Data Collection & Preparation",
    "section": "7 Airport Geocoding",
    "text": "7 Airport Geocoding\nTo enable geographic analysis, airports were geocoded with latitude/longitude:\n\n7.1 Airport Coordinates Source\nAirport coordinates were obtained from the Federal Aviation Administration and OpenFlights Database: - IATA airport codes matched to latitude/longitude coordinates - 408 U.S. airports successfully geocoded - Coordinates precise to seconds (approximately ±30 meters)\n# Example geocoding\nairports_data = pd.read_csv('airport_coordinates.csv')\nairports_clean = airports_data.set_index('AIRPORT')[['LATITUDE', 'LONGITUDE']]\n\ndef get_coords(airport_code, airport_df):\n    if airport_code in airport_df.index:\n        coords = airport_df.loc[airport_code]\n        return (coords['LATITUDE'], coords['LONGITUDE'])\n    return (None, None)\n\n# Apply to flight data\ndiverted_flights['origin_lat'] = diverted_flights['Origin'].apply(\n    lambda x: get_coords(x, airports_clean)[0]\n)\ndiverted_flights['origin_lon'] = diverted_flights['Origin'].apply(\n    lambda x: get_coords(x, airports_clean)[1]\n)\nGeocoding Success Rate: 99.75%",
    "crumbs": [
      "Data Collection",
      "Data Collection & Preparation"
    ]
  },
  {
    "objectID": "01-collection.html#data-limitations",
    "href": "01-collection.html#data-limitations",
    "title": "Data Collection & Preparation",
    "section": "8 Data Limitations",
    "text": "8 Data Limitations\n\n8.1 Known Limitations\n\nU.S. Domestic Only: Analysis limited to U.S. domestic flights; international diversions excluded\nCarrier Reporting: Data depends on airline reporting accuracy; some differences in reporting practices between carriers\nWeather Data Not Included: The current dataset does not include concurrent weather conditions, limiting causal analysis\nSecondary Diversions: Only first diversion recorded; subsequent diversions not tracked, potentially underestimating system impact\nSeasonality: Dataset spans multiple years but seasonal patterns may be confounded with operational changes over time\nDiversion Reason Unknown: BTS data does not indicate reason for diversion (weather, mechanical, ATC, capacity, etc.)\n\n\n\n8.2 Missing Information\n\nWeather conditions at time of diversion\nReason for diversion (weather, mechanical, ATC, capacity, etc.)\nPassenger impact (number of passengers affected)\nFinancial impact to airlines\nGate information and ground handling details",
    "crumbs": [
      "Data Collection",
      "Data Collection & Preparation"
    ]
  },
  {
    "objectID": "01-collection.html#data-processing-summary",
    "href": "01-collection.html#data-processing-summary",
    "title": "Data Collection & Preparation",
    "section": "9 Data Processing Summary",
    "text": "9 Data Processing Summary\n\n\n\n\n\n\n\n\n\n\nStage\nRecords In\nRecords Out\n% Retained\nNotes\n\n\n\n\nRaw Data\n25,386,632\n-\n-\nConsolidated from 45 monthly files\n\n\nFilter Diversions\n25,386,632\n64,815\n0.26%\nRemoved non-diverted flights\n\n\nRemove Duplicates\n64,815\n64,815\n100%\nNo duplicates found\n\n\nGeocoding\n64,815\n64,815\n99.75%\nAirports successfully geocoded\n\n\nFinal Dataset\n-\n64,815\n100%\nReady for analysis",
    "crumbs": [
      "Data Collection",
      "Data Collection & Preparation"
    ]
  },
  {
    "objectID": "01-collection.html#reproducibility",
    "href": "01-collection.html#reproducibility",
    "title": "Data Collection & Preparation",
    "section": "10 Reproducibility",
    "text": "10 Reproducibility\nTo reproduce this data collection process:\n\nDownload BTS data from: https://www.transtats.bts.gov/\nPlace monthly CSV files in /data directory (45 files: 2021-07 to 2024-12)\nRun data cleaning script: notebooks/01-data-cleaning.ipynb\nVerify output: diverted_flights.csv should contain 64,815 records\n\n\n10.1 Environment\npython: 3.13\npandas: 2.3.1\nnumpy: 2.3.1\ngeopandas: 1.0.1",
    "crumbs": [
      "Data Collection",
      "Data Collection & Preparation"
    ]
  },
  {
    "objectID": "01-collection.html#next-steps",
    "href": "01-collection.html#next-steps",
    "title": "Data Collection & Preparation",
    "section": "11 Next Steps",
    "text": "11 Next Steps\nAfter collection and cleaning, the data was ready for:\n\nExploratory Analysis - Understanding distribution and patterns\nTemporal Analysis - Identifying clusters and trends over time (see Methodology)\nGeospatial Analysis - Mapping diversions and routes (see Visualizations)\nClustering - Finding patterns in diversion events using 12-hour temporal windows\n\nSee the Analysis Methodology section for details on analytical approach.",
    "crumbs": [
      "Data Collection",
      "Data Collection & Preparation"
    ]
  },
  {
    "objectID": "01-collection.html#data-references",
    "href": "01-collection.html#data-references",
    "title": "Data Collection & Preparation",
    "section": "12 Data References",
    "text": "12 Data References\n\nBureau of Transportation Statistics (BTS): https://www.transtats.bts.gov/\nFAA Airport Data: https://www.faa.gov/\nOpenFlights Database: https://openflights.org/\n\n\nData Collection Date: December 2024 Analysis Period: July 2021 - December 2024 Total Records: 64,815 diversions from 25,386,632 total flights Data Quality: 100% completeness for primary analysis fields",
    "crumbs": [
      "Data Collection",
      "Data Collection & Preparation"
    ]
  },
  {
    "objectID": "03-visualization.html#overview-1",
    "href": "03-visualization.html#overview-1",
    "title": "Visualizations",
    "section": "10 Overview",
    "text": "10 Overview\nThis section explains the interactive maps created to visualize flight diversion patterns. Each visualization reveals different aspects of how diversions cluster geographically and temporally across the U.S. aviation system.",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "03-visualization.html#visualization-types-1",
    "href": "03-visualization.html#visualization-types-1",
    "title": "Visualizations",
    "section": "11 Visualization Types",
    "text": "11 Visualization Types\n\n11.1 Individual Cluster Maps (Cascade View)\nShows all diversions for a single destination airport during a specific cluster period.\nWhat it displays: - Blue markers: Origin airports (where flights departed from) - Red stars: Diversion airports (where flights were redirected) - Gold diamonds: Primary destination airport - Curved colored lines: Flight paths, with each color representing a different airline\nHow to interpret: - Density of colored lines = volume of diversions during the event - Clustering of red stars = which airports absorbed most diversions - Geographic spread = how far diversions traveled - Airline colors = which carriers were most affected\n\n\n11.2 System-Wide Maps (Context View)\nShows all diversions system-wide that occurred during a cluster period, revealing the broader impact.\nWhat it displays: - All diversions across U.S. (not just to primary destination) - Same color scheme as cascade maps - Reveals secondary effects and system disruptions\nHow to interpret: - Compares primary cluster impact vs. system-wide impact - Shows whether disruption was localized or system-wide - Reveals which other airports absorbed overflow diversions",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "03-visualization.html#cluster-1-san-diego-san---december-18-21-2024-1",
    "href": "03-visualization.html#cluster-1-san-diego-san---december-18-21-2024-1",
    "title": "Visualizations",
    "section": "12 Cluster 1: San Diego (SAN) - December 18-21, 2024",
    "text": "12 Cluster 1: San Diego (SAN) - December 18-21, 2024\n\n12.1 Individual Cluster View: SAN Diversions Only\n\n\n\nSAN Individual Cluster Map\n\n\nThis map shows the 140 diversions specifically to San Diego International Airport during this 3-day period.\nKey observations: - Most flights originated from California and Arizona - Phoenix Sky Harbor (PHX) was the primary diversion airport (33 diversions) - Ontario International (ONT) also absorbed significant volume (48 diversions) - Primarily West Coast airlines affected - Tight geographic clustering suggests regional weather event or airport capacity issue\nWhat it tells us: When SAN experiences a disruption, nearby California airports (ONT, LAX) are the first alternatives used by airlines, followed by Arizona airports (PHX, PSP).\n\n\n12.2 System-Wide View: All U.S. Diversions During SAN Cluster\n\n\n\nSAN System-Wide Map\n\n\nThis map reveals the complete aviation system response during the same period - ALL diversions across the U.S., not just those to SAN.\nKey observations: - 290 total diversions vs. 140 to SAN (48.3% to primary airport) - Other destinations affected: SNA (30), EYW (20), BOS (17), LAX (7) - 60 total destination airports affected (not just SAN) - 73 origin airports involved - Geographically widespread: West Coast, East Coast, and Southeast all impacted - Multiple airlines contributed to the cascade\nWhat it tells us: The SAN disruption had system-wide ripple effects. When one major airport is affected, diversions cascade across the entire network, affecting other cities and regions. This is a true system-wide disruption event, not just a localized issue.\nInterpretation: Only about half of flights heading to SAN were diverted there. The other half were diverted elsewhere, indicating either SAN’s capacity to absorb only part of the demand, or airlines making strategic decisions to distribute diversions across multiple airports.",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "03-visualization.html#cluster-2-dallasfort-worth-dfw---november-4-5-2024-1",
    "href": "03-visualization.html#cluster-2-dallasfort-worth-dfw---november-4-5-2024-1",
    "title": "Visualizations",
    "section": "13 Cluster 2: Dallas/Fort Worth (DFW) - November 4-5, 2024",
    "text": "13 Cluster 2: Dallas/Fort Worth (DFW) - November 4-5, 2024\n\n13.1 Individual Cluster View: DFW Diversions Only\n\n\n\nDFW Individual Cluster Map\n\n\nThis map shows the 110 diversions specifically to Dallas/Fort Worth International Airport during this 2-day period.\nKey observations: - Origins concentrated in Northeast, Southeast, and Midwest - Houston Intercontinental (IAH) was the primary diversion airport (28 diversions) - Regional pattern: Oklahoma City (OKC), San Antonio (SAT), Austin (AUS) also active - Primarily American and Southwest airlines (major DFW hubs) - Texas region tightly clustered\nWhat it tells us: DFW diversions are concentrated within the Texas/South-Central region, with Houston emerging as the backup for Dallas flights.\n\n\n13.2 System-Wide View: All U.S. Diversions During DFW Cluster\n\n\n\nDFW System-Wide Map\n\n\nThis map shows all diversions during the same period across the entire U.S.\nKey observations: - 186 total diversions vs. 110 to DFW (59.1% to primary airport) - Secondary destinations: DAL (32), AUS (13), SAT (12) - 40 diversion airports used - 89 origin airports involved - More geographically concentrated than SAN event - Primarily South-Central U.S. (regional event)\nWhat it tells us: This was a more regional event compared to SAN. The disruption impact stayed concentrated in Texas/South-Central region, with 59% of diversions going to the primary airport DFW. Other regional airports absorbed the remaining volume.\nInterpretation: DFW disruptions have less system-wide impact than coastal airport disruptions. The regional nature of this event kept diversions contained within the Texas hub region.",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "03-visualization.html#cluster-3-chicago-ohare-ord---august-24-26-2021-1",
    "href": "03-visualization.html#cluster-3-chicago-ohare-ord---august-24-26-2021-1",
    "title": "Visualizations",
    "section": "14 Cluster 3: Chicago O’Hare (ORD) - August 24-26, 2021",
    "text": "14 Cluster 3: Chicago O’Hare (ORD) - August 24-26, 2021\n\n14.1 Individual Cluster View: ORD Diversions Only\n\n\n\nORD Individual Cluster Map\n\n\nThis map shows the 108 diversions specifically to Chicago O’Hare International Airport during this 3-day period.\nKey observations: - Origins from across entire U.S.: Southwest, Midwest, Northeast, Southeast - Indianapolis (IND) was the primary diversion airport (24 diversions) - Secondary diversion airports: St. Louis (STL), Milwaukee (MKE) - Midwest corridor heavily utilized - United Airlines dominant (major ORD carrier)\nWhat it tells us: When ORD is unavailable, the Midwest corridor airports (IND, STL, MKE) form a network of alternatives, with IND being the primary choice.\n\n\n14.2 System-Wide View: All U.S. Diversions During ORD Cluster\n\n\n\nORD System-Wide Map\n\n\nThis map shows all diversions during the same period across the entire U.S.\nKey observations: - 187 total diversions vs. 108 to ORD (57.8% to primary airport) - Secondary destinations: MCO (19), MDW (14), STL (9) - 51 diversion airports used - 87 origin airports involved - Similar to DFW in concentration (regional event) - Midwest and surrounding regions primarily affected\nWhat it tells us: ORD disruptions have moderate system-wide impact - less than coastal airports but more geographically spread than DFW. The Midwest location means disruptions don’t cascade to both coasts, but do affect a broad Midwest-to-Southeast corridor.\nInterpretation: Hub airport disruptions vary in system-wide impact based on geography. Central hubs like ORD and DFW have more contained impacts, while coastal hubs like SAN have broader ripple effects.",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "03-visualization.html#key-insights-from-visualizations-1",
    "href": "03-visualization.html#key-insights-from-visualizations-1",
    "title": "Visualizations",
    "section": "15 Key Insights from Visualizations",
    "text": "15 Key Insights from Visualizations\n\n15.1 Pattern 1: Geographic Clustering of Diversions\nDiversions concentrate in specific regional hubs rather than spreading randomly: - West Coast: ONT, PHX, LAX, SFO - South-Central: IAH, DFW, SAT, AUS - Midwest: IND, STL, MKE\n\n\n15.2 Pattern 2: System-Wide vs. Regional Events\n\nSAN (coastal, major hub): 48.3% to primary airport, 60 destinations affected (system-wide)\nDFW (regional hub): 59.1% to primary airport, 17 destinations affected (regional)\nORD (central hub): 57.8% to primary airport, 32 destinations affected (regional-to-moderate)\n\n\n\n15.3 Pattern 3: Airline-Specific Patterns\nColors on maps reveal airline-specific routing: - Major airlines (AA, DL, UA, SW) dominate specific hubs - Each airline has preferred diversion airports - Enables prediction of diversion destinations based on carrier\n\n\n15.4 Pattern 4: Cascading Effects\nWhen primary destination unavailable: 1. Flights divert to nearest appropriate airport 2. Overflow spills to secondary airports 3. Eventually reaches tertiary alternatives if needed 4. Creates geographic ripple effect through network",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "03-visualization.html#how-to-use-these-visualizations-1",
    "href": "03-visualization.html#how-to-use-these-visualizations-1",
    "title": "Visualizations",
    "section": "16 How to Use These Visualizations",
    "text": "16 How to Use These Visualizations\n\n16.1 For Operational Planning\n\nAirlines: Identify which airports to pre-position aircraft at for disruption management\nAirports: Anticipate diversion volume during disruption events\nATC: Prepare to route traffic to alternative airports\n\n\n\n16.2 For Understanding System Resilience\n\nNotice which airports absorb diversions (IND, IAH, ONT, etc.)\nIdentify bottlenecks where diversions cannot be easily accommodated\nReveal geographic redundancy in the network\n\n\n\n16.3 For Identifying Root Causes\n\nTemporal clustering (all within 12 hours) suggests single root cause\nGeographic concentration suggests capacity or weather issue\nAirline-specific patterns visible in colored lines",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "03-visualization.html#limitations-of-visualizations-1",
    "href": "03-visualization.html#limitations-of-visualizations-1",
    "title": "Visualizations",
    "section": "17 Limitations of Visualizations",
    "text": "17 Limitations of Visualizations\n\nFirst diversion only: Maps don’t show secondary or tertiary diversions\nNo causal data: Cannot determine weather, mechanical, or ATC reasons\nAggregated view: Individual flight details hidden\nHistorical only: Past patterns don’t guarantee future outcomes\nMercator projection: Distorts distances, especially at high latitudes",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "03-visualization.html#technical-details-1",
    "href": "03-visualization.html#technical-details-1",
    "title": "Visualizations",
    "section": "18 Technical Details",
    "text": "18 Technical Details\n\n18.1 Visualization Tools\n\nFramework: Plotly (interactive web maps)\nData: BTS OTMC-OTP flight records\nCoordinate System: WGS84 (latitude/longitude)\nProjection: Mercator (standard web maps)\n\n\n\n18.2 Map Features\n\nInteractivity: Hover for details, zoom/pan navigation\nExport: Download as PNG image using Plotly tools\nColors: Assigned by airline for pattern recognition\n\n\n\n18.3 Bezier Curves\nFlight paths use quadratic Bezier curves rather than straight lines because: - Straight lines overlap and become illegible - Curved paths separate overlapping routes visually - Curves approximate great-circle routes on Mercator projection\n\nVisualizations Created: December 2024 Data Period: July 2021 - December 2024 Clusters Visualized: 3 major diversion events Total Maps: 6 (3 cascade + 3 system-wide)",
    "crumbs": [
      "Data Collection",
      "Visualizations"
    ]
  },
  {
    "objectID": "index.html#the-three-clusters",
    "href": "index.html#the-three-clusters",
    "title": "Flight Diversions: Understanding Air Traffic Disruptions",
    "section": "4 The Three Clusters",
    "text": "4 The Three Clusters\n\n4.1 Cluster 1: San Diego (December 2024) - System-Wide Disruption\n\n140 diversions to SAN; 290 system-wide across 60 destinations\nOnly 48.3% diverted to primary airport (cascaded across network)\nAffected 73 origin airports and 60 destination airports\nFinding: Coastal hub disruptions have broader ripple effects through the system\n\n\n\n4.2 Cluster 2: Dallas/Fort Worth (November 2024) - Regional Disruption\n\n110 diversions to DFW; 186 system-wide with regional concentration\n59.1% diverted to primary airport (more localized recovery)\nTexas corridor airports (IAH, SAT, AUS) absorbed overflow\nFinding: Regional hubs keep diversions contained in geographic area\n\n\n\n4.3 Cluster 3: Chicago O’Hare (August 2021) - Regional Disruption\n\n108 diversions to ORD; 187 system-wide with Midwest focus\n57.8% diverted to primary airport (regional coordination)\nMidwest corridor (IND, STL, MKE) natural overflow network\nFinding: Hub location determines scope of cascade effects",
    "crumbs": [
      "Home",
      "Flight Diversions: Understanding Air Traffic Disruptions"
    ]
  },
  {
    "objectID": "index.html#american-airlines-why-the-higher-diversion-rate",
    "href": "index.html#american-airlines-why-the-higher-diversion-rate",
    "title": "Flight Diversions: Understanding Air Traffic Disruptions",
    "section": "5 American Airlines: Why the Higher Diversion Rate?",
    "text": "5 American Airlines: Why the Higher Diversion Rate?\nAmerican Airlines accounts for 27.7% of all diversions despite operating roughly 18-22% of U.S. flights:\n\n\n\nAirline\nDiversions\n% of Total\nStatus\n\n\n\n\nAmerican (AA)\n18,004\n27.7%\nHigher than market share\n\n\nUnited (UA)\n13,921\n21.4%\nExpected\n\n\nDelta (DL)\n10,886\n16.8%\nBetter than expected\n\n\nSouthwest (WN)\n10,285\n15.8%\nIn line\n\n\nAlaska (AS)\n3,922\n6.0%\nIn line\n\n\n\nPossible explanations: - More aggressive scheduling relative to airport capacity - Less efficient operational recovery procedures - Different network vulnerabilities (route design, hub exposure) - Older fleet with higher mechanical diversion rates\nThis represents both a competitive disadvantage and an opportunity for operational improvement.",
    "crumbs": [
      "Home",
      "Flight Diversions: Understanding Air Traffic Disruptions"
    ]
  },
  {
    "objectID": "index.html#key-insights-for-stakeholders",
    "href": "index.html#key-insights-for-stakeholders",
    "title": "Flight Diversions: Understanding Air Traffic Disruptions",
    "section": "10 Key Insights for Stakeholders",
    "text": "10 Key Insights for Stakeholders\n\n10.1 For Airlines:\n\nPre-position crews and aircraft at hub diversion airports (DEN, IAD, LAX)\nImplement tiered disruption protocols (regional vs. system-wide)\nBenchmark operational practices against DL and UA\nMonitor routes with historically high diversion risk\n\n\n\n10.2 For Airports:\n\nPlan for surge capacity at consistent diversion hubs\nEstablish regional coordination agreements (Texas, Midwest corridors)\nPosition ground crews to handle unexpected diversion traffic\n\n\n\n10.3 For Policy:\n\nInfrastructure investment should target secondary hubs that absorb diversions\nATC coordination between regional clusters can mitigate cascade effects\nMonitor whether system is near saturation during peak periods",
    "crumbs": [
      "Home",
      "Flight Diversions: Understanding Air Traffic Disruptions"
    ]
  },
  {
    "objectID": "index.html#technical-details",
    "href": "index.html#technical-details",
    "title": "Flight Diversions: Understanding Air Traffic Disruptions",
    "section": "12 Technical Details",
    "text": "12 Technical Details\nData Sources: - Bureau of Transportation Statistics (BTS): https://www.transtats.bts.gov/ - Federal Aviation Administration (FAA): https://www.faa.gov/ - OpenFlights Database: https://openflights.org/\nCode Repository: - GitHub: MUSA5500-finalProject (private - available by request)\nReproducibility: - All analysis code included in Jupyter notebooks - Data pipeline documented and reproducible - Environment specifications provided (Python 3.13, Pandas 2.3.1, etc.)",
    "crumbs": [
      "Home",
      "Flight Diversions: Understanding Air Traffic Disruptions"
    ]
  }
]